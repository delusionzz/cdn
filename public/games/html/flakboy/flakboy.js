var requirejs,require,define;!function(global){function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var i;for(i=0;i<t.length&&(!t[i]||!e(t[i],i,t));i+=1);}}function eachReverse(t,e){if(t){var i;for(i=t.length-1;i>-1&&(!t[i]||!e(t[i],i,t));i-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var i;for(i in t)if(hasProp(t,i)&&e(t[i],i))break}function mixin(t,e,i,n){return e&&eachProp(e,function(e,o){(i||!hasProp(t,o))&&(!n||"object"!=typeof e||!e||isArray(e)||isFunction(e)||e instanceof RegExp?t[o]=e:(t[o]||(t[o]={}),mixin(t[o],e,i,n)))}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,i,n){var o=new Error(e+"\nhttp://requirejs.org/docs/errors.html#"+t);return o.requireType=t,o.requireModules=n,i&&(o.originalError=i),o}function newContext(t){function e(t){var e,i;for(e=0;e<t.length;e++)if(i=t[e],"."===i)t.splice(e,1),e-=1;else if(".."===i){if(0===e||1==e&&".."===t[2]||".."===t[e-1])continue;e>0&&(t.splice(e-1,2),e-=2)}}function i(t,i,n){var o,r,s,a,h,l,u,c,d,p,f,g,m=i&&i.split("/"),y=S.map,b=y&&y["*"];if(t&&(t=t.split("/"),u=t.length-1,S.nodeIdCompat&&jsSuffixRegExp.test(t[u])&&(t[u]=t[u].replace(jsSuffixRegExp,"")),"."===t[0].charAt(0)&&m&&(g=m.slice(0,m.length-1),t=g.concat(t)),e(t),t=t.join("/")),n&&y&&(m||b)){s=t.split("/");t:for(a=s.length;a>0;a-=1){if(l=s.slice(0,a).join("/"),m)for(h=m.length;h>0;h-=1)if(r=getOwn(y,m.slice(0,h).join("/")),r&&(r=getOwn(r,l))){c=r,d=a;break t}!p&&b&&getOwn(b,l)&&(p=getOwn(b,l),f=a)}!c&&p&&(c=p,d=f),c&&(s.splice(0,d,c),t=s.join("/"))}return o=getOwn(S.pkgs,t),o?o:t}function n(t){isBrowser&&each(scripts(),function(e){return e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===x.contextName?(e.parentNode.removeChild(e),!0):void 0})}function o(t){var e=getOwn(S.paths,t);return e&&isArray(e)&&e.length>1?(e.shift(),x.require.undef(t),x.makeRequire(null,{skipMap:!0})([t]),!0):void 0}function r(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function s(t,e,n,o){var s,a,h,l,u=null,c=e?e.name:null,d=t,p=!0,f="";return t||(p=!1,t="_@r"+(R+=1)),l=r(t),u=l[0],t=l[1],u&&(u=i(u,c,o),a=getOwn(M,u)),t&&(u?f=a&&a.normalize?a.normalize(t,function(t){return i(t,c,o)}):-1===t.indexOf("!")?i(t,c,o):t:(f=i(t,c,o),l=r(f),u=l[0],f=l[1],n=!0,s=x.nameToUrl(f))),h=!u||a||n?"":"_unnormalized"+(E+=1),{prefix:u,name:f,parentMap:e,unnormalized:!!h,url:s,originalName:d,isDefine:p,id:(u?u+"!"+f:f)+h}}function a(t){var e=t.id,i=getOwn(T,e);return i||(i=T[e]=new x.Module(t)),i}function h(t,e,i){var n=t.id,o=getOwn(T,n);!hasProp(M,n)||o&&!o.defineEmitComplete?(o=a(t),o.error&&"error"===e?i(o.error):o.on(e,i)):"defined"===e&&i(M[n])}function l(t,e){var i=t.requireModules,n=!1;e?e(t):(each(i,function(e){var i=getOwn(T,e);i&&(i.error=t,i.events.error&&(n=!0,i.emit("error",t)))}),n||req.onError(t))}function u(){globalDefQueue.length&&(apsp.apply(k,[k.length,0].concat(globalDefQueue)),globalDefQueue=[])}function c(t){delete T[t],delete _[t]}function d(t,e,i){var n=t.map.id;t.error?t.emit("error",t.error):(e[n]=!0,each(t.depMaps,function(n,o){var r=n.id,s=getOwn(T,r);!s||t.depMatched[o]||i[r]||(getOwn(e,r)?(t.defineDep(o,M[r]),t.check()):d(s,e,i))}),i[n]=!0)}function p(){var t,e,i=1e3*S.waitSeconds,r=i&&x.startTime+i<(new Date).getTime(),s=[],a=[],h=!1,u=!0;if(!b){if(b=!0,eachProp(_,function(t){var i=t.map,l=i.id;if(t.enabled&&(i.isDefine||a.push(t),!t.error))if(!t.inited&&r)o(l)?(e=!0,h=!0):(s.push(l),n(l));else if(!t.inited&&t.fetched&&i.isDefine&&(h=!0,!i.prefix))return u=!1}),r&&s.length)return t=makeError("timeout","Load timeout for modules: "+s,null,s),t.contextName=x.contextName,l(t);u&&each(a,function(t){d(t,{},{})}),r&&!e||!h||!isBrowser&&!isWebWorker||C||(C=setTimeout(function(){C=0,p()},50)),b=!1}}function f(t){hasProp(M,t[0])||a(s(t[0],null,!0)).init(t[1],t[2])}function g(t,e,i,n){t.detachEvent&&!isOpera?n&&t.detachEvent(n,e):t.removeEventListener(i,e,!1)}function m(t){var e=t.currentTarget||t.srcElement;return g(e,x.onScriptLoad,"load","onreadystatechange"),g(e,x.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function y(){var t;for(u();k.length;){if(t=k.shift(),null===t[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));f(t)}}var b,v,x,w,C,S={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},T={},_={},A={},k=[],M={},B={},L={},R=1,E=1;return w={require:function(t){return t.require?t.require:t.require=x.makeRequire(t.map)},exports:function(t){return t.usingExports=!0,t.map.isDefine?t.exports?M[t.map.id]=t.exports:t.exports=M[t.map.id]={}:void 0},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){return getOwn(S.config,t.map.id)||{}},exports:t.exports||(t.exports={})}}},v=function(t){this.events=getOwn(A,t.id)||{},this.map=t,this.shim=getOwn(S.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},v.prototype={init:function(t,e,i,n){n=n||{},this.inited||(this.factory=e,i?this.on("error",i):this.events.error&&(i=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,x.startTime=(new Date).getTime();var t=this.map;return this.shim?void x.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()})):t.prefix?this.callPlugin():this.load()}},load:function(){var t=this.map.url;B[t]||(B[t]=!0,x.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,i=this.map.id,n=this.depExports,o=this.exports,r=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(r)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{o=x.execCb(i,r,n,o)}catch(s){t=s}else o=x.execCb(i,r,n,o);if(this.map.isDefine&&void 0===o&&(e=this.module,e?o=e.exports:this.usingExports&&(o=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",l(this.error=t)}else o=r;this.exports=o,this.map.isDefine&&!this.ignore&&(M[i]=o,req.onResourceLoad&&req.onResourceLoad(x,this.map,this.depMaps)),c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,n=s(t.prefix);this.depMaps.push(n),h(n,"defined",bind(this,function(n){var o,r,u,d=getOwn(L,this.map.id),p=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,g=x.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(p=n.normalize(p,function(t){return i(t,f,!0)})||""),r=s(t.prefix+"!"+p,this.map.parentMap),h(r,"defined",bind(this,function(t){this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),u=getOwn(T,r.id),void(u&&(this.depMaps.push(r),this.events.error&&u.on("error",bind(this,function(t){this.emit("error",t)})),u.enable()))):d?(this.map.url=x.nameToUrl(d),void this.load()):(o=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),o.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(T,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&c(t.map.id)}),l(t)}),o.fromText=bind(this,function(i,n){var r=t.name,h=s(r),u=useInteractive;n&&(i=n),u&&(useInteractive=!1),a(h),hasProp(S.config,e)&&(S.config[r]=S.config[e]);try{req.exec(i)}catch(c){return l(makeError("fromtexteval","fromText eval for "+e+" failed: "+c,c,[e]))}u&&(useInteractive=!0),this.depMaps.push(h),x.completeLoad(r),g([r],o)}),void n.load(t.name,g,o,S))})),x.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){_[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var i,n,o;if("string"==typeof t){if(t=s(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,o=getOwn(w,t.id))return void(this.depExports[e]=o(this));this.depCount+=1,h(t,"defined",bind(this,function(t){this.defineDep(e,t),this.check()})),this.errback&&h(t,"error",bind(this,this.errback))}i=t.id,n=T[i],hasProp(w,i)||!n||n.enabled||x.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(T,t.id);e&&!e.enabled&&x.enable(t,this)})),this.enabling=!1,this.check()},on:function(t,e){var i=this.events[t];i||(i=this.events[t]=[]),i.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},x={config:S,contextName:t,registry:T,defined:M,urlFetched:B,defQueue:k,Module:v,makeModuleMap:s,nextTick:req.nextTick,onError:l,configure:function(t){t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/");var e=S.shim,i={paths:!0,bundles:!0,config:!0,map:!0};eachProp(t,function(t,e){i[e]?(S[e]||(S[e]={}),mixin(S[e],t,!0,!0)):S[e]=t}),t.bundles&&eachProp(t.bundles,function(t,e){each(t,function(t){t!==e&&(L[t]=e)})}),t.shim&&(eachProp(t.shim,function(t,i){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=x.makeShimExports(t)),e[i]=t}),S.shim=e),t.packages&&each(t.packages,function(t){var e,i;t="string"==typeof t?{name:t}:t,i=t.name,e=t.location,e&&(S.paths[i]=t.location),S.pkgs[i]=t.name+"/"+(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(T,function(t,e){t.inited||t.map.unnormalized||(t.map=s(e))}),(t.deps||t.callback)&&x.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,o){function r(i,n,h){var u,c,d;return o.enableBuildCallback&&n&&isFunction(n)&&(n.__requireJsBuild=!0),"string"==typeof i?isFunction(n)?l(makeError("requireargs","Invalid require call"),h):e&&hasProp(w,i)?w[i](T[e.id]):req.get?req.get(x,i,e,r):(c=s(i,e,!1,!0),u=c.id,hasProp(M,u)?M[u]:l(makeError("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(y(),x.nextTick(function(){y(),d=a(s(null,e)),d.skipMap=o.skipMap,d.init(i,n,h,{enabled:!0}),p()}),r)}return o=o||{},mixin(r,{isBrowser:isBrowser,toUrl:function(t){var n,o=t.lastIndexOf("."),r=t.split("/")[0],s="."===r||".."===r;return-1!==o&&(!s||o>1)&&(n=t.substring(o,t.length),t=t.substring(0,o)),x.nameToUrl(i(t,e&&e.id,!0),n,!0)},defined:function(t){return hasProp(M,s(t,e,!1,!0).id)},specified:function(t){return t=s(t,e,!1,!0).id,hasProp(M,t)||hasProp(T,t)}}),e||(r.undef=function(t){u();var i=s(t,e,!0),o=getOwn(T,t);n(t),delete M[t],delete B[i.url],delete A[t],eachReverse(k,function(e,i){e[0]===t&&k.splice(i,1)}),o&&(o.events.defined&&(A[t]=o.events),c(t))}),r},enable:function(t){var e=getOwn(T,t.id);e&&a(t).enable()},completeLoad:function(t){var e,i,n,r=getOwn(S.shim,t)||{},s=r.exports;for(u();k.length;){if(i=k.shift(),null===i[0]){if(i[0]=t,e)break;e=!0}else i[0]===t&&(e=!0);f(i)}if(n=getOwn(T,t),!e&&!hasProp(M,t)&&n&&!n.inited){if(!(!S.enforceDefine||s&&getGlobal(s)))return o(t)?void 0:l(makeError("nodefine","No define call for "+t,null,[t]));f([t,r.deps||[],r.exportsFn])}p()},nameToUrl:function(t,e,i){var n,o,r,s,a,h,l,u=getOwn(S.pkgs,t);if(u&&(t=u),l=getOwn(L,t))return x.nameToUrl(l,e,i);if(req.jsExtRegExp.test(t))a=t+(e||"");else{for(n=S.paths,o=t.split("/"),r=o.length;r>0;r-=1)if(s=o.slice(0,r).join("/"),h=getOwn(n,s)){isArray(h)&&(h=h[0]),o.splice(0,r,h);break}a=o.join("/"),a+=e||(/^data\:|\?/.test(a)||i?"":".js"),a=("/"===a.charAt(0)||a.match(/^[\w\+\.\-]+:/)?"":S.baseUrl)+a}return S.urlArgs?a+((-1===a.indexOf("?")?"?":"&")+S.urlArgs):a},load:function(t,e){req.load(x,t,e)},execCb:function(t,e,i,n){return e.apply(n,i)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=m(t);x.completeLoad(e.id)}},onScriptError:function(t){var e=m(t);return o(e.id)?void 0:l(makeError("scripterror","Script error for: "+e.id,t,[e.id]))}},x.require=x.makeRequire(),x}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){return"interactive"===t.readyState?interactiveScript=t:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.14",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,i,n){var o,r,s=defContextName;return isArray(t)||"string"==typeof t||(r=t,isArray(e)?(t=e,e=i,i=n):t=[]),r&&r.context&&(s=r.context),o=getOwn(contexts,s),o||(o=contexts[s]=req.s.newContext(s)),r&&o.configure(r),o.require(t,e,i)},req.config=function(t){return req(t)},req.nextTick="undefined"!=typeof setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t){var e=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return e.type=t.scriptType||"text/javascript",e.charset="utf-8",e.async=!0,e},req.load=function(t,e,i){var n,o=t&&t.config||{};if(isBrowser)return n=req.createNode(o,e,i),n.setAttribute("data-requirecontext",t.contextName),n.setAttribute("data-requiremodule",e),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",t.onScriptLoad,!1),n.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",t.onScriptLoad)),n.src=i,currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{importScripts(i),t.completeLoad(e)}catch(r){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+i,r,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(t){return head||(head=t.parentNode),dataMain=t.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(t,e,i){var n,o;"string"!=typeof t&&(i=e,e=t,t=null),isArray(e)||(i=e,e=null),!e&&isFunction(i)&&(e=[],i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(t,i){e.push(i)}),e=(1===i.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript(),n&&(t||(t=n.getAttribute("data-requiremodule")),o=contexts[n.getAttribute("data-requirecontext")])),(o?o.defQueue:globalDefQueue).push([t,e,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("requireLib",function(){}),define("text",["module"],function(t){"use strict";var e,i,n,o,r,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,h=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,u=l&&location.protocol&&location.protocol.replace(/\:/,""),c=l&&location.hostname,d=l&&(location.port||void 0),p={},f=t.config&&t.config()||{};return e={version:"2.0.12",strip:function(t){if(t){t=t.replace(a,"");var e=t.match(h);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;3>e;e+=1){i=s[e];try{t=new ActiveXObject(i)}catch(n){}if(t){s=[i];break}}return t},parseName:function(t){var e,i,n,o=!1,r=t.indexOf("."),s=0===t.indexOf("./")||0===t.indexOf("../");return-1!==r&&(!s||r>1)?(e=t.substring(0,r),i=t.substring(r+1,t.length)):e=t,n=i||e,r=n.indexOf("!"),-1!==r&&(o="strip"===n.substring(r+1),n=n.substring(0,r),i?i=n:e=n),{moduleName:e,ext:i,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,o){var r,s,a,h=e.xdRegExp.exec(t);return h?(r=h[2],s=h[3],s=s.split(":"),a=s[1],s=s[0],!(r&&r!==i||s&&s.toLowerCase()!==n.toLowerCase()||(a||s)&&a!==o)):!0},finishLoad:function(t,i,n,o){n=i?e.strip(n):n,f.isBuild&&(p[t]=n),o(n)},load:function(t,i,n,o){if(o&&o.isBuild&&!o.inlineText)return void n();f.isBuild=o&&o.isBuild;var r=e.parseName(t),s=r.moduleName+(r.ext?"."+r.ext:""),a=i.toUrl(s),h=f.useXhr||e.useXhr;return 0===a.indexOf("empty:")?void n():void(!l||h(a,u,c,d)?e.get(a,function(i){e.finishLoad(t,r.strip,i,n)},function(t){n.error&&n.error(t)}):i([s],function(t){e.finishLoad(r.moduleName+"."+r.ext,r.strip,t,n)}))},write:function(t,i,n){if(p.hasOwnProperty(i)){var o=e.jsEscape(p[i]);n.asModule(t+"!"+i,"define(function () { return '"+o+"';});\n")}},writeFile:function(t,i,n,o,r){var s=e.parseName(i),a=s.ext?"."+s.ext:"",h=s.moduleName+a,l=n.toUrl(s.moduleName+a)+".js";e.load(h,n,function(){var i=function(t){return o(l,t)};i.asModule=function(t,e){return o.asModule(t,l,e)},e.write(t,h,i,r)},r)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var o=i.readFileSync(t,"utf8");0===o.indexOf("ï»¿")&&(o=o.substring(1)),e(o)}catch(r){n&&n(r)}}):"xhr"===f.env||!f.env&&e.createXhr()?e.get=function(t,i,n,o){var r,s=e.createXhr();if(s.open("GET",t,!0),o)for(r in o)o.hasOwnProperty(r)&&s.setRequestHeader(r.toLowerCase(),o[r]);f.onXhr&&f.onXhr(s,t),s.onreadystatechange=function(){var e,o;4===s.readyState&&(e=s.status||0,e>399&&600>e?(o=new Error(t+" HTTP status: "+e),o.xhr=s,n&&n(o)):i(s.responseText),f.onXhrComplete&&f.onXhrComplete(s,t))},s.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,o="utf-8",r=new java.io.File(t),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),o)),h="";try{for(i=new java.lang.StringBuffer,n=a.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(s),i.append(n);h=String(i.toString())}finally{a.close()}e(h)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,o=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,s,a,h={};r&&(t=t.replace(/\//g,"\\")),a=new FileUtils.File(t);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),i.init(a,1,0,!1),s=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),s.init(i,"utf-8",i.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(i.available(),h),s.close(),i.close(),e(h.value)}catch(l){throw new Error((a&&a.path||"")+": "+l)}}),e}),define("text!version.json",[],function(){return'{\n    "name": "Flakboy",\n    "shortname": "flakboy",\n    "id": "com.absoluteherogames.FLAKBOY",\n    "major": 1,\n    "minor": 0,\n    "build": 37,\n    "date": "2014-09-29",\n    "time": "13:20:18",\n    "string": "1.0.37"\n}\n'}),define("version",["text!version.json"],function(t){var e=JSON.parse(t);return{name:function(){return e.name},id:function(){return e.id},version:function(){return e.string+"_"+e.date+"_"+e.time}}}),define("absolute/asyncqueue",[],function(){"use strict";var t=function(){this._initAsyncQueue()};return t.prototype._initAsyncQueue=function(){this.tasks=new Array,this.current=0},t.prototype.reset=function(){this.current=0},t.prototype.clear=function(){this.tasks=new Array,this.reset()},t.prototype.pushTask=function(t){this.tasks.push(t)},t.prototype.pushTasks=function(t){for(var e in t)this.tasks.push(t[e])},t.prototype.run=function(t,e){this.onProgress=t,this.onComplete=e;var i=this;if("function"!=typeof this.tasks[0])throw"Error: task is a "+typeof this.tasks[0]+" not a function!";this.tasks[this.current](function(t){i._updateProgress(t)},function(){i._runNext()})},t.prototype._runNext=function(){var t=this;if(++this.current<this.tasks.length){if("function"!=typeof this.tasks[this.current])throw"Error: task is a "+typeof this.tasks[0]+" not a function!";this.tasks[this.current](function(e){t._updateProgress(e)},function(){t._runNext()})}else this.onComplete()},t.prototype._updateProgress=function(t){var e=0;this.tasks.length>0&&(e=this.current/this.tasks.length+1/this.tasks.length*t),this.onProgress(e)},t}),define("absoluteaudio/audioclip",[],function(){var t=(navigator.userAgent.indexOf("iPhone OS")>=0,function(t,e){this.init(t,e)});return t.constructor=t,t.prototype.init=function(){},t.prototype.load=function(){},t.prototype.seek=function(){},t.prototype.play=function(){},t.prototype.pause=function(){},t.prototype.stop=function(){},t.prototype.setVolume=function(){},t.prototype.getVolume=function(){},t.prototype.mute=function(){},t.prototype.unmute=function(){},t.prototype.isMuted=function(){},t.prototype.prime=function(){},t}),define("absoluteaudio/webaudioclip",["absoluteaudio/audioclip"],function(t){var e=navigator.userAgent.indexOf("iPhone OS")>=0,i=function(t,e,i){this.init(t,e,i)};return i.constructor=i,i.prototype=Object.create(t.prototype),i.prototype.init=function(e,i,n){t.prototype.init.call(e,i),this.audioContext=n,this.url=e,this.volume=1,this.offset=0,this.sourceNode=null,this.gainNode=null,this.muted=!1,this.load(e,i)},i.prototype.load=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){this.audioContext.decodeAudioData(i.response,function(t){this.buffer=t,e&&"function"==typeof e&&e()}.bind(this),function(){console.log("error loading audio clip "+t),e&&"function"==typeof e&&e()}.bind(this))}.bind(this),i.send()},i.prototype.play=function(t,i,n){var o=t||0;this.loop=!!i,this.onComplete=n,e&&this.muted||(this.sourceNode=this.audioContext.createBufferSource(),this.gainNode="undefined"!=typeof this.audioContext.createGainNode?this.audioContext.createGainNode():this.audioContext.createGain(),this.sourceNode.loop=i,this.sourceNode.buffer=this.buffer,this.sourceNode.onended=function(){n&&"function"==typeof n&&n()},this.gainNode.gain.value=this.muted?0:this.volume,this.sourceNode.connect(this.gainNode),this.gainNode.connect(this.audioContext.destination),0!==o&&(o+=this.audioContext.currentTime),"undefined"==typeof this.sourceNode.start?this.sourceNode.noteOn(o):this.sourceNode.start(o,this.offset))},i.prototype.pause=function(){this.stop(),this.offset=this.audioContext.currentTime},i.prototype.stop=function(){this.sourceNode&&(this.offset=0,"undefined"==typeof this.sourceNode.start?this.sourceNode.noteOff(0):this.sourceNode.stop(0),this.sourceNode=null,this.gainNode=null)},i.prototype.setVolume=function(t){0>t?t=0:t>1&&(t=1),this.volume=t,this.gainNode&&(this.gainNode.gain.value=t)},i.prototype.getVolume=function(){return this.volume},i.prototype.mute=function(){this.muted=!0,this.gainNode&&(this.gainNode.gain.value=0,e&&this.pause())},i.prototype.unmute=function(){this.muted=!1,this.gainNode&&(this.gainNode.gain.value=this.volume,e&&this.play(0,this.loop,this.onComplete))},i.prototype.isMuted=function(){return this.muted},i}),define("absoluteaudio/streamedwebaudioclip",[],function(){var t=(navigator.userAgent.indexOf("iPhone OS")>=0,function(t,e,i){this.init(t,e,i)});return t.prototype.init=function(t,e,i){this.audioContext=i,this.url=t,this.volume=1,this.offset=0,this.audioElement=null,this.source=null,this.gainNode=null,this.muted=!1,this.load(t,e)},t.prototype.load=function(t,e){this.audioElement=new Audio,this.audioElement.addEventListener("loadstart",function(){e&&"function"==typeof e&&e()},!1),this.audioElement.src=this.url},t.prototype.play=function(t,e,i){this.audioElement.loop=e,this.source||(this.source=this.audioContext.createMediaElementSource(this.audioElement),this.gainNode=this.audioContext.createGainNode(),this.source.connect(this.gainNode),this.gainNode.connect(this.audioContext.destination),this.gainNode.gain.value=this.muted?0:this.volume),this.audioElement.addEventListener("ended",function(){i&&"function"==typeof i&&i()},!1),this.audioElement.play()},t.prototype.pause=function(){this.audioElement&&this.audioElement.pause()},t.prototype.stop=function(){this.audioElement&&this.audioElement.pause()},t.prototype.setVolume=function(t){0>t?t=0:t>1&&(t=1),this.volume=t,this.gainNode&&(this.gainNode.gain.value=t)},t.prototype.getVolume=function(){return this.volume},t.prototype.mute=function(){this.muted=!0,this.gainNode&&(this.gainNode.gain.value=0)},t.prototype.unmute=function(){this.gainNode&&(this.gainNode.gain.value=this.volume),this.muted=!1},t.prototype.isMuted=function(){return this.muted},t}),define("absoluteaudio/html5audioelementclip",["absoluteaudio/audioclip"],function(t){var e=!0,i=function(t,e,i){this.init(t,e,i)};return i.constructor=i,i.prototype=Object.create(t.prototype),i.prototype.init=function(e,i,n){t.prototype.init.call(e,i),this.duration=n,this.url=e,this.volume=1,this.audioElement=null,this.muted=!1,this.loopTimer=null,this.delay=0,this.loop=!1,this.onComplete=null,this.paused=!0,this.offset=0,this.isSilent=!1,this.load(e,i)},i.prototype.load=function(t,e){this.audioElement=new Audio;var i=0,n=4,o=function(){4===this.audioElement.readyState||i++>n?e():setTimeout(o,250)}.bind(this);this.audioElement.addEventListener("loadstart",function(){o()}.bind(this),!1),this.audioElement.src=this.url},t.prototype.seek=function(t){this.offset=t},i.prototype.play=function(t,i,n){try{if(this.delay=t,this.loop=i,this.onComplete=n,this.muted&&e)return void(i&&(this.paused=!1));if("undefined"!=typeof this.duration){var o=function(){this.audioElement.currentTime>=this.duration?(this.paused=!1,i?(this.audioElement.pause(),this.audioElement.currentTime=this.offset,this.play(t,i,n)):(this.paused=!0,this.audioElement.pause(),n&&"function"==typeof n&&n())):this.audioElement.paused||requestAnimationFrame(o)}.bind(this);requestAnimationFrame(o)}this.audioElement.currentTime=this.offset,this.audioElement.play()}catch(r){}},i.prototype.pause=function(){this._actualPause(),this.paused=!0},i.prototype._actualPause=function(){this.audioElement&&(this.loopTimer&&(clearTimeout(this.loopTimer),this.loopTimer=null),this.audioElement.pause())},i.prototype.stop=function(){try{this.audioElement&&(this.loopTimer&&(clearTimeout(this.loopTimer),this.loopTimer=null),this.audioElement.pause(),this.audioElement.currentTime=this.offset)}catch(t){}},i.prototype.setVolume=function(t){0>t?t=0:t>1&&(t=1),this.volume=t,this.audioElement&&(this.audioElement=t)},i.prototype.getVolume=function(){return this.volume},i.prototype.mute=function(){this.muted=!0,this.audioElement&&e&&!this.paused&&this._actualPause()},i.prototype.unmute=function(){this.audioElement&&this.muted&&e&&!this.paused&&(this.muted=!1,this.play(this.delay,this.loop,this.onComplete)),this.muted=!1},i.prototype.isMuted=function(){return this.muted},i.prototype.prime=function(){this.audioElement&&(this.audioElement.play(),this.audioElement.pause())},i.prototype.playSilent=function(){this.isSilent=!0;var t=function(){if(this.isSilent){try{this.audioElement.currentTime=1e3}catch(e){}setTimeout(t,500)}}.bind(this);t()},i}),define("absoluteaudio/audiosprite",[],function(){var t=null,e=function(t,e,i){this.init(t,e,i)};return e.constructor=e,e.prototype.init=function(t,e,i){this.baseClip=t,this.start=e,this.end=i,this.cancelled=!1,this.muted=!1,this.paused=!0},e.prototype.seek=function(t){this.baseClip.seek(this.offset+t)},e.prototype.play=function(e,i,n){this.delay=e,this.loop=i,this.onComplete=n;var o=e||0;if(!this.muted){var r=function(){try{this.paused=!0,this.baseClip.audioElement.currentTime=this.start;var e=function(){this.baseClip.audioElement.currentTime=this.start,this.baseClip.audioElement.currentTime!==this.start?setTimeout(e,100):(this!==t&&(t&&(t.cancelled=!0),t=this,this.cancelled=!1),this.paused=!1,this.baseClip.audioElement.paused&&this.baseClip.audioElement.play(),this.baseClip.isSilent=!1,requestAnimationFrame(s))}.bind(this);e()}catch(i){}}.bind(this),s=function(){this.cancelled||(this.baseClip.audioElement.currentTime>=this.end?(this.paused=!1,i?r():(this.paused=!0,this.baseClip.playSilent(),n&&"function"==typeof n&&n())):this.paused||requestAnimationFrame(s))}.bind(this);o>0?setTimeout(function(){r()}.bind(this),1e3*o):r()}},e.prototype.pause=function(){this.baseClip.playSilent()},e.prototype.stop=function(){this.baseClip.playSilent(),this.cancelled=!0},e.prototype.setVolume=function(){this.baseClip.setVolume()},e.prototype.getVolume=function(){return this.baseClip.getVolume()},e.prototype.mute=function(){this.paused||this.cancelled||this.baseClip.playSilent(),this.muted=!0,this.cancelled=!0},e.prototype.unmute=function(){this.muted=!1,this.paused||this.play(this.delay,this.loop,this.onComplete)},e.prototype.isMuted=function(){return this.baseClip.isMuted()},e.prototype.prime=function(){},e}),define("absoluteaudio/cordovaclip",[],function(){var t=function(t,e){this.init(t,e)};return t.constructor=t,t.prototype.init=function(t,e){this.clip=new Media(t,function(){this.loop&&!this.cancelled?this.clip.play():this.onComplete&&"function"==typeof this.onComplete&&this.onComplete()}.bind(this)),this.muted=!1,this.cancelled=!1,this.paused=!0,e&&"function"==typeof e&&e()},t.prototype.seek=function(){},t.prototype.play=function(t,e,i){this.delay=t,this.loop=e,this.onComplete=i;var n=t||0;this.paused=!1,this.cancelled=!1,n>0?setTimeout(function(){this.clip.play()}.bind(this),1e3*n):this.clip.play()},t.prototype.pause=function(){this.clip.pause(),this.paused=!0},t.prototype.stop=function(){this.cancelled=!0,this.clip.stop()
},t.prototype.setVolume=function(){},t.prototype.getVolume=function(){},t.prototype.mute=function(){setTimeout(function(){this.clip.setVolume("0.0"),this.muted=!0}.bind(this),0)},t.prototype.unmute=function(){setTimeout(function(){this.clip.setVolume("1.0"),this.muted=!1}.bind(this),0)},t.prototype.isMuted=function(){return this.muted},t.prototype.prime=function(){},t}),define("absoluteaudio/soundmanagerclip",[],function(){var t=function(t,e){this.init(t,e)};return t.constructor=t,t.prototype.init=function(t,e){this.load(t,e)},t.prototype.load=function(t,e){var i=t.substring(t.lastIndexOf("/")+1);this.sound=soundManager.createSound({id:i,url:t,autoLoad:!0,onload:function(){e()}})},t.prototype.seek=function(){},t.prototype.play=function(t,e,i){var n=!!e,o=function(){n?this.sound.play({onfinish:function(){o()}}):i&&"function"==typeof i&&i()}.bind(this);this.sound.play({onfinish:function(){o()}})},t.prototype.pause=function(){this.sound.stop()},t.prototype.stop=function(){this.sound.stop()},t.prototype.setVolume=function(){},t.prototype.getVolume=function(){},t.prototype.mute=function(){this.sound.mute()},t.prototype.unmute=function(){this.sound.unmute()},t.prototype.isMuted=function(){return this.muted},t.prototype.prime=function(){},t}),define("absoluteaudio/debug",[],function(){for(var t,e={},i=/\+/g,n=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(i," "))},r=window.location.search.substring(1);t=n.exec(r);)e[o(t[1])]=o(t[2]);var s={enabled:e.debugAudio&&"true"===e.debugAudio};return s}),function(){var t=this,e=e||{};e.WEBGL_RENDERER=0,e.CANVAS_RENDERER=1,e.VERSION="v1.5.3",e.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},e.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},e.INTERACTION_FREQUENCY=30,e.AUTO_PREVENT_DEFAULT=!0,e.RAD_TO_DEG=180/Math.PI,e.DEG_TO_RAD=Math.PI/180,e.Point=function(t,e){this.x=t||0,this.y=e||0},e.Point.prototype.clone=function(){return new e.Point(this.x,this.y)},e.Point.prototype.constructor=e.Point,e.Point.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},e.Rectangle=function(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0},e.Rectangle.prototype.clone=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Rectangle.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(t>=i&&t<=i+this.width){var n=this.y;if(e>=n&&e<=n+this.height)return!0}return!1},e.Rectangle.prototype.constructor=e.Rectangle,e.EmptyRectangle=new e.Rectangle(0,0,0,0),e.Polygon=function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),"number"==typeof t[0]){for(var i=[],n=0,o=t.length;o>n;n+=2)i.push(new e.Point(t[n],t[n+1]));t=i}this.points=t},e.Polygon.prototype.clone=function(){for(var t=[],i=0;i<this.points.length;i++)t.push(this.points[i].clone());return new e.Polygon(t)},e.Polygon.prototype.contains=function(t,e){for(var i=!1,n=0,o=this.points.length-1;n<this.points.length;o=n++){var r=this.points[n].x,s=this.points[n].y,a=this.points[o].x,h=this.points[o].y,l=s>e!=h>e&&(a-r)*(e-s)/(h-s)+r>t;l&&(i=!i)}return i},e.Polygon.prototype.constructor=e.Polygon,e.Circle=function(t,e,i){this.x=t||0,this.y=e||0,this.radius=i||0},e.Circle.prototype.clone=function(){return new e.Circle(this.x,this.y,this.radius)},e.Circle.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.x-t,n=this.y-e,o=this.radius*this.radius;return i*=i,n*=n,o>=i+n},e.Circle.prototype.constructor=e.Circle,e.Ellipse=function(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0},e.Ellipse.prototype.clone=function(){return new e.Ellipse(this.x,this.y,this.width,this.height)},e.Ellipse.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return i*=i,n*=n,1>=i+n},e.Ellipse.prototype.getBounds=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Ellipse.prototype.constructor=e.Ellipse,e.determineMatrixArrayType=function(){return"undefined"!=typeof Float32Array?Float32Array:Array},e.Matrix2=e.determineMatrixArrayType(),e.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},e.Matrix.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},e.Matrix.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var e=this.array;return t?(this.array[0]=this.a,this.array[1]=this.c,this.array[2]=0,this.array[3]=this.b,this.array[4]=this.d,this.array[5]=0,this.array[6]=this.tx,this.array[7]=this.ty,this.array[8]=1):(this.array[0]=this.a,this.array[1]=this.b,this.array[2]=this.tx,this.array[3]=this.c,this.array[4]=this.d,this.array[5]=this.ty,this.array[6]=0,this.array[7]=0,this.array[8]=1),e},e.identityMatrix=new e.Matrix,e.DisplayObject=function(){this.position=new e.Point,this.scale=new e.Point(1,1),this.pivot=new e.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new e.Matrix,this.color=[],this.dynamic=!0,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new e.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},e.DisplayObject.prototype.constructor=e.DisplayObject,e.DisplayObject.prototype.setInteractive=function(t){this.interactive=t},Object.defineProperty(e.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(t){this._interactive=t,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}}),Object.defineProperty(e.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(t){if(t){for(var e=[],i=0;i<t.length;i++)for(var n=t[i].passes,o=0;o<n.length;o++)e.push(n[o]);this._filterBlock={target:this,filterPasses:e}}this._filters=t}}),Object.defineProperty(e.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}),e.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var t=this.parent.worldTransform,e=this.worldTransform,i=this.pivot.x,n=this.pivot.y,o=this._cr*this.scale.x,r=-this._sr*this.scale.y,s=this._sr*this.scale.x,a=this._cr*this.scale.y,h=this.position.x-o*i-n*r,l=this.position.y-a*n-i*s,u=t.a,c=t.b,d=t.c,p=t.d;e.a=u*o+c*s,e.b=u*r+c*a,e.tx=u*h+c*l+t.tx,e.c=d*o+p*s,e.d=d*r+p*a,e.ty=d*h+p*l+t.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha},e.DisplayObject.prototype.getBounds=function(t){return t=t,e.EmptyRectangle},e.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(e.identityMatrix)},e.DisplayObject.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0)},e.DisplayObject.prototype.generateTexture=function(t){var i=this.getLocalBounds(),n=new e.RenderTexture(0|i.width,0|i.height,t);return n.render(this,new e.Point(-i.x,-i.y)),n},e.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},e.DisplayObject.prototype._renderCachedSprite=function(t){t.gl?e.Sprite.prototype._renderWebGL.call(this._cachedSprite,t):e.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)},e.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var i=new e.RenderTexture(0|t.width,0|t.height);this._cachedSprite=new e.Sprite(i),this._cachedSprite.worldTransform=this.worldTransform}var n=this._filters;this._filters=null,this._cachedSprite.filters=n,this._cachedSprite.texture.render(this,new e.Point(-t.x,-t.y)),this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._filters=n,this._cacheAsBitmap=!0},e.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},e.DisplayObject.prototype._renderWebGL=function(t){t=t},e.DisplayObject.prototype._renderCanvas=function(t){t=t},Object.defineProperty(e.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(e.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),e.DisplayObjectContainer=function(){e.DisplayObject.call(this),this.children=[]},e.DisplayObjectContainer.prototype=Object.create(e.DisplayObject.prototype),e.DisplayObjectContainer.prototype.constructor=e.DisplayObjectContainer,e.DisplayObjectContainer.prototype.addChild=function(t){this.addChildAt(t,this.children.length)},e.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(!(e>=0&&e<=this.children.length))throw new Error(t+" The index "+e+" supplied is out of bounds "+this.children.length);t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.stage&&t.setStageReference(this.stage)},e.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var i=this.children.indexOf(t),n=this.children.indexOf(e);if(0>i||0>n)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=e,this.children[n]=t}},e.DisplayObjectContainer.prototype.getChildAt=function(t){if(t>=0&&t<this.children.length)return this.children[t];throw new Error("Supplied index does not exist in the child list, or the supplied DisplayObject must be a child of the caller")},e.DisplayObjectContainer.prototype.removeChild=function(t){return this.removeChildAt(this.children.indexOf(t))},e.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},e.DisplayObjectContainer.prototype.removeChildren=function(t,e){var i=t||0,n="number"==typeof e?e:this.children.length,o=n-i;if(o>0&&n>=o){for(var r=this.children.splice(i,o),s=0;s<r.length;s++){var a=r[s];this.stage&&a.removeStageReference(),a.parent=void 0}return r}throw new Error("Range Error, numeric values are outside the acceptable range")},e.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(e.DisplayObject.prototype.updateTransform.call(this),!this._cacheAsBitmap))for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateTransform()},e.DisplayObjectContainer.prototype.getBounds=function(t){if(0===this.children.length)return e.EmptyRectangle;if(t){var i=this.worldTransform;this.worldTransform=t,this.updateTransform(),this.worldTransform=i}for(var n,o,r,s=1/0,a=1/0,h=-1/0,l=-1/0,u=!1,c=0,d=this.children.length;d>c;c++){var p=this.children[c];p.visible&&(u=!0,n=this.children[c].getBounds(t),s=s<n.x?s:n.x,a=a<n.y?a:n.y,o=n.width+n.x,r=n.height+n.y,h=h>o?h:o,l=l>r?l:r)}if(!u)return e.EmptyRectangle;var f=this._bounds;return f.x=s,f.y=a,f.width=h-s,f.height=l-a,f},e.DisplayObjectContainer.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=e.identityMatrix;for(var i=0,n=this.children.length;n>i;i++)this.children[i].updateTransform();var o=this.getBounds();return this.worldTransform=t,o},e.DisplayObjectContainer.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0);for(var e=0,i=this.children.length;i>e;e++){var n=this.children[e];n.setStageReference(t)}},e.DisplayObjectContainer.prototype.removeStageReference=function(){for(var t=0,e=this.children.length;e>t;t++){var i=this.children[t];i.removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},e.DisplayObjectContainer.prototype._renderWebGL=function(t){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);var e,i;if(this._mask||this._filters){for(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),t.spriteBatch.start()}else for(e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t)}},e.DisplayObjectContainer.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);this._mask&&t.maskManager.pushMask(this._mask,t.context);for(var e=0,i=this.children.length;i>e;e++){var n=this.children[e];n._renderCanvas(t)}this._mask&&t.maskManager.popMask(t.context)}},e.Sprite=function(t){e.DisplayObjectContainer.call(this),this.anchor=new e.Point,this.texture=t,this._width=0,this._height=0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL,t.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Sprite.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Sprite.prototype.constructor=e.Sprite,Object.defineProperty(e.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(e.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),e.Sprite.prototype.setTexture=function(t){this.texture.baseTexture!==t.baseTexture?(this.textureChange=!0,this.texture=t):this.texture=t,this.cachedTint=16777215,this.updateFrame=!0},e.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height),this.updateFrame=!0},e.Sprite.prototype.getBounds=function(t){var e=this.texture.frame.width,i=this.texture.frame.height,n=e*(1-this.anchor.x),o=e*-this.anchor.x,r=i*(1-this.anchor.y),s=i*-this.anchor.y,a=t||this.worldTransform,h=a.a,l=a.c,u=a.b,c=a.d,d=a.tx,p=a.ty,f=h*o+u*s+d,g=c*s+l*o+p,m=h*n+u*s+d,y=c*s+l*n+p,b=h*n+u*r+d,v=c*r+l*n+p,x=h*o+u*r+d,w=c*r+l*o+p,C=-1/0,S=-1/0,T=1/0,_=1/0;T=T>f?f:T,T=T>m?m:T,T=T>b?b:T,T=T>x?x:T,_=_>g?g:_,_=_>y?y:_,_=_>v?v:_,_=_>w?w:_,C=f>C?f:C,C=m>C?m:C,C=b>C?b:C,C=x>C?x:C,S=g>S?g:S,S=y>S?y:S,S=v>S?v:S,S=w>S?w:S;var A=this._bounds;return A.x=T,A.width=C-T,A.y=_,A.height=S-_,this._currentBounds=A,A},e.Sprite.prototype._renderWebGL=function(t){if(this.visible&&!(this.alpha<=0)){var e,i;if(this._mask||this._filters){var n=t.spriteBatch;for(this._mask&&(n.stop(),t.maskManager.pushMask(this.mask,t),n.start()),this._filters&&(n.flush(),t.filterManager.pushFilter(this._filterBlock)),n.render(this),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t);n.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),n.start()}else for(t.spriteBatch.render(this),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t)}},e.Sprite.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){var i=this.texture.frame,n=t.context,o=this.texture;if(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,n.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t.context),i&&i.width&&i.height&&o.baseTexture.source){n.globalAlpha=this.worldAlpha;var r=this.worldTransform;if(t.roundPixels?n.setTransform(r.a,r.c,r.b,r.d,0|r.tx,0|r.ty):n.setTransform(r.a,r.c,r.b,r.d,r.tx,r.ty),t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,n[t.smoothProperty]=t.scaleMode===e.scaleModes.LINEAR),16777215!==this.tint){if(this.cachedTint!==this.tint){if(!o.baseTexture.hasLoaded)return;this.cachedTint=this.tint,this.tintedTexture=e.CanvasTinter.getTintedTexture(this,this.tint)}n.drawImage(this.tintedTexture,0,0,i.width,i.height,this.anchor.x*-i.width,this.anchor.y*-i.height,i.width,i.height)}else if(o.trim){var s=o.trim;n.drawImage(this.texture.baseTexture.source,i.x,i.y,i.width,i.height,s.x-this.anchor.x*s.width,s.y-this.anchor.y*s.height,i.width,i.height)}else n.drawImage(this.texture.baseTexture.source,i.x,i.y,i.width,i.height,this.anchor.x*-i.width,this.anchor.y*-i.height,i.width,i.height)}for(var a=0,h=this.children.length;h>a;a++){var l=this.children[a];l._renderCanvas(t)}this._mask&&t.maskManager.popMask(t.context)}},e.Sprite.fromFrame=function(t){var i=e.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new e.Sprite(i)},e.Sprite.fromImage=function(t,i,n){var o=e.Texture.fromImage(t,i,n);return new e.Sprite(o)},e.SpriteBatch=function(t){e.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},e.SpriteBatch.prototype=Object.create(e.DisplayObjectContainer.prototype),e.SpriteBatch.constructor=e.SpriteBatch,e.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new e.WebGLFastSpriteBatch(t),this.ready=!0},e.SpriteBatch.prototype.updateTransform=function(){e.DisplayObject.prototype.updateTransform.call(this)},e.SpriteBatch.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(t.gl),t.spriteBatch.stop(),t.shaderManager.activateShader(t.shaderManager.fastShader),this.fastSpriteBatch.begin(this,t),this.fastSpriteBatch.render(this),t.shaderManager.activateShader(t.shaderManager.defaultShader),t.spriteBatch.start())},e.SpriteBatch.prototype._renderCanvas=function(t){var i=t.context;i.globalAlpha=this.worldAlpha,e.DisplayObject.prototype.updateTransform.call(this);for(var n=this.worldTransform,o=!0,r=0;r<this.children.length;r++){var s=this.children[r];if(s.visible){var a=s.texture,h=a.frame;if(i.globalAlpha=this.worldAlpha*s.alpha,s.rotation%(2*Math.PI)===0)o&&(i.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),o=!1),i.drawImage(a.baseTexture.source,h.x,h.y,h.width,h.height,s.anchor.x*-h.width*s.scale.x+s.position.x+.5|0,s.anchor.y*-h.height*s.scale.y+s.position.y+.5|0,h.width*s.scale.x,h.height*s.scale.y);else{o||(o=!0),e.DisplayObject.prototype.updateTransform.call(s);var l=s.worldTransform;t.roundPixels?i.setTransform(l.a,l.c,l.b,l.d,0|l.tx,0|l.ty):i.setTransform(l.a,l.c,l.b,l.d,l.tx,l.ty),i.drawImage(a.baseTexture.source,h.x,h.y,h.width,h.height,s.anchor.x*-h.width+.5|0,s.anchor.y*-h.height+.5|0,h.width,h.height)}}}},e.MovieClip=function(t){e.Sprite.call(this,t[0]),this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},e.MovieClip.prototype=Object.create(e.Sprite.prototype),e.MovieClip.prototype.constructor=e.MovieClip,Object.defineProperty(e.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),e.MovieClip.prototype.stop=function(){this.playing=!1},e.MovieClip.prototype.play=function(){this.playing=!0},e.MovieClip.prototype.gotoAndStop=function(t){this.playing=!1,this.currentFrame=t;var e=this.currentFrame+.5|0;this.setTexture(this.textures[e%this.textures.length])},e.MovieClip.prototype.gotoAndPlay=function(t){this.currentFrame=t,this.playing=!0},e.MovieClip.prototype.updateTransform=function(){if(e.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var t=this.currentFrame+.5|0;this.loop||t<this.textures.length?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},e.MovieClip.prototype.fromFrames=function(t){for(var i=[],n=0;n<t.length;n++)i.push(new e.Texture.fromFrame(t[n]));return new e.MovieClip(i)},e.MovieClip.prototype.fromImages=function(t){for(var i=[],n=0;n<t.length;n++)i.push(new e.Texture.fromImage(t[n]));return new e.MovieClip(i)},e.FilterBlock=function(){this.visible=!0,this.renderable=!0},e.Text=function(t,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),e.Sprite.call(this,e.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(i),this.updateText(),this.dirty=!1},e.Text.prototype=Object.create(e.Sprite.prototype),e.Text.prototype.constructor=e.Text,e.Text.prototype.setStyle=function(t){t=t||{},t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||4,t.dropShadowColor=t.dropShadowColor||"black",this.style=t,this.dirty=!0},e.Text.prototype.setText=function(t){this.text=t.toString()||" ",this.dirty=!0},e.Text.prototype.updateText=function(){this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.wordWrap(this.text));for(var e=t.split(/(?:\r\n|\r|\n)/),i=[],n=0,o=0;o<e.length;o++){var r=this.context.measureText(e[o]).width;i[o]=r,n=Math.max(n,r)}var s=n+this.style.strokeThickness;this.style.dropShadow&&(s+=this.style.dropShadowDistance),this.canvas.width=s+this.context.lineWidth;var a=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness,h=a*e.length;this.style.dropShadow&&(h+=this.style.dropShadowDistance),this.canvas.height=h,navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top";var l,u;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var c=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,d=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(o=0;o<e.length;o++)l=this.style.strokeThickness/2,u=this.style.strokeThickness/2+o*a,"right"===this.style.align?l+=n-i[o]:"center"===this.style.align&&(l+=(n-i[o])/2),this.style.fill&&this.context.fillText(e[o],l+c,u+d)}for(this.context.fillStyle=this.style.fill,o=0;o<e.length;o++)l=this.style.strokeThickness/2,u=this.style.strokeThickness/2+o*a,"right"===this.style.align?l+=n-i[o]:"center"===this.style.align&&(l+=(n-i[o])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(e[o],l,u),this.style.fill&&this.context.fillText(e[o],l,u);this.updateTexture()},e.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.frame.width=this.canvas.width,this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.requiresUpdate=!0},e.Text.prototype._renderWebGL=function(t){this.requiresUpdate&&(this.requiresUpdate=!1,e.updateWebGLTexture(this.texture.baseTexture,t.gl)),e.Sprite.prototype._renderWebGL.call(this,t)},e.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.Sprite.prototype.updateTransform.call(this)},e.Text.prototype.determineFontHeight=function(t){var i=e.Text.heightCache[t];if(!i){var n=document.getElementsByTagName("body")[0],o=document.createElement("div"),r=document.createTextNode("M");o.appendChild(r),o.setAttribute("style",t+";position:absolute;top:0;left:0"),n.appendChild(o),i=o.offsetHeight,e.Text.heightCache[t]=i,n.removeChild(o)}return i},e.Text.prototype.wordWrap=function(t){for(var e="",i=t.split("\n"),n=0;n<i.length;n++){for(var o=this.style.wordWrapWidth,r=i[n].split(" "),s=0;s<r.length;s++){var a=this.context.measureText(r[s]).width,h=a+this.context.measureText(" ").width;0===s||h>o?(s>0&&(e+="\n"),e+=r[s],o=this.style.wordWrapWidth-a):(o-=h,e+=" "+r[s])}n<i.length-1&&(e+="\n")}return e},e.Text.prototype.destroy=function(t){t&&this.texture.destroy()},e.Text.heightCache={},e.BitmapText=function(t,i){e.DisplayObjectContainer.call(this),this._pool=[],this.setText(t),this.setStyle(i),this.updateText(),this.dirty=!1},e.BitmapText.prototype=Object.create(e.DisplayObjectContainer.prototype),e.BitmapText.prototype.constructor=e.BitmapText,e.BitmapText.prototype.setText=function(t){this.text=t||" ",this.dirty=!0},e.BitmapText.prototype.setStyle=function(t){t=t||{},t.align=t.align||"left",this.style=t;var i=t.font.split(" ");this.fontName=i[i.length-1],this.fontSize=i.length>=2?parseInt(i[i.length-2],10):e.BitmapText.fonts[this.fontName].size,this.dirty=!0,this.tint=t.tint},e.BitmapText.prototype.updateText=function(){for(var t=e.BitmapText.fonts[this.fontName],i=new e.Point,n=null,o=[],r=0,s=[],a=0,h=this.fontSize/t.size,l=0;l<this.text.length;l++){var u=this.text.charCodeAt(l);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(l)))s.push(i.x),r=Math.max(r,i.x),a++,i.x=0,i.y+=t.lineHeight,n=null;else{var c=t.chars[u];c&&(n&&c[n]&&(i.x+=c.kerning[n]),o.push({texture:c.texture,line:a,charCode:u,position:new e.Point(i.x+c.xOffset,i.y+c.yOffset)}),i.x+=c.xAdvance,n=u)}}s.push(i.x),r=Math.max(r,i.x);var d=[];for(l=0;a>=l;l++){var p=0;"right"===this.style.align?p=r-s[l]:"center"===this.style.align&&(p=(r-s[l])/2),d.push(p)}var f=this.children.length,g=o.length,m=this.tint||16777215;for(l=0;g>l;l++){var y=f>l?this.children[l]:this._pool.pop();y?y.setTexture(o[l].texture):y=new e.Sprite(o[l].texture),y.position.x=(o[l].position.x+d[o[l].line])*h,y.position.y=o[l].position.y*h,y.scale.x=y.scale.y=h,y.tint=m,y.parent||this.addChild(y)}for(;this.children.length>g;){var b=this.getChildAt(this.children.length-1);this._pool.push(b),this.removeChild(b)}this.textWidth=r*h,this.textHeight=(i.y+t.lineHeight)*h},e.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.BitmapText.fonts={},e.InteractionData=function(){this.global=new e.Point,this.target=null,this.originalEvent=null},e.InteractionData.prototype.getLocalPosition=function(t){var i=t.worldTransform,n=this.global,o=i.a,r=i.b,s=i.tx,a=i.c,h=i.d,l=i.ty,u=1/(o*h+r*-a);return new e.Point(h*u*n.x+-r*u*n.y+(l*r-s*h)*u,o*u*n.y+-a*u*n.x+(-l*o+s*a)*u)},e.InteractionData.prototype.constructor=e.InteractionData,e.InteractionManager=function(t){this.stage=t,this.mouse=new e.InteractionData,this.touchs={},this.tempPoint=new e.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.mouseOut=!1},e.InteractionManager.prototype.constructor=e.InteractionManager,e.InteractionManager.prototype.collectInteractiveSprite=function(t,e){for(var i=t.children,n=i.length,o=n-1;o>=0;o--){var r=i[o];r._interactive?(e.interactiveChildren=!0,this.interactiveItems.push(r),r.children.length>0&&this.collectInteractiveSprite(r,r)):(r.__iParent=null,r.children.length>0&&this.collectInteractiveSprite(r,e))}},e.InteractionManager.prototype.setTarget=function(t){this.target=t,null===this.interactionDOMElement&&this.setTargetDomElement(t.view)},e.InteractionManager.prototype.setTargetDomElement=function(t){this.removeEvents(),window.navigator.msPointerEnabled&&(t.style["-ms-content-zooming"]="none",t.style["-ms-touch-action"]="none"),this.interactionDOMElement=t,t.addEventListener("mousemove",this.onMouseMove,!0),t.addEventListener("mousedown",this.onMouseDown,!0),t.addEventListener("mouseout",this.onMouseOut,!0),t.addEventListener("touchstart",this.onTouchStart,!0),t.addEventListener("touchend",this.onTouchEnd,!0),t.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0)},e.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0))},e.InteractionManager.prototype.update=function(){if(this.target){var t=Date.now(),i=t-this.last;if(i=i*e.INTERACTION_FREQUENCY/1e3,!(1>i)){this.last=t;var n=0;if(this.dirty){this.dirty=!1;var o=this.interactiveItems.length;for(n=0;o>n;n++)this.interactiveItems[n].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)}var r=this.interactiveItems.length,s="inherit",a=!1;for(n=0;r>n;n++){var h=this.interactiveItems[n];h.__hit=this.hitTest(h,this.mouse),this.mouse.target=h,h.__hit&&!a?(h.buttonMode&&(s=h.defaultCursor),h.interactiveChildren||(a=!0),h.__isOver||(h.mouseover&&h.mouseover(this.mouse),h.__isOver=!0)):h.__isOver&&(h.mouseout&&h.mouseout(this.mouse),h.__isOver=!1)}this.currentCursorStyle!==s&&(this.currentCursorStyle=s,this.interactionDOMElement.style.cursor=s)}}},e.InteractionManager.prototype.onMouseMove=function(t){this.mouse.originalEvent=t||window.event;var e=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width),this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height);for(var i=this.interactiveItems.length,n=0;i>n;n++){var o=this.interactiveItems[n];o.mousemove&&o.mousemove(this.mouse)}},e.InteractionManager.prototype.onMouseDown=function(t){this.mouse.originalEvent=t||window.event,e.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var i=this.interactiveItems.length,n=0;i>n;n++){var o=this.interactiveItems[n];if((o.mousedown||o.click)&&(o.__mouseIsDown=!0,o.__hit=this.hitTest(o,this.mouse),o.__hit&&(o.mousedown&&o.mousedown(this.mouse),o.__isDown=!0,!o.interactiveChildren)))break}},e.InteractionManager.prototype.onMouseOut=function(){var t=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var e=0;t>e;e++){var i=this.interactiveItems[e];i.__isOver&&(this.mouse.target=i,i.mouseout&&i.mouseout(this.mouse),i.__isOver=!1)}this.mouseOut=!0,this.mouse.global.x=-1e4,this.mouse.global.y=-1e4},e.InteractionManager.prototype.onMouseUp=function(t){this.mouse.originalEvent=t||window.event;for(var e=this.interactiveItems.length,i=!1,n=0;e>n;n++){var o=this.interactiveItems[n];o.__hit=this.hitTest(o,this.mouse),o.__hit&&!i?(o.mouseup&&o.mouseup(this.mouse),o.__isDown&&o.click&&o.click(this.mouse),o.interactiveChildren||(i=!0)):o.__isDown&&o.mouseupoutside&&o.mouseupoutside(this.mouse),o.__isDown=!1}},e.InteractionManager.prototype.hitTest=function(t,i){var n=i.global;if(!t.worldVisible)return!1;var o=t instanceof e.Sprite,r=t.worldTransform,s=r.a,a=r.b,h=r.tx,l=r.c,u=r.d,c=r.ty,d=1/(s*u+a*-l),p=u*d*n.x+-a*d*n.y+(c*a-h*u)*d,f=s*d*n.y+-l*d*n.x+(-c*s+h*l)*d;
if(i.target=t,t.hitArea&&t.hitArea.contains)return t.hitArea.contains(p,f)?(i.target=t,!0):!1;if(o){var g,m=t.texture.frame.width,y=t.texture.frame.height,b=-m*t.anchor.x;if(p>b&&b+m>p&&(g=-y*t.anchor.y,f>g&&g+y>f))return i.target=t,!0}for(var v=t.children.length,x=0;v>x;x++){var w=t.children[x],C=this.hitTest(w,i);if(C)return i.target=t,!0}return!1},e.InteractionManager.prototype.onTouchMove=function(t){var e,i=this.interactionDOMElement.getBoundingClientRect(),n=t.changedTouches,o=0;for(o=0;o<n.length;o++){var r=n[o];e=this.touchs[r.identifier],e.originalEvent=t||window.event,e.global.x=(r.clientX-i.left)*(this.target.width/i.width),e.global.y=(r.clientY-i.top)*(this.target.height/i.height),navigator.isCocoonJS&&(e.global.x=r.clientX,e.global.y=r.clientY);for(var s=0;s<this.interactiveItems.length;s++){var a=this.interactiveItems[s];a.touchmove&&a.__touchData[r.identifier]&&a.touchmove(e)}}},e.InteractionManager.prototype.onTouchStart=function(t){var i=this.interactionDOMElement.getBoundingClientRect();e.AUTO_PREVENT_DEFAULT&&t.preventDefault();for(var n=t.changedTouches,o=0;o<n.length;o++){var r=n[o],s=this.pool.pop();s||(s=new e.InteractionData),s.originalEvent=t||window.event,this.touchs[r.identifier]=s,s.global.x=(r.clientX-i.left)*(this.target.width/i.width),s.global.y=(r.clientY-i.top)*(this.target.height/i.height),navigator.isCocoonJS&&(s.global.x=r.clientX,s.global.y=r.clientY);for(var a=this.interactiveItems.length,h=0;a>h;h++){var l=this.interactiveItems[h];if((l.touchstart||l.tap)&&(l.__hit=this.hitTest(l,s),l.__hit&&(l.touchstart&&l.touchstart(s),l.__isDown=!0,l.__touchData=l.__touchData||{},l.__touchData[r.identifier]=s,!l.interactiveChildren)))break}}},e.InteractionManager.prototype.onTouchEnd=function(t){for(var e=this.interactionDOMElement.getBoundingClientRect(),i=t.changedTouches,n=0;n<i.length;n++){var o=i[n],r=this.touchs[o.identifier],s=!1;r.global.x=(o.clientX-e.left)*(this.target.width/e.width),r.global.y=(o.clientY-e.top)*(this.target.height/e.height),navigator.isCocoonJS&&(r.global.x=o.clientX,r.global.y=o.clientY);for(var a=this.interactiveItems.length,h=0;a>h;h++){var l=this.interactiveItems[h];l.__touchData&&l.__touchData[o.identifier]&&(l.__hit=this.hitTest(l,l.__touchData[o.identifier]),r.originalEvent=t||window.event,(l.touchend||l.tap)&&(l.__hit&&!s?(l.touchend&&l.touchend(r),l.__isDown&&l.tap&&l.tap(r),l.interactiveChildren||(s=!0)):l.__isDown&&l.touchendoutside&&l.touchendoutside(r),l.__isDown=!1),l.__touchData[o.identifier]=null)}this.pool.push(r),this.touchs[o.identifier]=null}},e.Stage=function(t){e.DisplayObjectContainer.call(this),this.worldTransform=new e.Matrix,this.interactive=!0,this.interactionManager=new e.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new e.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(t)},e.Stage.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Stage.prototype.constructor=e.Stage,e.Stage.prototype.setInteractionDelegate=function(t){this.interactionManager.setTargetDomElement(t)},e.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},e.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=e.hex2rgb(this.backgroundColor);var i=this.backgroundColor.toString(16);i="000000".substr(0,6-i.length)+i,this.backgroundColorString="#"+i},e.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};for(var i=0,n=["ms","moz","webkit","o"],o=0;o<n.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[n[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[o]+"CancelAnimationFrame"]||window[n[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-i)),o=window.setTimeout(function(){t(e+n)},n);return i=e+n,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.requestAnimFrame=window.requestAnimationFrame,e.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},e.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var t=Array.prototype.slice;return function(e){function i(){var r=o.concat(t.call(arguments));n.apply(this instanceof i?this:e,r)}var n=this,o=t.call(arguments,1);if("function"!=typeof n)throw new TypeError;return i.prototype=function r(t){return t&&(r.prototype=t),this instanceof r?void 0:new r}(n.prototype),i}}()),e.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var e=0;e<t.length;e++)try{return new window.ActiveXObject(t[e])}catch(i){}},e.canUseNewCanvasBlendModes=function(){var t=document.createElement("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply",e.fillStyle="#fff",e.fillRect(0,0,1,1),0===e.getImageData(0,0,1,1).data[0]},e.getNextPowerOfTwo=function(t){if(t>0&&0===(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},e.EventTarget=function(){var t={};this.addEventListener=this.on=function(e,i){void 0===t[e]&&(t[e]=[]),-1===t[e].indexOf(i)&&t[e].push(i)},this.dispatchEvent=this.emit=function(e){if(t[e.type]&&t[e.type].length)for(var i=0,n=t[e.type].length;n>i;i++)t[e.type][i](e)},this.removeEventListener=this.off=function(e,i){var n=t[e].indexOf(i);-1!==n&&t[e].splice(n,1)},this.removeAllEventListeners=function(e){var i=t[e];i&&(i.length=0)}},e.autoDetectRenderer=function(t,i,n,o,r){t||(t=800),i||(i=600);var s=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}();return s?new e.WebGLRenderer(t,i,n,o,r):new e.CanvasRenderer(t,i,n,o)},e.autoDetectRecommendedRenderer=function(t,i,n,o,r){t||(t=800),i||(i=600);var s=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}(),a=/Android/i.test(navigator.userAgent);return s&&!a?new e.WebGLRenderer(t,i,n,o,r):new e.CanvasRenderer(t,i,n,o)},e.PolyK={},e.PolyK.Triangulate=function(t){var i=!0,n=t.length>>1;if(3>n)return[];for(var o=[],r=[],s=0;n>s;s++)r.push(s);s=0;for(var a=n;a>3;){var h=r[(s+0)%a],l=r[(s+1)%a],u=r[(s+2)%a],c=t[2*h],d=t[2*h+1],p=t[2*l],f=t[2*l+1],g=t[2*u],m=t[2*u+1],y=!1;if(e.PolyK._convex(c,d,p,f,g,m,i)){y=!0;for(var b=0;a>b;b++){var v=r[b];if(v!==h&&v!==l&&v!==u&&e.PolyK._PointInTriangle(t[2*v],t[2*v+1],c,d,p,f,g,m)){y=!1;break}}}if(y)o.push(h,l,u),r.splice((s+1)%a,1),a--,s=0;else if(s++>3*a){if(!i)return window.console.log("PIXI Warning: shape too complex to fill"),[];for(o=[],r=[],s=0;n>s;s++)r.push(s);s=0,a=n,i=!1}}return o.push(r[0],r[1],r[2]),o},e.PolyK._PointInTriangle=function(t,e,i,n,o,r,s,a){var h=s-i,l=a-n,u=o-i,c=r-n,d=t-i,p=e-n,f=h*h+l*l,g=h*u+l*c,m=h*d+l*p,y=u*u+c*c,b=u*d+c*p,v=1/(f*y-g*g),x=(y*m-g*b)*v,w=(f*b-g*m)*v;return x>=0&&w>=0&&1>x+w},e.PolyK._convex=function(t,e,i,n,o,r,s){return(e-n)*(o-i)+(i-t)*(r-n)>=0===s},e.initDefaultShaders=function(){},e.CompileVertexShader=function(t,i){return e._CompileShader(t,i,t.VERTEX_SHADER)},e.CompileFragmentShader=function(t,i){return e._CompileShader(t,i,t.FRAGMENT_SHADER)},e._CompileShader=function(t,e,i){var n=e.join("\n"),o=t.createShader(i);return t.shaderSource(o,n),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)?o:(window.console.log(t.getShaderInfoLog(o)),null)},e.compileProgram=function(t,i,n){var o=e.CompileFragmentShader(t,n),r=e.CompileVertexShader(t,i),s=t.createProgram();return t.attachShader(s,r),t.attachShader(s,o),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),s},e.PixiShader=function(t){this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.attributes=[],this.init()},e.PixiShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc||e.PixiShader.defaultVertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.dimensions=t.getUniformLocation(i,"dimensions"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var n in this.uniforms)this.uniforms[n].uniformLocation=t.getUniformLocation(i,n);this.initUniforms(),this.program=i},e.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var t,e=this.gl;for(var i in this.uniforms){t=this.uniforms[i];var n=t.type;"sampler2D"===n?(t._init=!1,null!==t.value&&this.initSampler2D(t)):"mat2"===n||"mat3"===n||"mat4"===n?(t.glMatrix=!0,t.glValueLength=1,"mat2"===n?t.glFunc=e.uniformMatrix2fv:"mat3"===n?t.glFunc=e.uniformMatrix3fv:"mat4"===n&&(t.glFunc=e.uniformMatrix4fv)):(t.glFunc=e["uniform"+n],t.glValueLength="2f"===n||"2i"===n?2:"3f"===n||"3i"===n?3:"4f"===n||"4i"===n?4:1)}},e.PixiShader.prototype.initSampler2D=function(t){if(t.value&&t.value.baseTexture&&t.value.baseTexture.hasLoaded){var e=this.gl;if(e.activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]),t.textureData){var i=t.textureData,n=i.magFilter?i.magFilter:e.LINEAR,o=i.minFilter?i.minFilter:e.LINEAR,r=i.wrapS?i.wrapS:e.CLAMP_TO_EDGE,s=i.wrapT?i.wrapT:e.CLAMP_TO_EDGE,a=i.luminance?e.LUMINANCE:e.RGBA;if(i.repeat&&(r=e.REPEAT,s=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!i.flipY),i.width){var h=i.width?i.width:512,l=i.height?i.height:2,u=i.border?i.border:0;e.texImage2D(e.TEXTURE_2D,0,a,h,l,u,a,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,a,e.RGBA,e.UNSIGNED_BYTE,t.value.baseTexture.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,s)}e.uniform1i(t.uniformLocation,this.textureCount),t._init=!0,this.textureCount++}},e.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var t,i=this.gl;for(var n in this.uniforms)t=this.uniforms[n],1===t.glValueLength?t.glMatrix===!0?t.glFunc.call(i,t.uniformLocation,t.transpose,t.value):t.glFunc.call(i,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(i.activeTexture(i["TEXTURE"+this.textureCount]),i.bindTexture(i.TEXTURE_2D,t.value.baseTexture._glTextures[i.id]||e.createWebGLTexture(t.value.baseTexture,i)),i.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))},e.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"],e.PixiFastShader=function(t){this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},e.PixiFastShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.dimensions=t.getUniformLocation(i,"dimensions"),this.uMatrix=t.getUniformLocation(i,"uMatrix"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aPositionCoord=t.getAttribLocation(i,"aPositionCoord"),this.aScale=t.getAttribLocation(i,"aScale"),this.aRotation=t.getAttribLocation(i,"aRotation"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=i},e.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.StripShader=function(){this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","   gl_FragColor = gl_FragColor * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","uniform vec2 offsetVector;","varying float vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"]},e.StripShader.prototype.init=function(){var t=e.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.colorAttribute=t.getAttribLocation(i,"aColor"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.PrimitiveShader=function(t){this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},e.PrimitiveShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.tintColor=t.getUniformLocation(i,"tint"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.colorAttribute=t.getAttribLocation(i,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},e.WebGLGraphics=function(){},e.WebGLGraphics.renderGraphics=function(t,i){var n=i.gl,o=i.projection,r=i.offset,s=i.shaderManager.primitiveShader;t._webGL[n.id]||(t._webGL[n.id]={points:[],indices:[],lastIndex:0,buffer:n.createBuffer(),indexBuffer:n.createBuffer()});var a=t._webGL[n.id];t.dirty&&(t.dirty=!1,t.clearDirty&&(t.clearDirty=!1,a.lastIndex=0,a.points=[],a.indices=[]),e.WebGLGraphics.updateGraphics(t,n)),i.shaderManager.activatePrimitiveShader(),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA),n.uniformMatrix3fv(s.translationMatrix,!1,t.worldTransform.toArray(!0)),n.uniform2f(s.projectionVector,o.x,-o.y),n.uniform2f(s.offsetVector,-r.x,-r.y),n.uniform3fv(s.tintColor,e.hex2rgb(t.tint)),n.uniform1f(s.alpha,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,a.buffer),n.vertexAttribPointer(s.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(s.colorAttribute,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a.indexBuffer),n.drawElements(n.TRIANGLE_STRIP,a.indices.length,n.UNSIGNED_SHORT,0),i.shaderManager.deactivatePrimitiveShader()},e.WebGLGraphics.updateGraphics=function(t,i){for(var n=t._webGL[i.id],o=n.lastIndex;o<t.graphicsData.length;o++){var r=t.graphicsData[o];r.type===e.Graphics.POLY?(r.fill&&r.points.length>3&&e.WebGLGraphics.buildPoly(r,n),r.lineWidth>0&&e.WebGLGraphics.buildLine(r,n)):r.type===e.Graphics.RECT?e.WebGLGraphics.buildRectangle(r,n):(r.type===e.Graphics.CIRC||r.type===e.Graphics.ELIP)&&e.WebGLGraphics.buildCircle(r,n)}n.lastIndex=t.graphicsData.length,n.glPoints=new Float32Array(n.points),i.bindBuffer(i.ARRAY_BUFFER,n.buffer),i.bufferData(i.ARRAY_BUFFER,n.glPoints,i.STATIC_DRAW),n.glIndicies=new Uint16Array(n.indices),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,n.indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,n.glIndicies,i.STATIC_DRAW)},e.WebGLGraphics.buildRectangle=function(t,i){var n=t.points,o=n[0],r=n[1],s=n[2],a=n[3];if(t.fill){var h=e.hex2rgb(t.fillColor),l=t.fillAlpha,u=h[0]*l,c=h[1]*l,d=h[2]*l,p=i.points,f=i.indices,g=p.length/6;p.push(o,r),p.push(u,c,d,l),p.push(o+s,r),p.push(u,c,d,l),p.push(o,r+a),p.push(u,c,d,l),p.push(o+s,r+a),p.push(u,c,d,l),f.push(g,g,g+1,g+2,g+3,g+3)}if(t.lineWidth){var m=t.points;t.points=[o,r,o+s,r,o+s,r+a,o,r+a,o,r],e.WebGLGraphics.buildLine(t,i),t.points=m}},e.WebGLGraphics.buildCircle=function(t,i){var n=t.points,o=n[0],r=n[1],s=n[2],a=n[3],h=40,l=2*Math.PI/h,u=0;if(t.fill){var c=e.hex2rgb(t.fillColor),d=t.fillAlpha,p=c[0]*d,f=c[1]*d,g=c[2]*d,m=i.points,y=i.indices,b=m.length/6;for(y.push(b),u=0;h+1>u;u++)m.push(o,r,p,f,g,d),m.push(o+Math.sin(l*u)*s,r+Math.cos(l*u)*a,p,f,g,d),y.push(b++,b++);y.push(b-1)}if(t.lineWidth){var v=t.points;for(t.points=[],u=0;h+1>u;u++)t.points.push(o+Math.sin(l*u)*s,r+Math.cos(l*u)*a);e.WebGLGraphics.buildLine(t,i),t.points=v}},e.WebGLGraphics.buildLine=function(t,i){var n=0,o=t.points;if(0!==o.length){if(t.lineWidth%2)for(n=0;n<o.length;n++)o[n]+=.5;var r=new e.Point(o[0],o[1]),s=new e.Point(o[o.length-2],o[o.length-1]);if(r.x===s.x&&r.y===s.y){o.pop(),o.pop(),s=new e.Point(o[o.length-2],o[o.length-1]);var a=s.x+.5*(r.x-s.x),h=s.y+.5*(r.y-s.y);o.unshift(a,h),o.push(a,h)}var l,u,c,d,p,f,g,m,y,b,v,x,w,C,S,T,_,A,k,M,B,L,R,E=i.points,P=i.indices,D=o.length/2,O=o.length,F=E.length/6,I=t.lineWidth/2,j=e.hex2rgb(t.lineColor),N=t.lineAlpha,W=j[0]*N,G=j[1]*N,U=j[2]*N;for(c=o[0],d=o[1],p=o[2],f=o[3],y=-(d-f),b=c-p,R=Math.sqrt(y*y+b*b),y/=R,b/=R,y*=I,b*=I,E.push(c-y,d-b,W,G,U,N),E.push(c+y,d+b,W,G,U,N),n=1;D-1>n;n++)c=o[2*(n-1)],d=o[2*(n-1)+1],p=o[2*n],f=o[2*n+1],g=o[2*(n+1)],m=o[2*(n+1)+1],y=-(d-f),b=c-p,R=Math.sqrt(y*y+b*b),y/=R,b/=R,y*=I,b*=I,v=-(f-m),x=p-g,R=Math.sqrt(v*v+x*x),v/=R,x/=R,v*=I,x*=I,S=-b+d-(-b+f),T=-y+p-(-y+c),_=(-y+c)*(-b+f)-(-y+p)*(-b+d),A=-x+m-(-x+f),k=-v+p-(-v+g),M=(-v+g)*(-x+f)-(-v+p)*(-x+m),B=S*k-A*T,Math.abs(B)<.1?(B+=10.1,E.push(p-y,f-b,W,G,U,N),E.push(p+y,f+b,W,G,U,N)):(l=(T*M-k*_)/B,u=(A*_-S*M)/B,L=(l-p)*(l-p)+(u-f)+(u-f),L>19600?(w=y-v,C=b-x,R=Math.sqrt(w*w+C*C),w/=R,C/=R,w*=I,C*=I,E.push(p-w,f-C),E.push(W,G,U,N),E.push(p+w,f+C),E.push(W,G,U,N),E.push(p-w,f-C),E.push(W,G,U,N),O++):(E.push(l,u),E.push(W,G,U,N),E.push(p-(l-p),f-(u-f)),E.push(W,G,U,N)));for(c=o[2*(D-2)],d=o[2*(D-2)+1],p=o[2*(D-1)],f=o[2*(D-1)+1],y=-(d-f),b=c-p,R=Math.sqrt(y*y+b*b),y/=R,b/=R,y*=I,b*=I,E.push(p-y,f-b),E.push(W,G,U,N),E.push(p+y,f+b),E.push(W,G,U,N),P.push(F),n=0;O>n;n++)P.push(F++);P.push(F-1)}},e.WebGLGraphics.buildPoly=function(t,i){var n=t.points;if(!(n.length<6)){var o=i.points,r=i.indices,s=n.length/2,a=e.hex2rgb(t.fillColor),h=t.fillAlpha,l=a[0]*h,u=a[1]*h,c=a[2]*h,d=e.PolyK.Triangulate(n),p=o.length/6,f=0;for(f=0;f<d.length;f+=3)r.push(d[f]+p),r.push(d[f]+p),r.push(d[f+1]+p),r.push(d[f+2]+p),r.push(d[f+2]+p);for(f=0;s>f;f++)o.push(n[2*f],n[2*f+1],l,u,c,h)}},e.glContexts=[],e.WebGLRenderer=function(t,i,n,o,r){e.defaultRenderer||(e.defaultRenderer=this),this.type=e.WEBGL_RENDERER,this.transparent=!!o,this.width=t||800,this.height=i||600,this.view=n||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.contextLost=this.handleContextLost.bind(this),this.contextRestoredLost=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.contextLost,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredLost,!1),this.options={alpha:this.transparent,antialias:!!r,premultipliedAlpha:!!o,stencil:!0};try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(s){try{this.gl=this.view.getContext("webgl",this.options)}catch(a){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var h=this.gl;this.glContextId=h.id=e.WebGLRenderer.glContextId++,e.glContexts[this.glContextId]=h,e.blendModesWebGL||(e.blendModesWebGL=[],e.blendModesWebGL[e.blendModes.NORMAL]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.ADD]=[h.SRC_ALPHA,h.DST_ALPHA],e.blendModesWebGL[e.blendModes.MULTIPLY]=[h.DST_COLOR,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SCREEN]=[h.SRC_ALPHA,h.ONE],e.blendModesWebGL[e.blendModes.OVERLAY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DARKEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LIGHTEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_DODGE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_BURN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HARD_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SOFT_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DIFFERENCE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.EXCLUSION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HUE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SATURATION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LUMINOSITY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA]),this.projection=new e.Point,this.projection.x=this.width/2,this.projection.y=-this.height/2,this.offset=new e.Point(0,0),this.resize(this.width,this.height),this.contextLost=!1,this.shaderManager=new e.WebGLShaderManager(h),this.spriteBatch=new e.WebGLSpriteBatch(h),this.maskManager=new e.WebGLMaskManager(h),this.filterManager=new e.WebGLFilterManager(h,this.transparent),this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.renderer=this,h.useProgram(this.shaderManager.defaultShader.program),h.disable(h.DEPTH_TEST),h.disable(h.CULL_FACE),h.enable(h.BLEND),h.colorMask(!0,!0,!0,this.transparent)},e.WebGLRenderer.prototype.constructor=e.WebGLRenderer,e.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(t.interactive&&t.interactionManager.removeEvents(),this.__stage=t),e.WebGLRenderer.updateTextures(),t.updateTransform(),t._interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)));var i=this.gl;i.viewport(0,0,this.width,this.height),i.bindFramebuffer(i.FRAMEBUFFER,null),this.transparent?i.clearColor(0,0,0,0):i.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],1),i.clear(i.COLOR_BUFFER_BIT),this.renderDisplayObject(t,this.projection),t.interactive?t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)):t._interactiveEventsAdded&&(t._interactiveEventsAdded=!1,t.interactionManager.setTarget(this))}},e.WebGLRenderer.prototype.renderDisplayObject=function(t,e,i){this.renderSession.drawCount=0,this.renderSession.currentBlendMode=9999,this.renderSession.projection=e,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,i),t._renderWebGL(this.renderSession),this.spriteBatch.end()},e.WebGLRenderer.updateTextures=function(){var t=0;for(t=0;t<e.Texture.frameUpdates.length;t++)e.WebGLRenderer.updateTextureFrame(e.Texture.frameUpdates[t]);for(t=0;t<e.texturesToDestroy.length;t++)e.WebGLRenderer.destroyTexture(e.texturesToDestroy[t]);e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,e.Texture.frameUpdates.length=0},e.WebGLRenderer.destroyTexture=function(t){for(var i=t._glTextures.length-1;i>=0;i--){var n=t._glTextures[i],o=e.glContexts[i];o&&n&&o.deleteTexture(n)}t._glTextures.length=0},e.WebGLRenderer.updateTextureFrame=function(t){t.updateFrame=!1,t._updateWebGLuvs()},e.WebGLRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e,this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2,this.projection.y=-this.height/2},e.createWebGLTexture=function(t,i){return t.hasLoaded&&(t._glTextures[i.id]=i.createTexture(),i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id]),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.scaleMode===e.scaleModes.LINEAR?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t.scaleMode===e.scaleModes.LINEAR?i.LINEAR:i.NEAREST),t._powerOf2?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),i.bindTexture(i.TEXTURE_2D,null)),t._glTextures[i.id]},e.updateWebGLTexture=function(t,i){t._glTextures[i.id]&&(i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id]),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.scaleMode===e.scaleModes.LINEAR?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t.scaleMode===e.scaleModes.LINEAR?i.LINEAR:i.NEAREST),t._powerOf2?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),i.bindTexture(i.TEXTURE_2D,null))},e.WebGLRenderer.prototype.handleContextLost=function(t){t.preventDefault(),this.contextLost=!0},e.WebGLRenderer.prototype.handleContextRestored=function(){try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(t){try{this.gl=this.view.getContext("webgl",this.options)}catch(i){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var n=this.gl;n.id=e.WebGLRenderer.glContextId++,this.shaderManager.setContext(n),this.spriteBatch.setContext(n),this.maskManager.setContext(n),this.filterManager.setContext(n),this.renderSession.gl=this.gl,n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE),n.enable(n.BLEND),n.colorMask(!0,!0,!0,this.transparent),this.gl.viewport(0,0,this.width,this.height);for(var o in e.TextureCache){var r=e.TextureCache[o].baseTexture;r._glTextures=[]}this.contextLost=!1},e.WebGLRenderer.prototype.destroy=function(){this.view.removeEventListener("webglcontextlost",this.contextLost),this.view.removeEventListener("webglcontextrestored",this.contextRestoredLost),e.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null},e.WebGLRenderer.glContextId=0,e.WebGLMaskManager=function(t){this.maskStack=[],this.maskPosition=0,this.setContext(t)},e.WebGLMaskManager.prototype.setContext=function(t){this.gl=t},e.WebGLMaskManager.prototype.pushMask=function(t,i){var n=this.gl;0===this.maskStack.length&&(n.enable(n.STENCIL_TEST),n.stencilFunc(n.ALWAYS,1,1)),this.maskStack.push(t),n.colorMask(!1,!1,!1,!1),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.WebGLGraphics.renderGraphics(t,i),n.colorMask(!0,!0,!0,!0),n.stencilFunc(n.NOTEQUAL,0,this.maskStack.length),n.stencilOp(n.KEEP,n.KEEP,n.KEEP)},e.WebGLMaskManager.prototype.popMask=function(t){var i=this.gl,n=this.maskStack.pop();n&&(i.colorMask(!1,!1,!1,!1),i.stencilOp(i.KEEP,i.KEEP,i.DECR),e.WebGLGraphics.renderGraphics(n,t),i.colorMask(!0,!0,!0,!0),i.stencilFunc(i.NOTEQUAL,0,this.maskStack.length),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)),0===this.maskStack.length&&i.disable(i.STENCIL_TEST)},e.WebGLMaskManager.prototype.destroy=function(){this.maskStack=null,this.gl=null},e.WebGLShaderManager=function(t){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.setContext(t)},e.WebGLShaderManager.prototype.setContext=function(t){this.gl=t,this.primitiveShader=new e.PrimitiveShader(t),this.defaultShader=new e.PixiShader(t),this.fastShader=new e.PixiFastShader(t),this.activateShader(this.defaultShader)},e.WebGLShaderManager.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(e=0;e<t.length;e++){var i=t[e];this.tempAttribState[i]=!0}var n=this.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?n.enableVertexAttribArray(e):n.disableVertexAttribArray(e))},e.WebGLShaderManager.prototype.activateShader=function(t){this.currentShader=t,this.gl.useProgram(t.program),this.setAttribs(t.attributes)},e.WebGLShaderManager.prototype.activatePrimitiveShader=function(){var t=this.gl;
t.useProgram(this.primitiveShader.program),this.setAttribs(this.primitiveShader.attributes)},e.WebGLShaderManager.prototype.deactivatePrimitiveShader=function(){var t=this.gl;t.useProgram(this.defaultShader.program),this.setAttribs(this.defaultShader.attributes)},e.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.gl=null},e.WebGLSpriteBatch=function(t){this.vertSize=6,this.size=2e3;var e=4*this.size*this.vertSize,i=6*this.size;this.vertices=new Float32Array(e),this.indices=new Uint16Array(i),this.lastIndexCount=0;for(var n=0,o=0;i>n;n+=6,o+=4)this.indices[n+0]=o+0,this.indices[n+1]=o+1,this.indices[n+2]=o+2,this.indices[n+3]=o+0,this.indices[n+4]=o+2,this.indices[n+5]=o+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.setContext(t)},e.WebGLSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},e.WebGLSpriteBatch.prototype.begin=function(t){this.renderSession=t,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},e.WebGLSpriteBatch.prototype.end=function(){this.flush()},e.WebGLSpriteBatch.prototype.render=function(t){var e=t.texture;(e.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=e.baseTexture),t.blendMode!==this.currentBlendMode&&this.setBlendMode(t.blendMode);var i=t._uvs||t.texture._uvs;if(i){var n,o,r,s,a=t.worldAlpha,h=t.tint,l=this.vertices,u=t.anchor.x,c=t.anchor.y;if(t.texture.trim){var d=t.texture.trim;o=d.x-u*d.width,n=o+e.frame.width,s=d.y-c*d.height,r=s+e.frame.height}else n=e.frame.width*(1-u),o=e.frame.width*-u,r=e.frame.height*(1-c),s=e.frame.height*-c;var p=4*this.currentBatchSize*this.vertSize,f=t.worldTransform,g=f.a,m=f.c,y=f.b,b=f.d,v=f.tx,x=f.ty;l[p++]=g*o+y*s+v,l[p++]=b*s+m*o+x,l[p++]=i.x0,l[p++]=i.y0,l[p++]=a,l[p++]=h,l[p++]=g*n+y*s+v,l[p++]=b*s+m*n+x,l[p++]=i.x1,l[p++]=i.y1,l[p++]=a,l[p++]=h,l[p++]=g*n+y*r+v,l[p++]=b*r+m*n+x,l[p++]=i.x2,l[p++]=i.y2,l[p++]=a,l[p++]=h,l[p++]=g*o+y*r+v,l[p++]=b*r+m*o+x,l[p++]=i.x3,l[p++]=i.y3,l[p++]=a,l[p++]=h,this.currentBatchSize++}},e.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var i=t.tilingTexture;(i.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=i.baseTexture),t.blendMode!==this.currentBlendMode&&this.setBlendMode(t.blendMode),t._uvs||(t._uvs=new e.TextureUvs);var n=t._uvs;t.tilePosition.x%=i.baseTexture.width*t.tileScaleOffset.x,t.tilePosition.y%=i.baseTexture.height*t.tileScaleOffset.y;var o=t.tilePosition.x/(i.baseTexture.width*t.tileScaleOffset.x),r=t.tilePosition.y/(i.baseTexture.height*t.tileScaleOffset.y),s=t.width/i.baseTexture.width/(t.tileScale.x*t.tileScaleOffset.x),a=t.height/i.baseTexture.height/(t.tileScale.y*t.tileScaleOffset.y);n.x0=0-o,n.y0=0-r,n.x1=1*s-o,n.y1=0-r,n.x2=1*s-o,n.y2=1*a-r,n.x3=0-o,n.y3=1*a-r;var h=t.worldAlpha,l=t.tint,u=this.vertices,c=t.width,d=t.height,p=t.anchor.x,f=t.anchor.y,g=c*(1-p),m=c*-p,y=d*(1-f),b=d*-f,v=4*this.currentBatchSize*this.vertSize,x=t.worldTransform,w=x.a,C=x.c,S=x.b,T=x.d,_=x.tx,A=x.ty;u[v++]=w*m+S*b+_,u[v++]=T*b+C*m+A,u[v++]=n.x0,u[v++]=n.y0,u[v++]=h,u[v++]=l,u[v++]=w*g+S*b+_,u[v++]=T*b+C*g+A,u[v++]=n.x1,u[v++]=n.y1,u[v++]=h,u[v++]=l,u[v++]=w*g+S*y+_,u[v++]=T*y+C*g+A,u[v++]=n.x2,u[v++]=n.y2,u[v++]=h,u[v++]=l,u[v++]=w*m+S*y+_,u[v++]=T*y+C*m+A,u[v++]=n.x3,u[v++]=n.y3,u[v++]=h,u[v++]=l,this.currentBatchSize++},e.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]||e.createWebGLTexture(this.currentBaseTexture,t)),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var i=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,i)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},e.WebGLSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var i=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,i.x,i.y);var n=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,n,8),t.vertexAttribPointer(this.shader.colorAttribute,2,t.FLOAT,!1,n,16),this.currentBlendMode!==e.blendModes.NORMAL&&this.setBlendMode(e.blendModes.NORMAL)},e.WebGLSpriteBatch.prototype.setBlendMode=function(t){this.flush(),this.currentBlendMode=t;var i=e.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(i[0],i[1])},e.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},e.WebGLFastSpriteBatch=function(t){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var e=4*this.size*this.vertSize,i=6*this.maxSize;this.vertices=new Float32Array(e),this.indices=new Uint16Array(i),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var n=0,o=0;i>n;n+=6,o+=4)this.indices[n+0]=o+0,this.indices[n+1]=o+1,this.indices[n+2]=o+2,this.indices[n+3]=o+0,this.indices[n+4]=o+2,this.indices[n+5]=o+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(t)},e.WebGLFastSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},e.WebGLFastSpriteBatch.prototype.begin=function(t,e){this.renderSession=e,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=t.worldTransform.toArray(!0),this.start()},e.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.render=function(t){var e=t.children,i=e[0];if(i.texture._uvs){this.currentBaseTexture=i.texture.baseTexture,i.blendMode!==this.currentBlendMode&&this.setBlendMode(i.blendMode);for(var n=0,o=e.length;o>n;n++)this.renderSprite(e[n]);this.flush()}},e.WebGLFastSpriteBatch.prototype.renderSprite=function(t){if(t.visible&&(t.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=t.texture.baseTexture,t.texture._uvs))){var e,i,n,o,r,s,a,h,l=this.vertices;if(e=t.texture._uvs,i=t.texture.frame.width,n=t.texture.frame.height,t.texture.trim){var u=t.texture.trim;r=u.x-t.anchor.x*u.width,o=r+t.texture.frame.width,a=u.y-t.anchor.y*u.height,s=a+t.texture.frame.height}else o=t.texture.frame.width*(1-t.anchor.x),r=t.texture.frame.width*-t.anchor.x,s=t.texture.frame.height*(1-t.anchor.y),a=t.texture.frame.height*-t.anchor.y;h=4*this.currentBatchSize*this.vertSize,l[h++]=r,l[h++]=a,l[h++]=t.position.x,l[h++]=t.position.y,l[h++]=t.scale.x,l[h++]=t.scale.y,l[h++]=t.rotation,l[h++]=e.x0,l[h++]=e.y1,l[h++]=t.alpha,l[h++]=o,l[h++]=a,l[h++]=t.position.x,l[h++]=t.position.y,l[h++]=t.scale.x,l[h++]=t.scale.y,l[h++]=t.rotation,l[h++]=e.x1,l[h++]=e.y1,l[h++]=t.alpha,l[h++]=o,l[h++]=s,l[h++]=t.position.x,l[h++]=t.position.y,l[h++]=t.scale.x,l[h++]=t.scale.y,l[h++]=t.rotation,l[h++]=e.x2,l[h++]=e.y2,l[h++]=t.alpha,l[h++]=r,l[h++]=s,l[h++]=t.position.x,l[h++]=t.position.y,l[h++]=t.scale.x,l[h++]=t.scale.y,l[h++]=t.rotation,l[h++]=e.x3,l[h++]=e.y3,l[h++]=t.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},e.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(this.currentBaseTexture._glTextures[t.id]||e.createWebGLTexture(this.currentBaseTexture,t),t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var i=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,i)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},e.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var i=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,i.x,i.y),t.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var n=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(this.shader.aPositionCoord,2,t.FLOAT,!1,n,8),t.vertexAttribPointer(this.shader.aScale,2,t.FLOAT,!1,n,16),t.vertexAttribPointer(this.shader.aRotation,1,t.FLOAT,!1,n,24),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,n,28),t.vertexAttribPointer(this.shader.colorAttribute,1,t.FLOAT,!1,n,36),this.currentBlendMode!==e.blendModes.NORMAL&&this.setBlendMode(e.blendModes.NORMAL)},e.WebGLFastSpriteBatch.prototype.setBlendMode=function(t){this.flush(),this.currentBlendMode=t;var i=e.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(i[0],i[1])},e.WebGLFilterManager=function(t,e){this.transparent=e,this.filterStack=[],this.offsetX=0,this.offsetY=0,this.setContext(t)},e.WebGLFilterManager.prototype.setContext=function(t){this.gl=t,this.texturePool=[],this.initShaderBuffers()},e.WebGLFilterManager.prototype.begin=function(t,e){this.renderSession=t,this.defaultShader=t.shaderManager.defaultShader;var i=this.renderSession.projection;this.width=2*i.x,this.height=2*-i.y,this.buffer=e},e.WebGLFilterManager.prototype.pushFilter=function(t){var i=this.gl,n=this.renderSession.projection,o=this.renderSession.offset;t._filterArea=t.target.filterArea||t.target.getBounds(),this.filterStack.push(t);var r=t.filterPasses[0];this.offsetX+=t._filterArea.x,this.offsetY+=t._filterArea.y;var s=this.texturePool.pop();s?s.resize(this.width,this.height):s=new e.FilterTexture(this.gl,this.width,this.height),i.bindTexture(i.TEXTURE_2D,s.texture);var a=t._filterArea,h=r.padding;a.x-=h,a.y-=h,a.width+=2*h,a.height+=2*h,a.x<0&&(a.x=0),a.width>this.width&&(a.width=this.width),a.y<0&&(a.y=0),a.height>this.height&&(a.height=this.height),i.bindFramebuffer(i.FRAMEBUFFER,s.frameBuffer),i.viewport(0,0,a.width,a.height),n.x=a.width/2,n.y=-a.height/2,o.x=-a.x,o.y=-a.y,i.uniform2f(this.defaultShader.projectionVector,a.width/2,-a.height/2),i.uniform2f(this.defaultShader.offsetVector,-a.x,-a.y),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),t._glFilterTexture=s},e.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,i=this.filterStack.pop(),n=i._filterArea,o=i._glFilterTexture,r=this.renderSession.projection,s=this.renderSession.offset;if(i.filterPasses.length>1){t.viewport(0,0,n.width,n.height),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=n.height,this.vertexArray[2]=n.width,this.vertexArray[3]=n.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=n.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=n.width/this.width,this.uvArray[5]=n.height/this.height,this.uvArray[6]=n.width/this.width,this.uvArray[7]=n.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);var a=o,h=this.texturePool.pop();h||(h=new e.FilterTexture(this.gl,this.width,this.height)),h.resize(this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,h.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND);for(var l=0;l<i.filterPasses.length-1;l++){var u=i.filterPasses[l];t.bindFramebuffer(t.FRAMEBUFFER,h.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,a.texture),this.applyFilterPass(u,n,n.width,n.height);var c=a;a=h,h=c}t.enable(t.BLEND),o=a,this.texturePool.push(h)}var d=i.filterPasses[i.filterPasses.length-1];this.offsetX-=n.x,this.offsetY-=n.y;var p=this.width,f=this.height,g=0,m=0,y=this.buffer;if(0===this.filterStack.length)t.colorMask(!0,!0,!0,!0);else{var b=this.filterStack[this.filterStack.length-1];n=b._filterArea,p=n.width,f=n.height,g=n.x,m=n.y,y=b._glFilterTexture.frameBuffer}r.x=p/2,r.y=-f/2,s.x=g,s.y=m,n=i._filterArea;var v=n.x-g,x=n.y-m;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=v,this.vertexArray[1]=x+n.height,this.vertexArray[2]=v+n.width,this.vertexArray[3]=x+n.height,this.vertexArray[4]=v,this.vertexArray[5]=x,this.vertexArray[6]=v+n.width,this.vertexArray[7]=x,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=n.width/this.width,this.uvArray[5]=n.height/this.height,this.uvArray[6]=n.width/this.width,this.uvArray[7]=n.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),t.viewport(0,0,p,f),t.bindFramebuffer(t.FRAMEBUFFER,y),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,o.texture),this.applyFilterPass(d,n,p,f),t.useProgram(this.defaultShader.program),t.uniform2f(this.defaultShader.projectionVector,p/2,-f/2),t.uniform2f(this.defaultShader.offsetVector,-g,-m),this.texturePool.push(o),i._glFilterTexture=null},e.WebGLFilterManager.prototype.applyFilterPass=function(t,i,n,o){var r=this.gl,s=t.shaders[r.id];s||(s=new e.PixiShader(r),s.fragmentSrc=t.fragmentSrc,s.uniforms=t.uniforms,s.init(),t.shaders[r.id]=s),r.useProgram(s.program),r.uniform2f(s.projectionVector,n/2,-o/2),r.uniform2f(s.offsetVector,0,0),t.uniforms.dimensions&&(t.uniforms.dimensions.value[0]=this.width,t.uniforms.dimensions.value[1]=this.height,t.uniforms.dimensions.value[2]=this.vertexArray[0],t.uniforms.dimensions.value[3]=this.vertexArray[5]),s.syncUniforms(),r.bindBuffer(r.ARRAY_BUFFER,this.vertexBuffer),r.vertexAttribPointer(s.aVertexPosition,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.uvBuffer),r.vertexAttribPointer(s.aTextureCoord,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.colorBuffer),r.vertexAttribPointer(s.colorAttribute,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.indexBuffer),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),this.renderSession.drawCount++},e.WebGLFilterManager.prototype.initShaderBuffers=function(){var t=this.gl;this.vertexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW),this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvArray,t.STATIC_DRAW),this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),t.STATIC_DRAW)},e.WebGLFilterManager.prototype.destroy=function(){var t=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var e=0;e<this.texturePool.length;e++)this.texturePool.destroy();this.texturePool=null,t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.uvBuffer),t.deleteBuffer(this.colorBuffer),t.deleteBuffer(this.indexBuffer)},e.FilterTexture=function(t,i,n,o){this.gl=t,this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),o=o||e.scaleModes.DEFAULT,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,o===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,o===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer),this.resize(i,n)},e.FilterTexture.prototype.clear=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},e.FilterTexture.prototype.resize=function(t,e){if(this.width!==t||this.height!==e){this.width=t,this.height=e;var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindRenderbuffer(i.RENDERBUFFER,this.renderBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e)}},e.FilterTexture.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},e.CanvasMaskManager=function(){},e.CanvasMaskManager.prototype.pushMask=function(t,i){i.save();var n=t.alpha,o=t.worldTransform;i.setTransform(o.a,o.c,o.b,o.d,o.tx,o.ty),e.CanvasGraphics.renderGraphicsMask(t,i),i.clip(),t.worldAlpha=n},e.CanvasMaskManager.prototype.popMask=function(t){t.restore()},e.CanvasTinter=function(){},e.CanvasTinter.getTintedTexture=function(t,i){var n=t.texture;i=e.CanvasTinter.roundColor(i);var o="#"+("00000"+(0|i).toString(16)).substr(-6);if(n.tintCache=n.tintCache||{},n.tintCache[o])return n.tintCache[o];var r=e.CanvasTinter.canvas||document.createElement("canvas");if(e.CanvasTinter.tintMethod(n,i,r),e.CanvasTinter.convertTintToImage){var s=new Image;s.src=r.toDataURL(),n.tintCache[o]=s}else n.tintCache[o]=r,e.CanvasTinter.canvas=null;return r},e.CanvasTinter.tintWithMultiply=function(t,e,i){var n=i.getContext("2d"),o=t.frame;i.width=o.width,i.height=o.height,n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},e.CanvasTinter.tintWithOverlay=function(t,e,i){var n=i.getContext("2d"),o=t.frame;i.width=o.width,i.height=o.height,n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},e.CanvasTinter.tintWithPerPixel=function(t,i,n){var o=n.getContext("2d"),r=t.frame;n.width=r.width,n.height=r.height,o.globalCompositeOperation="copy",o.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);for(var s=e.hex2rgb(i),a=s[0],h=s[1],l=s[2],u=o.getImageData(0,0,r.width,r.height),c=u.data,d=0;d<c.length;d+=4)c[d+0]*=a,c[d+1]*=h,c[d+2]*=l;o.putImageData(u,0,0)},e.CanvasTinter.roundColor=function(t){var i=e.CanvasTinter.cacheStepsPerColorChannel,n=e.hex2rgb(t);return n[0]=Math.min(255,n[0]/i*i),n[1]=Math.min(255,n[1]/i*i),n[2]=Math.min(255,n[2]/i*i),e.rgb2hex(n)},e.CanvasTinter.cacheStepsPerColorChannel=8,e.CanvasTinter.convertTintToImage=!1,e.CanvasTinter.canUseMultiply=e.canUseNewCanvasBlendModes(),e.CanvasTinter.tintMethod=e.CanvasTinter.canUseMultiply?e.CanvasTinter.tintWithMultiply:e.CanvasTinter.tintWithPerPixel,e.CanvasRenderer=function(t,i,n,o){e.defaultRenderer=e.defaultRenderer||this,this.type=e.CANVAS_RENDERER,this.clearBeforeRender=!0,this.roundPixels=!1,this.transparent=!!o,e.blendModesCanvas||(e.blendModesCanvas=[],e.canUseNewCanvasBlendModes()?(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="multiply",e.blendModesCanvas[e.blendModes.SCREEN]="screen",e.blendModesCanvas[e.blendModes.OVERLAY]="overlay",e.blendModesCanvas[e.blendModes.DARKEN]="darken",e.blendModesCanvas[e.blendModes.LIGHTEN]="lighten",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="color-dodge",e.blendModesCanvas[e.blendModes.COLOR_BURN]="color-burn",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="hard-light",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="soft-light",e.blendModesCanvas[e.blendModes.DIFFERENCE]="difference",e.blendModesCanvas[e.blendModes.EXCLUSION]="exclusion",e.blendModesCanvas[e.blendModes.HUE]="hue",e.blendModesCanvas[e.blendModes.SATURATION]="saturation",e.blendModesCanvas[e.blendModes.COLOR]="color",e.blendModesCanvas[e.blendModes.LUMINOSITY]="luminosity"):(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="source-over",e.blendModesCanvas[e.blendModes.SCREEN]="source-over",e.blendModesCanvas[e.blendModes.OVERLAY]="source-over",e.blendModesCanvas[e.blendModes.DARKEN]="source-over",e.blendModesCanvas[e.blendModes.LIGHTEN]="source-over",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="source-over",e.blendModesCanvas[e.blendModes.COLOR_BURN]="source-over",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.DIFFERENCE]="source-over",e.blendModesCanvas[e.blendModes.EXCLUSION]="source-over",e.blendModesCanvas[e.blendModes.HUE]="source-over",e.blendModesCanvas[e.blendModes.SATURATION]="source-over",e.blendModesCanvas[e.blendModes.COLOR]="source-over",e.blendModesCanvas[e.blendModes.LUMINOSITY]="source-over")),this.width=t||800,this.height=i||600,this.view=n||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width,this.view.height=this.height,this.count=0,this.maskManager=new e.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null},"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="oImageSmoothingEnabled")},e.CanvasRenderer.prototype.constructor=e.CanvasRenderer,e.CanvasRenderer.prototype.render=function(t){e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,!this.transparent&&this.clearBeforeRender?(this.context.fillStyle=t.backgroundColorString,this.context.fillRect(0,0,this.width,this.height)):this.transparent&&this.clearBeforeRender&&this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),e.Texture.frameUpdates.length>0&&(e.Texture.frameUpdates.length=0)},e.CanvasRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e},e.CanvasRenderer.prototype.renderDisplayObject=function(t,e){this.renderSession.context=e||this.context,t._renderCanvas(this.renderSession)},e.CanvasRenderer.prototype.renderStripFlat=function(t){var e=this.context,i=t.verticies,n=i.length/2;this.count++,e.beginPath();for(var o=1;n-2>o;o++){var r=2*o,s=i[r],a=i[r+2],h=i[r+4],l=i[r+1],u=i[r+3],c=i[r+5];e.moveTo(s,l),e.lineTo(a,u),e.lineTo(h,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},e.CanvasRenderer.prototype.renderStrip=function(t){var e=this.context,i=t.verticies,n=t.uvs,o=i.length/2;this.count++;for(var r=1;o-2>r;r++){var s=2*r,a=i[s],h=i[s+2],l=i[s+4],u=i[s+1],c=i[s+3],d=i[s+5],p=n[s]*t.texture.width,f=n[s+2]*t.texture.width,g=n[s+4]*t.texture.width,m=n[s+1]*t.texture.height,y=n[s+3]*t.texture.height,b=n[s+5]*t.texture.height;e.save(),e.beginPath(),e.moveTo(a,u),e.lineTo(h,c),e.lineTo(l,d),e.closePath(),e.clip();var v=p*y+m*g+f*b-y*g-m*f-p*b,x=a*y+m*l+h*b-y*l-m*h-a*b,w=p*h+a*g+f*l-h*g-a*f-p*l,C=p*y*l+m*h*g+a*f*b-a*y*g-m*f*l-p*h*b,S=u*y+m*d+c*b-y*d-m*c-u*b,T=p*c+u*g+f*d-c*g-u*f-p*d,_=p*y*d+m*c*g+u*f*b-u*y*g-m*f*d-p*c*b;e.transform(x/v,S/v,w/v,T/v,C/v,_/v),e.drawImage(t.texture.baseTexture.source,0,0),e.restore()}},e.CanvasBuffer=function(t,e){this.width=t,this.height=e,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e},e.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.CanvasBuffer.prototype.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e},e.CanvasGraphics=function(){},e.CanvasGraphics.renderGraphics=function(t,i){for(var n=t.worldAlpha,o="",r=0;r<t.graphicsData.length;r++){var s=t.graphicsData[r],a=s.points;if(i.strokeStyle=o="#"+("00000"+(0|s.lineColor).toString(16)).substr(-6),i.lineWidth=s.lineWidth,s.type===e.Graphics.POLY){i.beginPath(),i.moveTo(a[0],a[1]);for(var h=1;h<a.length/2;h++)i.lineTo(a[2*h],a[2*h+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&i.closePath(),s.fill&&(i.globalAlpha=s.fillAlpha*n,i.fillStyle=o="#"+("00000"+(0|s.fillColor).toString(16)).substr(-6),i.fill()),s.lineWidth&&(i.globalAlpha=s.lineAlpha*n,i.stroke())}else if(s.type===e.Graphics.RECT)(s.fillColor||0===s.fillColor)&&(i.globalAlpha=s.fillAlpha*n,i.fillStyle=o="#"+("00000"+(0|s.fillColor).toString(16)).substr(-6),i.fillRect(a[0],a[1],a[2],a[3])),s.lineWidth&&(i.globalAlpha=s.lineAlpha*n,i.strokeRect(a[0],a[1],a[2],a[3]));else if(s.type===e.Graphics.CIRC)i.beginPath(),i.arc(a[0],a[1],a[2],0,2*Math.PI),i.closePath(),s.fill&&(i.globalAlpha=s.fillAlpha*n,i.fillStyle=o="#"+("00000"+(0|s.fillColor).toString(16)).substr(-6),i.fill()),s.lineWidth&&(i.globalAlpha=s.lineAlpha*n,i.stroke());else if(s.type===e.Graphics.ELIP){var l=s.points,u=2*l[2],c=2*l[3],d=l[0]-u/2,p=l[1]-c/2;i.beginPath();var f=.5522848,g=u/2*f,m=c/2*f,y=d+u,b=p+c,v=d+u/2,x=p+c/2;i.moveTo(d,x),i.bezierCurveTo(d,x-m,v-g,p,v,p),i.bezierCurveTo(v+g,p,y,x-m,y,x),i.bezierCurveTo(y,x+m,v+g,b,v,b),i.bezierCurveTo(v-g,b,d,x+m,d,x),i.closePath(),s.fill&&(i.globalAlpha=s.fillAlpha*n,i.fillStyle=o="#"+("00000"+(0|s.fillColor).toString(16)).substr(-6),i.fill()),s.lineWidth&&(i.globalAlpha=s.lineAlpha*n,i.stroke())}}},e.CanvasGraphics.renderGraphicsMask=function(t,i){var n=t.graphicsData.length;if(0!==n){n>1&&(n=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var o=0;1>o;o++){var r=t.graphicsData[o],s=r.points;if(r.type===e.Graphics.POLY){i.beginPath(),i.moveTo(s[0],s[1]);for(var a=1;a<s.length/2;a++)i.lineTo(s[2*a],s[2*a+1]);s[0]===s[s.length-2]&&s[1]===s[s.length-1]&&i.closePath()}else if(r.type===e.Graphics.RECT)i.beginPath(),i.rect(s[0],s[1],s[2],s[3]),i.closePath();else if(r.type===e.Graphics.CIRC)i.beginPath(),i.arc(s[0],s[1],s[2],0,2*Math.PI),i.closePath();else if(r.type===e.Graphics.ELIP){var h=r.points,l=2*h[2],u=2*h[3],c=h[0]-l/2,d=h[1]-u/2;i.beginPath();var p=.5522848,f=l/2*p,g=u/2*p,m=c+l,y=d+u,b=c+l/2,v=d+u/2;i.moveTo(c,v),i.bezierCurveTo(c,v-g,b-f,d,b,d),i.bezierCurveTo(b+f,d,m,v-g,m,v),i.bezierCurveTo(m,v+g,b+f,y,b,y),i.bezierCurveTo(b-f,y,c,v+g,c,v),i.closePath()}}}},e.Graphics=function(){e.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor="black",this.graphicsData=[],this.tint=16777215,this.blendMode=e.blendModes.NORMAL,this.currentPath={points:[]},this._webGL=[],this.isMask=!1,this.bounds=null,this.boundsPadding=10},e.Graphics.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Graphics.prototype.constructor=e.Graphics,Object.defineProperty(e.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),e.Graphics.prototype.lineStyle=function(t,i,n){return this.currentPath.points.length||this.graphicsData.pop(),this.lineWidth=t||0,this.lineColor=i||0,this.lineAlpha=arguments.length<3?1:n,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.moveTo=function(t,i){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.currentPath.points.push(t,i),this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.lineTo=function(t,e){return this.currentPath.points.push(t,e),this.dirty=!0,this},e.Graphics.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=arguments.length<2?1:e,this},e.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.Graphics.prototype.drawRect=function(t,i,n,o){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,n,o],type:e.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawCircle=function(t,i,n){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,n,n],type:e.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawEllipse=function(t,i,n,o){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,n,o],type:e.Graphics.ELIP},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this.bounds=null,this},e.Graphics.prototype.generateTexture=function(){var t=this.getBounds(),i=new e.CanvasBuffer(t.width,t.height),n=e.Texture.fromCanvas(i.canvas);return i.context.translate(-t.x,-t.y),e.CanvasGraphics.renderGraphics(this,i.context),n},e.Graphics.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return this.dirty&&(this._generateCachedSprite(),e.updateWebGLTexture(this._cachedSprite.texture.baseTexture,t.gl),this.dirty=!1),this._cachedSprite.alpha=this.alpha,void e.Sprite.prototype._renderWebGL.call(this._cachedSprite,t);if(t.spriteBatch.stop(),this._mask&&t.maskManager.pushMask(this.mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode){t.spriteBatch.currentBlendMode=this.blendMode;var i=e.blendModesWebGL[t.spriteBatch.currentBlendMode];t.spriteBatch.gl.blendFunc(i[0],i[1])}if(e.WebGLGraphics.renderGraphics(this,t),this.children.length){t.spriteBatch.start();for(var n=0,o=this.children.length;o>n;n++)this.children[n]._renderWebGL(t);
t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),t.drawCount++,t.spriteBatch.start()}},e.Graphics.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){var i=t.context,n=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,i.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),i.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),e.CanvasGraphics.renderGraphics(this,i);for(var o=0,r=this.children.length;r>o;o++)this.children[o]._renderCanvas(t)}},e.Graphics.prototype.getBounds=function(t){this.bounds||this.updateBounds();var e=this.bounds.x,i=this.bounds.width+this.bounds.x,n=this.bounds.y,o=this.bounds.height+this.bounds.y,r=t||this.worldTransform,s=r.a,a=r.c,h=r.b,l=r.d,u=r.tx,c=r.ty,d=s*i+h*o+u,p=l*o+a*i+c,f=s*e+h*o+u,g=l*o+a*e+c,m=s*e+h*n+u,y=l*n+a*e+c,b=s*i+h*n+u,v=l*n+a*i+c,x=d,w=p,C=d,S=p;C=C>f?f:C,C=C>m?m:C,C=C>b?b:C,S=S>g?g:S,S=S>y?y:S,S=S>v?v:S,x=f>x?f:x,x=m>x?m:x,x=b>x?b:x,w=g>w?g:w,w=y>w?y:w,w=v>w?v:w;var T=this._bounds;return T.x=C,T.width=x-C,T.y=S,T.height=w-S,T},e.Graphics.prototype.updateBounds=function(){for(var t,i,n,o,r,s=1/0,a=-1/0,h=1/0,l=-1/0,u=0;u<this.graphicsData.length;u++){var c=this.graphicsData[u],d=c.type,p=c.lineWidth;if(t=c.points,d===e.Graphics.RECT)i=t[0]-p/2,n=t[1]-p/2,o=t[2]+p,r=t[3]+p,s=s>i?i:s,a=i+o>a?i+o:a,h=h>n?i:h,l=n+r>l?n+r:l;else if(d===e.Graphics.CIRC||d===e.Graphics.ELIP)i=t[0],n=t[1],o=t[2]+p/2,r=t[3]+p/2,s=s>i-o?i-o:s,a=i+o>a?i+o:a,h=h>n-r?n-r:h,l=n+r>l?n+r:l;else for(var f=0;f<t.length;f+=2)i=t[f],n=t[f+1],s=s>i-p?i-p:s,a=i+p>a?i+p:a,h=h>n-p?n-p:h,l=n+p>l?n+p:l}var g=this.boundsPadding;this.bounds=new e.Rectangle(s-g,h-g,a-s+2*g,l-h+2*g)},e.Graphics.prototype._generateCachedSprite=function(){var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(t.width,t.height);else{var i=new e.CanvasBuffer(t.width,t.height),n=e.Texture.fromCanvas(i.canvas);this._cachedSprite=new e.Sprite(n),this._cachedSprite.buffer=i,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._cachedSprite.buffer.context.translate(-t.x,-t.y),e.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},e.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},e.Graphics.POLY=0,e.Graphics.RECT=1,e.Graphics.CIRC=2,e.Graphics.ELIP=3,e.Strip=function(t,i,n){e.Sprite.call(this,t),this.width=i,this.height=n,this.texture=t,this.blendMode=e.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(o){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}t.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Strip.prototype=Object.create(e.Sprite.prototype),e.Strip.prototype.constructor=e.Strip,e.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.Rope=function(t,i){e.Strip.call(this,t),this.points=i;try{this.verticies=new Float32Array(4*i.length),this.uvs=new Float32Array(4*i.length),this.colors=new Float32Array(2*i.length),this.indices=new Uint16Array(2*i.length)}catch(n){this.verticies=new Array(4*i.length),this.uvs=new Array(4*i.length),this.colors=new Array(2*i.length),this.indices=new Array(2*i.length)}this.refresh()},e.Rope.prototype=Object.create(e.Strip.prototype),e.Rope.prototype.constructor=e.Rope,e.Rope.prototype.refresh=function(){var t=this.points;if(!(t.length<1)){var e=this.uvs,i=t[0],n=this.indices,o=this.colors;this.count-=.2,e[0]=0,e[1]=1,e[2]=0,e[3]=1,o[0]=1,o[1]=1,n[0]=0,n[1]=1;for(var r,s,a,h=t.length,l=1;h>l;l++)r=t[l],s=4*l,a=l/(h-1),l%2?(e[s]=a,e[s+1]=0,e[s+2]=a,e[s+3]=1):(e[s]=a,e[s+1]=0,e[s+2]=a,e[s+3]=1),s=2*l,o[s]=1,o[s+1]=1,s=2*l,n[s]=s,n[s+1]=s+1,i=r}},e.Rope.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){var i,n=t[0],o={x:0,y:0};this.count-=.2;var r=this.verticies;r[0]=n.x+o.x,r[1]=n.y+o.y,r[2]=n.x-o.x,r[3]=n.y-o.y;for(var s,a,h,l,u,c=t.length,d=1;c>d;d++)s=t[d],a=4*d,i=d<t.length-1?t[d+1]:s,o.y=-(i.x-n.x),o.x=i.y-n.y,h=10*(1-d/(c-1)),h>1&&(h=1),l=Math.sqrt(o.x*o.x+o.y*o.y),u=this.texture.height/2,o.x/=l,o.y/=l,o.x*=u,o.y*=u,r[a]=s.x+o.x,r[a+1]=s.y+o.y,r[a+2]=s.x-o.x,r[a+3]=s.y-o.y,n=s;e.DisplayObjectContainer.prototype.updateTransform.call(this)}},e.Rope.prototype.setTexture=function(t){this.texture=t,this.updateFrame=!0},e.TilingSprite=function(t,i,n){e.Sprite.call(this,t),this.width=i||100,this.height=n||100,this.tileScale=new e.Point(1,1),this.tileScaleOffset=new e.Point(1,1),this.tilePosition=new e.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL},e.TilingSprite.prototype=Object.create(e.Sprite.prototype),e.TilingSprite.prototype.constructor=e.TilingSprite,Object.defineProperty(e.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t}}),Object.defineProperty(e.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t}}),e.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.TilingSprite.prototype.setTexture=function(t){this.texture!==t&&(this.texture=t,this.refreshTexture=!0,this.cachedTint=16777215)},e.TilingSprite.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha){var i,n;for(this.mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this.filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(e.updateWebGLTexture(this.tilingTexture.baseTexture,t.gl),this.tilingTexture.needsUpdate=!1)):t.spriteBatch.renderTilingSprite(this),i=0,n=this.children.length;n>i;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop(),this.filters&&t.filterManager.popFilter(),this.mask&&t.maskManager.popMask(t),t.spriteBatch.start()}},e.TilingSprite.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){var i=t.context;this._mask&&t.maskManager.pushMask(this._mask,i),i.globalAlpha=this.worldAlpha;var n=this.worldTransform;if(i.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=i.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,i.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),i.beginPath();var o=this.tilePosition,r=this.tileScale;o.x%=this.tilingTexture.baseTexture.width,o.y%=this.tilingTexture.baseTexture.height,i.scale(r.x,r.y),i.translate(o.x,o.y),i.fillStyle=this.__tilePattern,i.fillRect(-o.x+this.anchor.x*-this._width,-o.y+this.anchor.y*-this._height,this._width/r.x,this._height/r.y),i.scale(1/r.x,1/r.y),i.translate(-o.x,-o.y),i.closePath(),this._mask&&t.maskManager.popMask(t.context)}},e.TilingSprite.prototype.getBounds=function(){var t=this._width,e=this._height,i=t*(1-this.anchor.x),n=t*-this.anchor.x,o=e*(1-this.anchor.y),r=e*-this.anchor.y,s=this.worldTransform,a=s.a,h=s.c,l=s.b,u=s.d,c=s.tx,d=s.ty,p=a*n+l*r+c,f=u*r+h*n+d,g=a*i+l*r+c,m=u*r+h*i+d,y=a*i+l*o+c,b=u*o+h*i+d,v=a*n+l*o+c,x=u*o+h*n+d,w=-1/0,C=-1/0,S=1/0,T=1/0;S=S>p?p:S,S=S>g?g:S,S=S>y?y:S,S=S>v?v:S,T=T>f?f:T,T=T>m?m:T,T=T>b?b:T,T=T>x?x:T,w=p>w?p:w,w=g>w?g:w,w=y>w?y:w,w=v>w?v:w,C=f>C?f:C,C=m>C?m:C,C=b>C?b:C,C=x>C?x:C;var _=this._bounds;return _.x=S,_.width=w-S,_.y=T,_.height=C-T,this._currentBounds=_,_},e.TilingSprite.prototype.generateTilingTexture=function(t){var i=this.texture;if(i.baseTexture.hasLoaded){var n,o,r=i.baseTexture,s=i.frame,a=s.width!==r.width||s.height!==r.height,h=!1;if(t?(n=e.getNextPowerOfTwo(s.width),o=e.getNextPowerOfTwo(s.height),s.width!==n&&s.height!==o&&(h=!0)):a&&(n=s.width,o=s.height,h=!0),h){var l;this.tilingTexture&&this.tilingTexture.isTiling?(l=this.tilingTexture.canvasBuffer,l.resize(n,o),this.tilingTexture.baseTexture.width=n,this.tilingTexture.baseTexture.height=o,this.tilingTexture.needsUpdate=!0):(l=new e.CanvasBuffer(n,o),this.tilingTexture=e.Texture.fromCanvas(l.canvas),this.tilingTexture.canvasBuffer=l,this.tilingTexture.isTiling=!0),l.context.drawImage(i.baseTexture.source,s.x,s.y,s.width,s.height,0,0,n,o),this.tileScaleOffset.x=s.width/n,this.tileScaleOffset.y=s.height/o}else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=i;this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0}};var s={};s.BoneData=function(t,e){this.name=t,this.parent=e},s.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1},s.SlotData=function(t,e){this.name=t,this.boneData=e},s.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null},s.Bone=function(t,e){this.data=t,this.parent=e,this.setToSetupPose()},s.Bone.yDown=!1,s.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(t,e){var i=this.parent;null!=i?(this.worldX=this.x*i.m00+this.y*i.m01+i.worldX,this.worldY=this.x*i.m10+this.y*i.m11+i.worldY,this.worldScaleX=i.worldScaleX*this.scaleX,this.worldScaleY=i.worldScaleY*this.scaleY,this.worldRotation=i.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var n=this.worldRotation*Math.PI/180,o=Math.cos(n),r=Math.sin(n);this.m00=o*this.worldScaleX,this.m10=r*this.worldScaleX,this.m01=-r*this.worldScaleY,this.m11=o*this.worldScaleY,t&&(this.m00=-this.m00,this.m01=-this.m01),e&&(this.m10=-this.m10,this.m11=-this.m11),s.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY}},s.Slot=function(t,e,i){this.data=t,this.skeleton=e,this.bone=i,this.setToSetupPose()},s.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(t){this.attachment=t,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(t){this._attachmentTime=this.skeleton.time-t},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var t=this.data;this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a;for(var e=this.skeleton.data.slots,i=0,n=e.length;n>i;i++)if(e[i]==t){this.setAttachment(t.attachmentName?this.skeleton.getAttachmentBySlotIndex(i,t.attachmentName):null);break}}},s.Skin=function(t){this.name=t,this.attachments={}},s.Skin.prototype={addAttachment:function(t,e,i){this.attachments[t+":"+e]=i},getAttachment:function(t,e){return this.attachments[t+":"+e]},_attachAll:function(t,e){for(var i in e.attachments){var n=i.indexOf(":"),o=parseInt(i.substring(0,n),10),r=i.substring(n+1),s=t.slots[o];if(s.attachment&&s.attachment.name==r){var a=this.getAttachment(o,r);a&&s.setAttachment(a)}}}},s.Animation=function(t,e,i){this.name=t,this.timelines=e,this.duration=i},s.Animation.prototype={apply:function(t,e,i){i&&this.duration&&(e%=this.duration);for(var n=this.timelines,o=0,r=n.length;r>o;o++)n[o].apply(t,e,1)},mix:function(t,e,i,n){i&&this.duration&&(e%=this.duration);for(var o=this.timelines,r=0,s=o.length;s>r;r++)o[r].apply(t,e,n)}},s.binarySearch=function(t,e,i){var n=0,o=Math.floor(t.length/i)-2;if(!o)return i;for(var r=o>>>1;;){if(t[(r+1)*i]<=e?n=r+1:o=r,n==o)return(n+1)*i;r=n+o>>>1}},s.linearSearch=function(t,e,i){for(var n=0,o=t.length-i;o>=n;n+=i)if(t[n]>e)return n;return-1},s.Curves=function(t){this.curves=[],this.curves.length=6*(t-1)},s.Curves.prototype={setLinear:function(t){this.curves[6*t]=0},setStepped:function(t){this.curves[6*t]=-1},setCurve:function(t,e,i,n,o){var r=.1,s=r*r,a=s*r,h=3*r,l=3*s,u=6*s,c=6*a,d=2*-e+n,p=2*-i+o,f=3*(e-n)+1,g=3*(i-o)+1,m=6*t,y=this.curves;y[m]=e*h+d*l+f*a,y[m+1]=i*h+p*l+g*a,y[m+2]=d*u+f*c,y[m+3]=p*u+g*c,y[m+4]=f*c,y[m+5]=g*c},getCurvePercent:function(t,e){e=0>e?0:e>1?1:e;var i=6*t,n=this.curves,o=n[i];if(!o)return e;if(-1==o)return 0;for(var r=n[i+1],s=n[i+2],a=n[i+3],h=n[i+4],l=n[i+5],u=o,c=r,d=8;;){if(u>=e){var p=u-o,f=c-r;return f+(c-f)*(e-p)/(u-p)}if(!d)break;d--,o+=s,r+=a,s+=h,a+=l,u+=o,c+=r}return c+(1-c)*(e-u)/(1-u)}},s.RotateTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=2*t},s.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,i){t*=2,this.frames[t]=e,this.frames[t+1]=i},apply:function(t,e,i){var n,o=this.frames;if(!(e<o[0])){var r=t.bones[this.boneIndex];if(e>=o[o.length-2]){for(n=r.data.rotation+o[o.length-1]-r.rotation;n>180;)n-=360;for(;-180>n;)n+=360;return void(r.rotation+=n*i)}var a=s.binarySearch(o,e,2),h=o[a-1],l=o[a],u=1-(e-l)/(o[a-2]-l);for(u=this.curves.getCurvePercent(a/2-1,u),n=o[a+1]-h;n>180;)n-=360;for(;-180>n;)n+=360;for(n=r.data.rotation+(h+n*u)-r.rotation;n>180;)n-=360;for(;-180>n;)n+=360;r.rotation+=n*i}}},s.TranslateTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=3*t},s.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,i,n){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n},apply:function(t,e,i){var n=this.frames;if(!(e<n[0])){var o=t.bones[this.boneIndex];if(e>=n[n.length-3])return o.x+=(o.data.x+n[n.length-2]-o.x)*i,void(o.y+=(o.data.y+n[n.length-1]-o.y)*i);var r=s.binarySearch(n,e,3),a=n[r-2],h=n[r-1],l=n[r],u=1-(e-l)/(n[r+-3]-l);u=this.curves.getCurvePercent(r/3-1,u),o.x+=(o.data.x+a+(n[r+1]-a)*u-o.x)*i,o.y+=(o.data.y+h+(n[r+2]-h)*u-o.y)*i}}},s.ScaleTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=3*t},s.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,i,n){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n},apply:function(t,e,i){var n=this.frames;if(!(e<n[0])){var o=t.bones[this.boneIndex];if(e>=n[n.length-3])return o.scaleX+=(o.data.scaleX-1+n[n.length-2]-o.scaleX)*i,void(o.scaleY+=(o.data.scaleY-1+n[n.length-1]-o.scaleY)*i);var r=s.binarySearch(n,e,3),a=n[r-2],h=n[r-1],l=n[r],u=1-(e-l)/(n[r+-3]-l);u=this.curves.getCurvePercent(r/3-1,u),o.scaleX+=(o.data.scaleX-1+a+(n[r+1]-a)*u-o.scaleX)*i,o.scaleY+=(o.data.scaleY-1+h+(n[r+2]-h)*u-o.scaleY)*i}}},s.ColorTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=5*t},s.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e){t*=5,this.frames[t]=e,this.frames[t+1]=r,this.frames[t+2]=g,this.frames[t+3]=b,this.frames[t+4]=a},apply:function(t,e,i){var n=this.frames;if(!(e<n[0])){var o=t.slots[this.slotIndex];if(e>=n[n.length-5]){var r=n.length-1;return o.r=n[r-3],o.g=n[r-2],o.b=n[r-1],void(o.a=n[r])}var a=s.binarySearch(n,e,5),h=n[a-4],l=n[a-3],u=n[a-2],c=n[a-1],d=n[a],p=1-(e-d)/(n[a-5]-d);p=this.curves.getCurvePercent(a/5-1,p);var f=h+(n[a+1]-h)*p,g=l+(n[a+2]-l)*p,m=u+(n[a+3]-u)*p,y=c+(n[a+4]-c)*p;1>i?(o.r+=(f-o.r)*i,o.g+=(g-o.g)*i,o.b+=(m-o.b)*i,o.a+=(y-o.a)*i):(o.r=f,o.g=g,o.b=m,o.a=y)}}},s.AttachmentTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=t,this.attachmentNames=[],this.attachmentNames.length=t},s.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i},apply:function(t,e){var i=this.frames;if(!(e<i[0])){var n;n=e>=i[i.length-1]?i.length-1:s.binarySearch(i,e,1)-1;var o=this.attachmentNames[n];t.slots[this.slotIndex].setAttachment(o?t.getAttachmentBySlotIndex(this.slotIndex,o):null)}}},s.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.animations=[]},s.SkeletonData.prototype={defaultSkin:null,findBone:function(t){for(var e=this.bones,i=0,n=e.length;n>i;i++)if(e[i].name==t)return e[i];return null},findBoneIndex:function(t){for(var e=this.bones,i=0,n=e.length;n>i;i++)if(e[i].name==t)return i;return-1},findSlot:function(t){for(var e=this.slots,i=0,n=e.length;n>i;i++)if(e[i].name==t)return slot[i];return null},findSlotIndex:function(t){for(var e=this.slots,i=0,n=e.length;n>i;i++)if(e[i].name==t)return i;return-1},findSkin:function(t){for(var e=this.skins,i=0,n=e.length;n>i;i++)if(e[i].name==t)return e[i];return null},findAnimation:function(t){for(var e=this.animations,i=0,n=e.length;n>i;i++)if(e[i].name==t)return e[i];return null}},s.Skeleton=function(t){this.data=t,this.bones=[];for(var e=0,i=t.bones.length;i>e;e++){var n=t.bones[e],o=n.parent?this.bones[t.bones.indexOf(n.parent)]:null;this.bones.push(new s.Bone(n,o))}for(this.slots=[],this.drawOrder=[],e=0,i=t.slots.length;i>e;e++){var r=t.slots[e],a=this.bones[t.bones.indexOf(r.boneData)],h=new s.Slot(r,this,a);this.slots.push(h),this.drawOrder.push(h)}},s.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var t=this.flipX,e=this.flipY,i=this.bones,n=0,o=i.length;o>n;n++)i[n].updateWorldTransform(t,e)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,e=0,i=t.length;i>e;e++)t[e].setToSetupPose()},setSlotsToSetupPose:function(){for(var t=this.slots,e=0,i=t.length;i>e;e++)t[e].setToSetupPose(e)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(t){for(var e=this.bones,i=0,n=e.length;n>i;i++)if(e[i].data.name==t)return e[i];return null},findBoneIndex:function(t){for(var e=this.bones,i=0,n=e.length;n>i;i++)if(e[i].data.name==t)return i;return-1},findSlot:function(t){for(var e=this.slots,i=0,n=e.length;n>i;i++)if(e[i].data.name==t)return e[i];return null},findSlotIndex:function(t){for(var e=this.slots,i=0,n=e.length;n>i;i++)if(e[i].data.name==t)return i;return-1},setSkinByName:function(t){var e=this.data.findSkin(t);if(!e)throw"Skin not found: "+t;this.setSkin(e)},setSkin:function(t){this.skin&&t&&t._attachAll(this,this.skin),this.skin=t},getAttachmentBySlotName:function(t,e){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(t),e)},getAttachmentBySlotIndex:function(t,e){if(this.skin){var i=this.skin.getAttachment(t,e);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},setAttachment:function(t,e){for(var i=this.slots,n=0,o=i.size;o>n;n++){var r=i[n];if(r.data.name==t){var s=null;if(e&&(s=this.getAttachment(n,e),null==s))throw"Attachment not found: "+e+", for slot: "+t;return void r.setAttachment(s)}}throw"Slot not found: "+t},update:function(t){time+=t}},s.AttachmentType={region:0},s.RegionAttachment=function(){this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},s.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,e,i,n,o){var r=this.uvs;o?(r[2]=t,r[3]=n,r[4]=t,r[5]=e,r[6]=i,r[7]=e,r[0]=i,r[1]=n):(r[0]=t,r[1]=n,r[2]=t,r[3]=e,r[4]=i,r[5]=e,r[6]=i,r[7]=n)},updateOffset:function(){var t=this.width/this.regionOriginalWidth*this.scaleX,e=this.height/this.regionOriginalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.regionOffsetX*t,n=-this.height/2*this.scaleY+this.regionOffsetY*e,o=i+this.regionWidth*t,r=n+this.regionHeight*e,s=this.rotation*Math.PI/180,a=Math.cos(s),h=Math.sin(s),l=i*a+this.x,u=i*h,c=n*a+this.y,d=n*h,p=o*a+this.x,f=o*h,g=r*a+this.y,m=r*h,y=this.offset;y[0]=l-d,y[1]=c+u,y[2]=l-m,y[3]=g+u,y[4]=p-m,y[5]=g+f,y[6]=p-d,y[7]=c+f},computeVertices:function(t,e,i,n){t+=i.worldX,e+=i.worldY;var o=i.m00,r=i.m01,s=i.m10,a=i.m11,h=this.offset;n[0]=h[0]*o+h[1]*r+t,n[1]=h[0]*s+h[1]*a+e,n[2]=h[2]*o+h[3]*r+t,n[3]=h[2]*s+h[3]*a+e,n[4]=h[4]*o+h[5]*r+t,n[5]=h[4]*s+h[5]*a+e,n[6]=h[6]*o+h[7]*r+t,n[7]=h[6]*s+h[7]*a+e}},s.AnimationStateData=function(t){this.skeletonData=t,this.animationToMixTime={}},s.AnimationStateData.prototype={defaultMix:0,setMixByName:function(t,e,i){var n=this.skeletonData.findAnimation(t);if(!n)throw"Animation not found: "+t;var o=this.skeletonData.findAnimation(e);if(!o)throw"Animation not found: "+e;this.setMix(n,o,i)},setMix:function(t,e,i){this.animationToMixTime[t.name+":"+e.name]=i},getMix:function(t,e){var i=this.animationToMixTime[t.name+":"+e.name];return i?i:this.defaultMix}},s.AnimationState=function(t){this.data=t,this.queue=[]},s.AnimationState.prototype={current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(t){if(this.currentTime+=t,this.previousTime+=t,this.mixTime+=t,this.queue.length>0){var e=this.queue[0];this.currentTime>=e.delay&&(this._setAnimation(e.animation,e.loop),this.queue.shift())}},apply:function(t){if(this.current)if(this.previous){this.previous.apply(t,this.previousTime,this.previousLoop);var e=this.mixTime/this.mixDuration;e>=1&&(e=1,this.previous=null),this.current.mix(t,this.currentTime,this.currentLoop,e)}else this.current.apply(t,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null,this.current=null,this.queue.length=0},_setAnimation:function(t,e){this.previous=null,t&&this.current&&(this.mixDuration=this.data.getMix(this.current,t),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop)),this.current=t,this.currentLoop=e,this.currentTime=0},setAnimationByName:function(t,e){var i=this.data.skeletonData.findAnimation(t);if(!i)throw"Animation not found: "+t;this.setAnimation(i,e)},setAnimation:function(t,e){this.queue.length=0,this._setAnimation(t,e)},addAnimationByName:function(t,e,i){var n=this.data.skeletonData.findAnimation(t);if(!n)throw"Animation not found: "+t;this.addAnimation(n,e,i)},addAnimation:function(t,e,i){var n={};if(n.animation=t,n.loop=e,!i||0>=i){var o=this.queue.length?this.queue[this.queue.length-1].animation:this.current;i=null!=o?o.duration-this.data.getMix(o,t)+(i||0):0}n.delay=i,this.queue.push(n)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}},s.SkeletonJson=function(t){this.attachmentLoader=t},s.SkeletonJson.prototype={scale:1,readSkeletonData:function(t){for(var e,i=new s.SkeletonData,n=t.bones,o=0,r=n.length;r>o;o++){var a=n[o],h=null;if(a.parent&&(h=i.findBone(a.parent),!h))throw"Parent bone not found: "+a.parent;e=new s.BoneData(a.name,h),e.length=(a.length||0)*this.scale,e.x=(a.x||0)*this.scale,e.y=(a.y||0)*this.scale,e.rotation=a.rotation||0,e.scaleX=a.scaleX||1,e.scaleY=a.scaleY||1,i.bones.push(e)}var l=t.slots;for(o=0,r=l.length;r>o;o++){var u=l[o];if(e=i.findBone(u.bone),!e)throw"Slot bone not found: "+u.bone;var c=new s.SlotData(u.name,e),d=u.color;d&&(c.r=s.SkeletonJson.toColor(d,0),c.g=s.SkeletonJson.toColor(d,1),c.b=s.SkeletonJson.toColor(d,2),c.a=s.SkeletonJson.toColor(d,3)),c.attachmentName=u.attachment,i.slots.push(c)}var p=t.skins;for(var f in p)if(p.hasOwnProperty(f)){var g=p[f],m=new s.Skin(f);for(var y in g)if(g.hasOwnProperty(y)){var b=i.findSlotIndex(y),v=g[y];for(var x in v)if(v.hasOwnProperty(x)){var w=this.readAttachment(m,x,v[x]);null!=w&&m.addAttachment(b,x,w)}}i.skins.push(m),"default"==m.name&&(i.defaultSkin=m)}var C=t.animations;for(var S in C)C.hasOwnProperty(S)&&this.readAnimation(S,C[S],i);return i},readAttachment:function(t,e,i){e=i.name||e;var n=s.AttachmentType[i.type||"region"];if(n==s.AttachmentType.region){var o=new s.RegionAttachment;return o.x=(i.x||0)*this.scale,o.y=(i.y||0)*this.scale,o.scaleX=i.scaleX||1,o.scaleY=i.scaleY||1,o.rotation=i.rotation||0,o.width=(i.width||32)*this.scale,o.height=(i.height||32)*this.scale,o.updateOffset(),o.rendererObject={},o.rendererObject.name=e,o.rendererObject.scale={},o.rendererObject.scale.x=o.scaleX,o.rendererObject.scale.y=o.scaleY,o.rendererObject.rotation=-o.rotation*Math.PI/180,o}throw"Unknown attachment type: "+n},readAnimation:function(t,e,i){var n,o,r,a,h,l,u,c=[],d=0,p=e.bones;for(var f in p)if(p.hasOwnProperty(f)){var g=i.findBoneIndex(f);if(-1==g)throw"Bone not found: "+f;var m=p[f];for(r in m)if(m.hasOwnProperty(r))if(h=m[r],"rotate"==r){for(o=new s.RotateTimeline(h.length),o.boneIndex=g,n=0,l=0,u=h.length;u>l;l++)a=h[l],o.setFrame(n,a.time,a.angle),s.SkeletonJson.readCurve(o,n,a),n++;c.push(o),d=Math.max(d,o.frames[2*o.getFrameCount()-2])}else{if("translate"!=r&&"scale"!=r)throw"Invalid timeline type for a bone: "+r+" ("+f+")";var y=1;for("scale"==r?o=new s.ScaleTimeline(h.length):(o=new s.TranslateTimeline(h.length),y=this.scale),o.boneIndex=g,n=0,l=0,u=h.length;u>l;l++){a=h[l];var b=(a.x||0)*y,v=(a.y||0)*y;o.setFrame(n,a.time,b,v),s.SkeletonJson.readCurve(o,n,a),n++}c.push(o),d=Math.max(d,o.frames[3*o.getFrameCount()-3])}}var x=e.slots;for(var w in x)if(x.hasOwnProperty(w)){var C=x[w],S=i.findSlotIndex(w);for(r in C)if(C.hasOwnProperty(r))if(h=C[r],"color"==r){for(o=new s.ColorTimeline(h.length),o.slotIndex=S,n=0,l=0,u=h.length;u>l;l++){a=h[l];var T=a.color,_=s.SkeletonJson.toColor(T,0),A=s.SkeletonJson.toColor(T,1),k=s.SkeletonJson.toColor(T,2),M=s.SkeletonJson.toColor(T,3);o.setFrame(n,a.time,_,A,k,M),s.SkeletonJson.readCurve(o,n,a),n++}c.push(o),d=Math.max(d,o.frames[5*o.getFrameCount()-5])}else{if("attachment"!=r)throw"Invalid timeline type for a slot: "+r+" ("+w+")";for(o=new s.AttachmentTimeline(h.length),o.slotIndex=S,n=0,l=0,u=h.length;u>l;l++)a=h[l],o.setFrame(n++,a.time,a.name);c.push(o),d=Math.max(d,o.frames[o.getFrameCount()-1])}}i.animations.push(new s.Animation(t,c,d))}},s.SkeletonJson.readCurve=function(t,e,i){var n=i.curve;n&&("stepped"==n?t.curves.setStepped(e):n instanceof Array&&t.curves.setCurve(e,n[0],n[1],n[2],n[3]))},s.SkeletonJson.toColor=function(t,e){if(8!=t.length)throw"Color hexidecimal length must be 8, recieved: "+t;return parseInt(t.substring(2*e,2),16)/255},s.Atlas=function(t,e){this.textureLoader=e,this.pages=[],this.regions=[];var i=new s.AtlasReader(t),n=[];n.length=4;for(var o=null;;){var r=i.readLine();if(null==r)break;if(r=i.trim(r),r.length)if(o){var a=new s.AtlasRegion;a.name=r,a.page=o,a.rotate="true"==i.readValue(),i.readTuple(n);var h=parseInt(n[0],10),l=parseInt(n[1],10);i.readTuple(n);var u=parseInt(n[0],10),c=parseInt(n[1],10);a.u=h/o.width,a.v=l/o.height,a.rotate?(a.u2=(h+c)/o.width,a.v2=(l+u)/o.height):(a.u2=(h+u)/o.width,a.v2=(l+c)/o.height),a.x=h,a.y=l,a.width=Math.abs(u),a.height=Math.abs(c),4==i.readTuple(n)&&(a.splits=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10)],4==i.readTuple(n)&&(a.pads=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10)],i.readTuple(n))),a.originalWidth=parseInt(n[0],10),a.originalHeight=parseInt(n[1],10),i.readTuple(n),a.offsetX=parseInt(n[0],10),a.offsetY=parseInt(n[1],10),a.index=parseInt(i.readValue(),10),this.regions.push(a)}else{o=new s.AtlasPage,o.name=r,o.format=s.Atlas.Format[i.readValue()],i.readTuple(n),o.minFilter=s.Atlas.TextureFilter[n[0]],o.magFilter=s.Atlas.TextureFilter[n[1]];var d=i.readValue();o.uWrap=s.Atlas.TextureWrap.clampToEdge,o.vWrap=s.Atlas.TextureWrap.clampToEdge,"x"==d?o.uWrap=s.Atlas.TextureWrap.repeat:"y"==d?o.vWrap=s.Atlas.TextureWrap.repeat:"xy"==d&&(o.uWrap=o.vWrap=s.Atlas.TextureWrap.repeat),e.load(o,r),this.pages.push(o)}else o=null}},s.Atlas.prototype={findRegion:function(t){for(var e=this.regions,i=0,n=e.length;n>i;i++)if(e[i].name==t)return e[i];return null},dispose:function(){for(var t=this.pages,e=0,i=t.length;i>e;e++)this.textureLoader.unload(t[e].rendererObject)},updateUVs:function(t){for(var e=this.regions,i=0,n=e.length;n>i;i++){var o=e[i];o.page==t&&(o.u=o.x/t.width,o.v=o.y/t.height,o.rotate?(o.u2=(o.x+o.height)/t.width,o.v2=(o.y+o.width)/t.height):(o.u2=(o.x+o.width)/t.width,o.v2=(o.y+o.height)/t.height))}}},s.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},s.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},s.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},s.AtlasPage=function(){},s.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},s.AtlasRegion=function(){},s.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},s.AtlasReader=function(t){this.lines=t.split(/\r\n|\r|\n/)},s.AtlasReader.prototype={index:0,trim:function(t){return t.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw"Invalid line: "+t;return this.trim(t.substring(e+1))},readTuple:function(t){var e=this.readLine(),i=e.indexOf(":");if(-1==i)throw"Invalid line: "+e;for(var n=0,o=i+1;3>n;n++){var r=e.indexOf(",",o);if(-1==r){if(!n)throw"Invalid line: "+e;break}t[n]=this.trim(e.substr(o,r-o)),o=r+1}return t[n]=this.trim(e.substring(o)),n+1}},s.AtlasAttachmentLoader=function(t){this.atlas=t},s.AtlasAttachmentLoader.prototype={newAttachment:function(t,e,i){switch(e){case s.AttachmentType.region:var n=this.atlas.findRegion(i);if(!n)throw"Region not found in atlas: "+i+" ("+e+")";var o=new s.RegionAttachment(i);return o.rendererObject=n,o.setUVs(n.u,n.v,n.u2,n.v2,n.rotate),o.regionOffsetX=n.offsetX,o.regionOffsetY=n.offsetY,o.regionWidth=n.width,o.regionHeight=n.height,o.regionOriginalWidth=n.originalWidth,o.regionOriginalHeight=n.originalHeight,o}throw"Unknown attachment type: "+e}},s.Bone.yDown=!0,e.AnimCache={},e.Spine=function(t){if(e.DisplayObjectContainer.call(this),this.spineData=e.AnimCache[t],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+t);this.skeleton=new s.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new s.AnimationStateData(this.spineData),this.state=new s.AnimationState(this.stateData),this.slotContainers=[];for(var i=0,n=this.skeleton.drawOrder.length;n>i;i++){var o=this.skeleton.drawOrder[i],r=o.attachment,a=new e.DisplayObjectContainer;if(this.slotContainers.push(a),this.addChild(a),r instanceof s.RegionAttachment){var h=r.rendererObject.name,l=this.createSprite(o,r.rendererObject);o.currentSprite=l,o.currentSpriteName=h,a.addChild(l)}}},e.Spine.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Spine.prototype.constructor=e.Spine,e.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.state.update(t),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var i=this.skeleton.drawOrder,n=0,o=i.length;o>n;n++){var r=i[n],a=r.attachment,h=this.slotContainers[n];if(a instanceof s.RegionAttachment){if(a.rendererObject&&(!r.currentSpriteName||r.currentSpriteName!=a.name)){var l=a.rendererObject.name;if(void 0!==r.currentSprite&&(r.currentSprite.visible=!1),r.sprites=r.sprites||{},void 0!==r.sprites[l])r.sprites[l].visible=!0;else{var u=this.createSprite(r,a.rendererObject);h.addChild(u)}r.currentSprite=r.sprites[l],r.currentSpriteName=l}h.visible=!0;var c=r.bone;h.position.x=c.worldX+a.x*c.m00+a.y*c.m01,h.position.y=c.worldY+a.x*c.m10+a.y*c.m11,h.scale.x=c.worldScaleX,h.scale.y=c.worldScaleY,h.rotation=-(r.bone.worldRotation*Math.PI/180)}else h.visible=!1}e.DisplayObjectContainer.prototype.updateTransform.call(this)
},e.Spine.prototype.createSprite=function(t,i){var n=e.TextureCache[i.name]?i.name:i.name+".png",o=new e.Sprite(e.Texture.fromFrame(n));return o.scale=i.scale,o.rotation=i.rotation,o.anchor.x=o.anchor.y=.5,t.sprites=t.sprites||{},t.sprites[i.name]=o,o},e.BaseTextureCache={},e.texturesToUpdate=[],e.texturesToDestroy=[],e.BaseTextureCacheIdGenerator=0,e.BaseTexture=function(t,i){if(e.EventTarget.call(this),this.width=100,this.height=100,this.scaleMode=i||e.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this.id=e.BaseTextureCacheIdGenerator++,this._glTextures=[],t){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,e.texturesToUpdate.push(this);else{var n=this;this.source.onload=function(){n.hasLoaded=!0,n.width=n.source.width,n.height=n.source.height,e.texturesToUpdate.push(n),n.dispatchEvent({type:"loaded",content:n})}}this.imageUrl=null,this._powerOf2=!1}},e.BaseTexture.prototype.constructor=e.BaseTexture,e.BaseTexture.prototype.destroy=function(){this.imageUrl&&(delete e.BaseTextureCache[this.imageUrl],this.imageUrl=null,this.source.src=null),this.source=null,e.texturesToDestroy.push(this)},e.BaseTexture.prototype.updateSourceImage=function(t){this.hasLoaded=!1,this.source.src=null,this.source.src=t},e.BaseTexture.fromImage=function(t,i,n){var o=e.BaseTextureCache[t];if(void 0===i&&-1===t.indexOf("data:")&&(i=!0),!o){var r=new Image;i&&(r.crossOrigin=""),r.src=t,o=new e.BaseTexture(r,n),o.imageUrl=t,e.BaseTextureCache[t]=o}return o},e.BaseTexture.fromCanvas=function(t,i){t._pixiId||(t._pixiId="canvas_"+e.TextureCacheIdGenerator++);var n=e.BaseTextureCache[t._pixiId];return n||(n=new e.BaseTexture(t,i),e.BaseTextureCache[t._pixiId]=n),n},e.TextureCache={},e.FrameCache={},e.TextureCacheIdGenerator=0,e.Texture=function(t,i){if(e.EventTarget.call(this),i||(this.noFrame=!0,i=new e.Rectangle(0,0,1,1)),t instanceof e.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=i,this.trim=null,this.scope=this,this._uvs=null,t.hasLoaded)this.noFrame&&(i=new e.Rectangle(0,0,t.width,t.height)),this.setFrame(i);else{var n=this;t.addEventListener("loaded",function(){n.onBaseTextureLoaded()})}},e.Texture.prototype.constructor=e.Texture,e.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new e.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame),this.scope.dispatchEvent({type:"update",content:this})},e.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy()},e.Texture.prototype.setFrame=function(t){if(this.frame=t,this.width=t.width,this.height=t.height,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0,e.Texture.frameUpdates.push(this)},e.Texture.prototype._updateWebGLuvs=function(){this._uvs||(this._uvs=new e.TextureUvs);var t=this.frame,i=this.baseTexture.width,n=this.baseTexture.height;this._uvs.x0=t.x/i,this._uvs.y0=t.y/n,this._uvs.x1=(t.x+t.width)/i,this._uvs.y1=t.y/n,this._uvs.x2=(t.x+t.width)/i,this._uvs.y2=(t.y+t.height)/n,this._uvs.x3=t.x/i,this._uvs.y3=(t.y+t.height)/n},e.Texture.fromImage=function(t,i,n){var o=e.TextureCache[t];return o||(o=new e.Texture(e.BaseTexture.fromImage(t,i,n)),e.TextureCache[t]=o),o},e.Texture.fromFrame=function(t){var i=e.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return i},e.Texture.fromCanvas=function(t,i){var n=e.BaseTexture.fromCanvas(t,i);return new e.Texture(n)},e.Texture.addTextureToCache=function(t,i){e.TextureCache[i]=t},e.Texture.removeTextureFromCache=function(t){var i=e.TextureCache[t];return delete e.TextureCache[t],delete e.BaseTextureCache[t],i},e.Texture.frameUpdates=[],e.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y4=0},e.RenderTexture=function(t,i,n,o){if(e.EventTarget.call(this),this.width=t||100,this.height=i||100,this.frame=new e.Rectangle(0,0,this.width,this.height),this.baseTexture=new e.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTextures=[],this.baseTexture.scaleMode=o||e.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,this.renderer=n||e.defaultRenderer,this.renderer.type===e.WEBGL_RENDERER){var r=this.renderer.gl;this.textureBuffer=new e.FilterTexture(r,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[r.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new e.Point(this.width/2,-this.height/2)}else this.render=this.renderCanvas,this.textureBuffer=new e.CanvasBuffer(this.width,this.height),this.baseTexture.source=this.textureBuffer.canvas;e.Texture.frameUpdates.push(this)},e.RenderTexture.prototype=Object.create(e.Texture.prototype),e.RenderTexture.prototype.constructor=e.RenderTexture,e.RenderTexture.prototype.resize=function(t,i){if(this.width=t,this.height=i,this.frame.width=this.width,this.frame.height=this.height,this.renderer.type===e.WEBGL_RENDERER){this.projection.x=this.width/2,this.projection.y=-this.height/2;var n=this.renderer.gl;n.bindTexture(n.TEXTURE_2D,this.baseTexture._glTextures[n.id]),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null)}else this.textureBuffer.resize(this.width,this.height);e.Texture.frameUpdates.push(this)},e.RenderTexture.prototype.renderWebGL=function(t,i,n){var o=this.renderer.gl;o.colorMask(!0,!0,!0,!0),o.viewport(0,0,this.width,this.height),o.bindFramebuffer(o.FRAMEBUFFER,this.textureBuffer.frameBuffer),n&&this.textureBuffer.clear();var r=t.children,s=t.worldTransform;t.worldTransform=e.RenderTexture.tempMatrix,t.worldTransform.d=-1,t.worldTransform.ty=-2*this.projection.y,i&&(t.worldTransform.tx=i.x,t.worldTransform.ty-=i.y);for(var a=0,h=r.length;h>a;a++)r[a].updateTransform();e.WebGLRenderer.updateTextures(),this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer),t.worldTransform=s},e.RenderTexture.prototype.renderCanvas=function(t,i,n){var o=t.children,r=t.worldTransform;t.worldTransform=e.RenderTexture.tempMatrix,i&&(t.worldTransform.tx=i.x,t.worldTransform.ty=i.y);for(var s=0,a=o.length;a>s;s++)o[s].updateTransform();n&&this.textureBuffer.clear();var h=this.textureBuffer.context;this.renderer.renderDisplayObject(t,h),h.setTransform(1,0,0,1,0,0),t.worldTransform=r},e.RenderTexture.tempMatrix=new e.Matrix,e.AssetLoader=function(t,i){e.EventTarget.call(this),this.assetURLs=t,this.crossorigin=i,this.loadersByType={jpg:e.ImageLoader,jpeg:e.ImageLoader,png:e.ImageLoader,gif:e.ImageLoader,json:e.JsonLoader,atlas:e.AtlasLoader,anim:e.SpineLoader,xml:e.BitmapFontLoader,fnt:e.BitmapFontLoader}},e.AssetLoader.prototype.constructor=e.AssetLoader,e.AssetLoader.prototype._getDataType=function(t){var e="data:",i=t.slice(0,e.length).toLowerCase();if(i===e){var n=t.slice(e.length),o=n.indexOf(",");if(-1===o)return null;var r=n.slice(0,o).split(";")[0];return r&&"text/plain"!==r.toLowerCase()?r.split("/").pop().toLowerCase():"txt"}return null},e.AssetLoader.prototype.load=function(){function t(t){e.onAssetLoaded(t.content)}var e=this;this.loadCount=this.assetURLs.length;for(var i=0;i<this.assetURLs.length;i++){var n=this.assetURLs[i],o=this._getDataType(n);o||(o=n.split("?").shift().split(".").pop().toLowerCase());var r=this.loadersByType[o];if(!r)throw new Error(o+" is an unsupported file type");var s=new r(n,this.crossorigin);s.addEventListener("loaded",t),s.load()}},e.AssetLoader.prototype.onAssetLoaded=function(t){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this,loader:t}),this.onProgress&&this.onProgress(t),this.loadCount||(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},e.JsonLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.loaded=!1},e.JsonLoader.prototype.constructor=e.JsonLoader,e.JsonLoader.prototype.load=function(){var t=this;window.XDomainRequest?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=function(){t.onError()},this.ajaxRequest.ontimeout=function(){t.onError()},this.ajaxRequest.onprogress=function(){}):this.ajaxRequest=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onload=function(){t.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.send()},e.JsonLoader.prototype.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return void this.onError();if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var t=this,i=this.baseUrl+this.json.meta.image,n=new e.ImageLoader(i,this.crossorigin),o=this.json.frames;this.texture=n.texture.baseTexture,n.addEventListener("loaded",function(){t.onLoaded()});for(var r in o){var a=o[r].frame;if(a&&(e.TextureCache[r]=new e.Texture(this.texture,{x:a.x,y:a.y,width:a.w,height:a.h}),o[r].trimmed)){var h=e.TextureCache[r],l=o[r].sourceSize,u=o[r].spriteSourceSize;h.trim=new e.Rectangle(u.x,u.y,l.w,l.h)}}n.load()}else if(this.json.bones){var c=new s.SkeletonJson,d=c.readSkeletonData(this.json);e.AnimCache[this.url]=d,this.onLoaded()}else this.onLoaded()},e.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.AtlasLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.crossorigin=i,this.loaded=!1},e.AtlasLoader.constructor=e.AtlasLoader,e.AtlasLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},e.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};var t=this.ajaxRequest.responseText.split(/\r?\n/),i=-3,n=0,o=null,r=!1,s=0,a=0,h=this.onLoaded.bind(this);for(s=0;s<t.length;s++)if(t[s]=t[s].replace(/^\s+|\s+$/g,""),""===t[s]&&(r=s+1),t[s].length>0){if(r===s)this.atlas.meta.image.push(t[s]),n=this.atlas.meta.image.length-1,this.atlas.frames.push({}),i=-3;else if(i>0)if(i%7===1)null!=o&&(this.atlas.frames[n][o.name]=o),o={name:t[s],frame:{}};else{var l=t[s].split(" ");if(i%7===3)o.frame.x=Number(l[1].replace(",","")),o.frame.y=Number(l[2]);else if(i%7===4)o.frame.w=Number(l[1].replace(",","")),o.frame.h=Number(l[2]);else if(i%7===5){var u={x:0,y:0,w:Number(l[1].replace(",","")),h:Number(l[2])};u.w>o.frame.w||u.h>o.frame.h?(o.trimmed=!0,o.realSize=u):o.trimmed=!1}}i++}if(null!=o&&(this.atlas.frames[n][o.name]=o),this.atlas.meta.image.length>0){for(this.images=[],a=0;a<this.atlas.meta.image.length;a++){var c=this.baseUrl+this.atlas.meta.image[a],d=this.atlas.frames[a];this.images.push(new e.ImageLoader(c,this.crossorigin));for(s in d){var p=d[s].frame;p&&(e.TextureCache[s]=new e.Texture(this.images[a].texture.baseTexture,{x:p.x,y:p.y,width:p.w,height:p.h}),d[s].trimmed&&(e.TextureCache[s].realSize=d[s].realSize,e.TextureCache[s].trim.x=0,e.TextureCache[s].trim.y=0))}}for(this.currentImageId=0,a=0;a<this.images.length;a++)this.images[a].addEventListener("loaded",h);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},e.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.dispatchEvent({type:"loaded",content:this}))},e.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.SpriteSheetLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},e.SpriteSheetLoader.prototype.constructor=e.SpriteSheetLoader,e.SpriteSheetLoader.prototype.load=function(){var t=this,i=new e.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(e){t.json=e.content.json,t.onLoaded()}),i.load()},e.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader=function(t,i){e.EventTarget.call(this),this.texture=e.Texture.fromImage(t,i),this.frames=[]},e.ImageLoader.prototype.constructor=e.ImageLoader,e.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var t=this;this.texture.baseTexture.addEventListener("loaded",function(){t.onLoaded()})}},e.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader.prototype.loadFramedSpriteSheet=function(t,i,n){this.frames=[];for(var o=Math.floor(this.texture.width/t),r=Math.floor(this.texture.height/i),s=0,a=0;r>a;a++)for(var h=0;o>h;h++,s++){var l=new e.Texture(this.texture,{x:h*t,y:a*i,width:t,height:i});this.frames.push(l),n&&(e.TextureCache[n+"-"+s]=l)}if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var u=this;this.texture.baseTexture.addEventListener("loaded",function(){u.onLoaded()})}},e.BitmapFontLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null},e.BitmapFontLoader.prototype.constructor=e.BitmapFontLoader,e.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onXMLLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},e.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var t=this.ajaxRequest.responseXML;if(!t||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){var i=new DOMParser;t=i.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var n=document.createElement("div");n.innerHTML=this.ajaxRequest.responseText,t=n}var o=this.baseUrl+t.getElementsByTagName("page")[0].getAttribute("file"),r=new e.ImageLoader(o,this.crossorigin);this.texture=r.texture.baseTexture;var s={},a=t.getElementsByTagName("info")[0],h=t.getElementsByTagName("common")[0];s.font=a.getAttribute("face"),s.size=parseInt(a.getAttribute("size"),10),s.lineHeight=parseInt(h.getAttribute("lineHeight"),10),s.chars={};for(var l=t.getElementsByTagName("char"),u=0;u<l.length;u++){var c=parseInt(l[u].getAttribute("id"),10),d=new e.Rectangle(parseInt(l[u].getAttribute("x"),10),parseInt(l[u].getAttribute("y"),10),parseInt(l[u].getAttribute("width"),10),parseInt(l[u].getAttribute("height"),10));s.chars[c]={xOffset:parseInt(l[u].getAttribute("xoffset"),10),yOffset:parseInt(l[u].getAttribute("yoffset"),10),xAdvance:parseInt(l[u].getAttribute("xadvance"),10),kerning:{},texture:e.TextureCache[c]=new e.Texture(this.texture,d)}}var p=t.getElementsByTagName("kerning");for(u=0;u<p.length;u++){var f=parseInt(p[u].getAttribute("first"),10),g=parseInt(p[u].getAttribute("second"),10),m=parseInt(p[u].getAttribute("amount"),10);s.chars[g].kerning[f]=m}e.BitmapText.fonts[s.font]=s;var y=this;r.addEventListener("loaded",function(){y.onLoaded()}),r.load()}},e.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.SpineLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.loaded=!1},e.SpineLoader.prototype.constructor=e.SpineLoader,e.SpineLoader.prototype.load=function(){var t=this,i=new e.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(e){t.json=e.content.json,t.onLoaded()}),i.load()},e.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.AbstractFilter=function(t,e){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=e||{},this.fragmentSrc=t||[]},e.AlphaMaskFilter=function(t){e.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={mask:{type:"sampler2D",value:t},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mask.value.x=t.width,this.uniforms.mask.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]},e.AlphaMaskFilter.prototype=Object.create(e.AbstractFilter.prototype),e.AlphaMaskFilter.prototype.constructor=e.AlphaMaskFilter,e.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height,this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}}),e.ColorMatrixFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]},e.ColorMatrixFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorMatrixFilter.prototype.constructor=e.ColorMatrixFilter,Object.defineProperty(e.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(t){this.uniforms.matrix.value=t}}),e.GrayFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={gray:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]},e.GrayFilter.prototype=Object.create(e.AbstractFilter.prototype),e.GrayFilter.prototype.constructor=e.GrayFilter,Object.defineProperty(e.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(t){this.uniforms.gray.value=t}}),e.DisplacementFilter=function(t){e.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:t},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=t.width,this.uniforms.mapDimensions.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]},e.DisplacementFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DisplacementFilter.prototype.constructor=e.DisplacementFilter,e.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(t){this.uniforms.displacementMap.value=t}}),Object.defineProperty(e.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(t){this.uniforms.scale.value=t}}),Object.defineProperty(e.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}),e.PixelateFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]},e.PixelateFilter.prototype=Object.create(e.AbstractFilter.prototype),e.PixelateFilter.prototype.constructor=e.PixelateFilter,Object.defineProperty(e.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.dirty=!0,this.uniforms.pixelSize.value=t}}),e.BlurXFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurXFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurXFilter.prototype.constructor=e.BlurXFilter,Object.defineProperty(e.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.dirty=!0,this.uniforms.blur.value=1/7e3*t}}),e.BlurYFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurYFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurYFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),e.BlurFilter=function(){this.blurXFilter=new e.BlurXFilter,this.blurYFilter=new e.BlurYFilter,this.passes=[this.blurXFilter,this.blurYFilter]},Object.defineProperty(e.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t}}),Object.defineProperty(e.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}}),Object.defineProperty(e.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}),e.InvertFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]},e.InvertFilter.prototype=Object.create(e.AbstractFilter.prototype),e.InvertFilter.prototype.constructor=e.InvertFilter,Object.defineProperty(e.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(t){this.uniforms.invert.value=t}}),e.SepiaFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={sepia:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]},e.SepiaFilter.prototype=Object.create(e.AbstractFilter.prototype),e.SepiaFilter.prototype.constructor=e.SepiaFilter,Object.defineProperty(e.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(t){this.uniforms.sepia.value=t}}),e.TwistFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]},e.TwistFilter.prototype=Object.create(e.AbstractFilter.prototype),e.TwistFilter.prototype.constructor=e.TwistFilter,Object.defineProperty(e.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(t){this.dirty=!0,this.uniforms.offset.value=t}}),Object.defineProperty(e.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(t){this.dirty=!0,this.uniforms.radius.value=t}}),Object.defineProperty(e.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(t){this.dirty=!0,this.uniforms.angle.value=t}}),e.ColorStepFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={step:{type:"1f",value:5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]},e.ColorStepFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorStepFilter.prototype.constructor=e.ColorStepFilter,Object.defineProperty(e.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(t){this.uniforms.step.value=t}}),e.DotScreenFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]},e.DotScreenFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DotScreenFilter.prototype.constructor=e.DotScreenFilter,Object.defineProperty(e.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(t){this.dirty=!0,this.uniforms.scale.value=t}}),Object.defineProperty(e.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(t){this.dirty=!0,this.uniforms.angle.value=t}}),e.CrossHatchFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]
},e.CrossHatchFilter.prototype=Object.create(e.AbstractFilter.prototype),e.CrossHatchFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),e.RGBSplitFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]},e.RGBSplitFilter.prototype=Object.create(e.AbstractFilter.prototype),e.RGBSplitFilter.prototype.constructor=e.RGBSplitFilter,Object.defineProperty(e.RGBSplitFilter.prototype,"angle",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.PIXI=e):"undefined"!=typeof define&&define.amd?define("pixi",e):t.PIXI=e}.call(this),define("absolute/debug",[],function(){var t={enabled:!1,log:function(t){this.enabled&&console.log(t)}};return t}),define("absolute/platform",["pixi","absolute/debug"],function(t,e){var i={artPathPrefix:"art",soundPathPrefix:"sound",maxWidth:window.innerWidth,maxHeight:window.innerHeight,devicePixelRatio:window.devicePixelRatio||1,documentRoot:null,getDocumentRoot:function(){if(null===this.documentRoot)if(this.isCordova()){var t=window.location.href.indexOf("/index.html");this.documentRoot=window.location.href.substring(0,t)+"/"}else this.documentRoot="";return this.documentRoot},getClickAction:function(){return this.supportsTouch()?"touchstart":"click"},isCrapAudio:function(){return navigator.userAgent.indexOf("Android")>=0?!0:navigator.userAgent.indexOf("Silk")>=0?!0:navigator.userAgent.match(/OS 5(_\d)+ like Mac OS X/i)?!0:navigator.userAgent.match(/OS 4(_\d)+ like Mac OS X/i)?!0:!1},_isiPhone:navigator.userAgent.match(/iPhone/i),_isiPod:navigator.userAgent.match(/iPod/i),_isiPad:navigator.userAgent.match(/iPad/i),_isAndroid:function(){return"android"===this.getMobileUserAgentData().os.toLowerCase()},_isChrome:function(){return navigator.userAgent.indexOf("Android")>=0&&navigator.userAgent.indexOf("CrMo")>=0},_isIE:function(){return navigator.userAgent.indexOf("Trident")>=0||navigator.userAgent.indexOf("MSIE")>=0},_isFirefox:function(){return navigator.userAgent.indexOf("Firefox")>=0},_isWindows:function(){return navigator.userAgent.indexOf("Windows NT")>=0},supportsWebGL:function(){return!(this._isIE()||this._isWindows()&&this._isFirefox())},supportsTouch:function(){try{return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}catch(t){return!1}},isCordova:function(){return"undefined"!=typeof cordova},isPhone:function(){var t=navigator.userAgent,e=/iPhone|BlackBerry|IEMobile|Opera Mini/i,i=t.match(e);return"undefined"!=typeof i&&null!==i?i.length>0:!1},supportsLayeredDivs:function(){var t=this.getMobileUserAgentData();return!("Android"===t.os&&!/^[3-9](\.[0-9])*$/.test(t.osVersion))},supportsFixedPosition:function(){var t=this.getMobileUserAgentData();return"Android"===t.os&&/^[3-9](\.[0-9])*$/.test(t.osVersion)||"iPhone"===t.os&&/^[5-9]/.test(t.osVersion)||"iPhone"!==t.os&&"Android"!==t.os},supportsDeviceOrientation:function(){return"undefined"!=typeof window.DeviceOrientationEvent},getMobileUserAgentData:function(){for(var t=navigator.userAgent,e={os:"",osVersion:"",browser:"",browserVersion:""},i=[{os:"iPhone",osVersionRegex:/(?:iPhone OS )([0-9,_]*)(?: like)/,browser:"WebKit",browserVersionRegex:/(?:AppleWebKit\/)([0-9,.]*)/},{os:"Android",osVersionRegex:/(?:Android )([0-9,.]*)/,browser:"WebKit",browserVersionRegex:/(?:AppleWebKit\/)([0-9,.]*)/},{os:"Linux",osVersionRegex:/(?:Android )([0-9,.]*)/,browser:"Silk",browserVersionRegex:/(?:Silk\/)([0-9._-]+)/}],n=0,o=i.length;o>n;n++){var r=i[n];if(-1!==t.indexOf(r.os)){e.os=r.os,"undefined"!=typeof r.osVersionRegex&&(e.osVersion=t.match(r.osVersionRegex)||"0.0",e.osVersion=e.osVersion[1].replace("_",".")),-1!==t.indexOf(r.browser)&&(e.browser=r.browser,"undefined"!=typeof r.browserVersionRegex&&(e.browserVersion=t.match(r.browserVersionRegex)[1].replace("_",".")));break}}return e},isSilk:function(){return/\bSilk\b/.test(navigator.userAgent)?!0:!1},_isOldAndroid:function(){var t=4,e=2,i=this.getMobileUserAgentData(),n=i.osVersion.split("."),o=0,r=0,s=!1;return("android"===i.os.toLowerCase()||"linux"===i.os.toLowerCase())&&n.length>1&&(o=n[0],r=n[1],(t>o||o==t&&e>=r)&&(s=!0)),s},getResStepsDown:function(i,n){var o=0;return t.canUseNewCanvasBlendModes()?n&&this.isPhone()?(e.log("Lowering resClass because this is a phone."),o++):n&&this._isiPad&&i>=3&&(e.log("Lowering resClass because this is an ipad device that can't handle big textures."),o++):(e.log("Lowering resClass because this device does not support canvas blends."),o++),this._isOldAndroid()&&(e.log("Lowering resClass because this is an older android device."),o++),this._isOldAndroid()&&i>=3&&(e.log("Lowering resClass because this is an older android device and it is enormous."),o++),n&&i>=3&&this._isAndroid()&&(e.log("Lowering resClass because this is a hires android device and probably lacks memory."),o=2),n&&0==o&&(o=1),o}};return i}),define("absoluteaudio/audio",["absoluteaudio/webaudioclip","absoluteaudio/streamedwebaudioclip","absoluteaudio/html5audioelementclip","absoluteaudio/audiosprite","absoluteaudio/cordovaclip","absoluteaudio/soundmanagerclip","absoluteaudio/debug","absolute/platform"],function(t,e,i,n,o,r,s,a){"use strict";var h=null;"undefined"!=typeof AudioContext?h=new AudioContext:"undefined"!=typeof webkitAudioContext?h=new webkitAudioContext:"undefined"!=typeof mozAudioContext&&(h=new mozAudioContext),s.enabled&&(h=null);var l={createAudioClip:function(n,s,a,l){return null!==h?a?new e(n,s,h):new t(n,s,h):"undefined"!=typeof soundManager&&(navigator.userAgent.indexOf("Trident")>=0||navigator.userAgent.indexOf("MSIE")>=0)?new r(n,s):"undefined"!=typeof Media?new o(n,s):new i(n,s,l)},createAudioSprite:function(t,e,i){return new n(t,e,i)},usingWebAudio:function(){return null!==h},usingCordovaAudio:function(){return"undefined"!=typeof Media},usingSoundManagerAudio:function(){return"undefined"!=typeof soundManager&&a._isIE()}};return l}),define("absoluteaudio",["require","absoluteaudio/audio"],function(t){"use strict";return{version:"1.0",context:t("absoluteaudio/audio")}}),define("absolute/storagemanager",["absolute/debug"],function(t){var e={prefix:null,store:function(e,i){if(!this.prefix)throw"Error: you must set StorageManager.prefix for this game!";try{localStorage[this.prefix+e]=JSON.stringify(i)}catch(n){t.log("error creating local storage "+n)}},fetch:function(e){if(!this.prefix)throw"Error: you must set StorageManager.prefix for this game!";try{var i=localStorage[this.prefix+e];if(i)return JSON.parse(i)}catch(n){t.log("error accessing local storage "+n)}return null}};return e}),define("absolute/gameconfig",["absolute/storagemanager"],function(t){var e={defaults:{},options:{},reset:function(){this.options=this.defaults,this.save()},load:function(e){if(this.defaults=e,this.options=t.fetch("options")||this.defaults,!this.options.version||this.options.version<this.defaults.version)for(var i in this.defaults)this.defaults.hasOwnProperty(i)&&!this.options.hasOwnProperty(i)&&(this.options[i]=this.defaults[i])},save:function(){t.store("options",this.options)},setVal:function(t,e){this.options[t]=e,this.save()},getVal:function(t){return this.options[t]}};return e}),define("absolute/audiomanager",["absoluteaudio","absolute/debug","absolute/gameconfig","absolute/platform"],function(t,e,i,n){var o={lastPlayed:0,music:null,sounds:{},format:"mp3",sfxEnabled:!0,init:function(t){audioTest=new Audio;var i={m4a:!!(audioTest.canPlayType("audio/x-m4a;")||audioTest.canPlayType("audio/aac;")).replace(/^no$/,""),ogg:!!audioTest.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),mp3:!!audioTest.canPlayType("audio/mpeg;").replace(/^no$/,"")};i.m4a?this.format="m4a":i.ogg?this.format="ogg":i.mp3&&(this.format="mp3"),n._isIE()&&(this.format="mp3"),e.log("Audio format "+this.format),t&&"function"==typeof t&&t()},setFormat:function(t){this.format=t},loadSounds:function(e,n,o){return e?(this.audioAssets=e,void(this.usingWebAudio()?this.loadClips(e,n,o):this.createSound({id:"as",url:"as/as",volume:100,onLoad:function(){for(var e=0,r=this.audioAssets.length;r>e;e+=1){var s=this.audioAssets[e],a=this.sounds.as;this.sounds[s.id]=t.context.createAudioSprite(a,s.start,s.end),n(e/r)}n(e/r),this.setSfxEnabled(i.getVal("sfxEnabled")),setTimeout(function(){o()},500)}.bind(this),buffer:!1,loop:!1,duration:0}))):void o()},loadClips:function(t,e,n){for(var o=this,r=t.length,s=0,a=function(){++s===r?(o.setSfxEnabled(i.getVal("sfxEnabled")),e(s/r),n()):e(s/r)},h=0;h<t.length;h+=1){var l=t[h];this.createSound({id:l.id,url:l.url,volume:l.volume,onLoad:a,buffer:!1,loop:l.loop,duration:l.end-l.start})}},createSound:function(e){var i,o;o=n.getDocumentRoot()+n.soundPathPrefix+"/"+this.format+"/"+e.url+"."+this.format,i=t.context.createAudioClip(o,e.onLoad,!1,e.duration),this.sounds[e.id]=i},playSound:function(t,e,i){this.sounds[t]&&this.sounds[t].play(i/1e3,this.isMusic(t),e)},loopSound:function(t,e,i){this.sounds[t]&&this.sounds[t].play(i/1e3,!0,e)},stopSound:function(t){this.sounds[t]&&(this.sounds[t].stopping=!0,this.sounds[t].stop())},pauseSound:function(t){this.sounds[t]&&this.sounds[t].pause()},muteSound:function(t){this.sounds[t]&&this.sounds[t].mute()},unmuteSound:function(t){this.sounds[t]&&this.sounds[t].unmute()},setSfxEnabled:function(t){this.sfxEnabled=t,i.setVal("sfxEnabled",t);var e;if(t)for(e in this.sounds)this.isMusic(e)||"as"===e||this.unmuteSound(e);else for(e in this.sounds)this.isMusic(e)||"as"===e||this.muteSound(e)},isSfxEnabled:function(){return this.sfxEnabled},muteAll:function(){for(s in this.sounds)this.muteSound(s)},unmuteAll:function(){for(s in this.sounds)this.unmuteSound(s)},unmuteAllSfx:function(){for(s in this.sounds)this.isMusic(s)||this.unmuteSound(s)},usingWebAudio:function(){try{return t.context.usingWebAudio()||t.context.usingCordovaAudio()||t.context.usingSoundManagerAudio()}catch(e){return!1}},isMusic:function(t){return-1!==t.indexOf("music")},sfxSupported:function(){return!0},musicSupported:function(){return!0},simulSoundSupport:function(){try{return t.context.usingWebAudio()||t.context.usingCordovaAudio()||t.context.usingSoundManagerAudio()||!i.getVal("musicEnabled")}catch(e){return!1}},primeClips:function(){var t;for(t in this.sounds)this.sounds[t].prime()}};return o}),define("lodash/arrays/compact",[],function(){function t(t){for(var e=-1,i=t?t.length:0,n=[];++e<i;){var o=t[e];o&&n.push(o)}return n}return t}),define("lodash/internals/baseIndexOf",[],function(){function t(t,e,i){for(var n=(i||0)-1,o=t?t.length:0;++n<o;)if(t[n]===e)return n;return-1}return t}),define("lodash/internals/keyPrefix",[],function(){var t=+new Date+"";return t}),define("lodash/internals/cacheIndexOf",["./baseIndexOf","./keyPrefix"],function(t,e){function i(i,n){var o=typeof n;if(i=i.cache,"boolean"==o||null==n)return i[n]?0:-1;"number"!=o&&"string"!=o&&(o="object");var r="number"==o?n:e+n;return i=(i=i[o])&&i[r],"object"==o?i&&t(i,n)>-1?0:-1:i?0:-1}return i}),define("lodash/internals/cachePush",["./keyPrefix"],function(t){function e(e){var i=this.cache,n=typeof e;if("boolean"==n||null==e)i[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var o="number"==n?e:t+e,r=i[n]||(i[n]={});"object"==n?(r[o]||(r[o]=[])).push(e):r[o]=!0}}return e}),define("lodash/internals/objectPool",[],function(){var t=[];return t}),define("lodash/internals/getObject",["./objectPool"],function(t){function e(){return t.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}return e}),define("lodash/internals/maxPoolSize",[],function(){var t=40;return t}),define("lodash/internals/releaseObject",["./maxPoolSize","./objectPool"],function(t,e){function i(n){var o=n.cache;o&&i(o),n.array=n.cache=n.criteria=n.object=n.number=n.string=n.value=null,e.length<t&&e.push(n)}return i}),define("lodash/internals/createCache",["./cachePush","./getObject","./releaseObject"],function(t,e){function i(i){var n=-1,o=i.length,r=i[0],s=i[o/2|0],a=i[o-1];if(r&&"object"==typeof r&&s&&"object"==typeof s&&a&&"object"==typeof a)return!1;var h=e();h["false"]=h["null"]=h["true"]=h.undefined=!1;var l=e();for(l.array=i,l.cache=h,l.push=t;++n<o;)l.push(i[n]);return l}return i}),define("lodash/internals/largeArraySize",[],function(){var t=75;return t}),define("lodash/internals/baseDifference",["./baseIndexOf","./cacheIndexOf","./createCache","./largeArraySize","./releaseObject"],function(t,e,i,n,o){function r(r,s){var a=-1,h=t,l=r?r.length:0,u=l>=n,c=[];if(u){var d=i(s);d?(h=e,s=d):u=!1}for(;++a<l;){var p=r[a];h(s,p)<0&&c.push(p)}return u&&o(s),c}return r}),define("lodash/objects/isArguments",[],function(){function t(t){return t&&"object"==typeof t&&"number"==typeof t.length&&n.call(t)==e||!1}var e="[object Arguments]",i=Object.prototype,n=i.toString;return t}),define("lodash/internals/isNative",[],function(){function t(t){return"function"==typeof t&&n.test(t)}var e=Object.prototype,i=e.toString,n=RegExp("^"+String(i).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");return t}),define("lodash/objects/isArray",["../internals/isNative"],function(t){var e="[object Array]",i=Object.prototype,n=i.toString,o=t(o=Array.isArray)&&o,r=o||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&n.call(t)==e||!1};return r}),define("lodash/internals/baseFlatten",["../objects/isArguments","../objects/isArray"],function(t,e){function i(n,o,r,s){for(var a=(s||0)-1,h=n?n.length:0,l=[];++a<h;){var u=n[a];if(u&&"object"==typeof u&&"number"==typeof u.length&&(e(u)||t(u))){o||(u=i(u,o,r));var c=-1,d=u.length,p=l.length;for(l.length+=d;++c<d;)l[p++]=u[c]}else r||l.push(u)}return l}return i}),define("lodash/arrays/difference",["../internals/baseDifference","../internals/baseFlatten"],function(t,e){function i(i){return t(i,e(arguments,!0,!0,1))}return i}),define("lodash/internals/objectTypes",[],function(){var t={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};return t}),define("lodash/objects/isObject",["../internals/objectTypes"],function(t){function e(e){return!(!e||!t[typeof e])}return e}),define("lodash/utilities/noop",[],function(){function t(){}return t}),define("lodash/internals/baseCreate",["./isNative","../objects/isObject","../utilities/noop"],function(t,e){function i(t){return e(t)?n(t):{}}var n=t(n=Object.create)&&n;return n||(i=function(){function t(){}return function(i){if(e(i)){t.prototype=i;var n=new t;t.prototype=null}return n||window.Object()}}()),i}),define("lodash/internals/setBindData",["./isNative","../utilities/noop"],function(t,e){var i={configurable:!1,enumerable:!1,value:null,writable:!1},n=function(){try{var e={},i=t(i=Object.defineProperty)&&i,n=i(e,e,e)&&i}catch(o){}return n}(),o=n?function(t,e){i.value=e,n(t,"__bindData__",i)}:e;return o}),define("lodash/internals/slice",[],function(){function t(t,e,i){e||(e=0),"undefined"==typeof i&&(i=t?t.length:0);for(var n=-1,o=i-e||0,r=Array(0>o?0:o);++n<o;)r[n]=t[e+n];return r}return t}),define("lodash/internals/baseBind",["./baseCreate","../objects/isObject","./setBindData","./slice"],function(t,e,i,n){function o(o){function r(){if(h){var i=n(h);s.apply(i,arguments)}if(this instanceof r){var o=t(a.prototype),u=a.apply(o,i||arguments);return e(u)?u:o}return a.apply(l,i||arguments)}var a=o[0],h=o[2],l=o[4];return i(r,o),r}var r=[],s=r.push;return o}),define("lodash/internals/baseCreateWrapper",["./baseCreate","../objects/isObject","./setBindData","./slice"],function(t,e,i,n){function o(r){function a(){var i=f?d:this;if(u){var r=n(u);s.apply(r,arguments)}if((c||m)&&(r||(r=n(arguments)),c&&s.apply(r,c),m&&r.length<p))return l|=16,o([h,y?l:-4&l,r,null,d,p]);if(r||(r=arguments),g&&(h=i[b]),this instanceof a){i=t(h.prototype);var v=h.apply(i,r);return e(v)?v:i}return h.apply(i,r)}var h=r[0],l=r[1],u=r[2],c=r[3],d=r[4],p=r[5],f=1&l,g=2&l,m=4&l,y=8&l,b=h;return i(a,r),a}var r=[],s=r.push;return o}),define("lodash/objects/isFunction",[],function(){function t(t){return"function"==typeof t}return t}),define("lodash/internals/createWrapper",["./baseBind","./baseCreateWrapper","../objects/isFunction","./slice"],function(t,e,i,n){function o(r,h,l,u,c,d){var p=1&h,f=2&h,g=4&h,m=16&h,y=32&h;if(!f&&!i(r))throw new TypeError;m&&!l.length&&(h&=-17,m=l=!1),y&&!u.length&&(h&=-33,y=u=!1);var b=r&&r.__bindData__;if(b&&b!==!0)return b=n(b),b[2]&&(b[2]=n(b[2])),b[3]&&(b[3]=n(b[3])),!p||1&b[1]||(b[4]=c),!p&&1&b[1]&&(h|=8),!g||4&b[1]||(b[5]=d),m&&s.apply(b[2]||(b[2]=[]),l),y&&a.apply(b[3]||(b[3]=[]),u),b[1]|=h,o.apply(null,b);var v=1==h||17===h?t:e;return v([r,h,l,u,c,d])}var r=[],s=r.push,a=r.unshift;return o}),define("lodash/functions/bind",["../internals/createWrapper","../internals/slice"],function(t,e){function i(i,n){return arguments.length>2?t(i,17,e(arguments,2),null,n):t(i,1,null,null,n)}return i}),define("lodash/utilities/identity",[],function(){function t(t){return t}return t}),define("lodash/support",["./internals/isNative"],function(t){var e=/\bthis\b/,i={};return i.funcDecomp=!t(window.WinRTError)&&e.test(function(){return this}),i.funcNames="string"==typeof Function.name,i}),define("lodash/internals/baseCreateCallback",["../functions/bind","../utilities/identity","./setBindData","../support"],function(t,e,i,n){function o(o,h,l){if("function"!=typeof o)return e;if("undefined"==typeof h||!("prototype"in o))return o;var u=o.__bindData__;if("undefined"==typeof u&&(n.funcNames&&(u=!o.name),u=u||!n.funcDecomp,!u)){var c=a.call(o);n.funcNames||(u=!r.test(c)),u||(u=s.test(c),i(o,u))}if(u===!1||u!==!0&&1&u[1])return o;switch(l){case 1:return function(t){return o.call(h,t)};case 2:return function(t,e){return o.call(h,t,e)};case 3:return function(t,e,i){return o.call(h,t,e,i)};case 4:return function(t,e,i,n){return o.call(h,t,e,i,n)}}return t(o,h)}var r=/^\s*function[ \n\r\t]+\w/,s=/\bthis\b/,a=Function.prototype.toString;return o}),define("lodash/objects/forIn",["../internals/baseCreateCallback","../internals/objectTypes"],function(t,e){var i=function(i,n,o){var r,s=i,a=s;if(!s)return a;if(!e[typeof s])return a;n=n&&"undefined"==typeof o?n:t(n,o,3);for(r in s)if(n(s[r],r,i)===!1)return a;return a};return i}),define("lodash/internals/arrayPool",[],function(){var t=[];return t}),define("lodash/internals/getArray",["./arrayPool"],function(t){function e(){return t.pop()||[]}return e}),define("lodash/internals/releaseArray",["./arrayPool","./maxPoolSize"],function(t,e){function i(i){i.length=0,t.length<e&&t.push(i)}return i}),define("lodash/internals/baseIsEqual",["../objects/forIn","./getArray","../objects/isFunction","./objectTypes","./releaseArray"],function(t,e,i,n,o){function r(f,y,b,v,x,w){if(b){var C=b(f,y);if("undefined"!=typeof C)return!!C}if(f===y)return 0!==f||1/f==1/y;var S=typeof f,T=typeof y;if(!(f!==f||f&&n[S]||y&&n[T]))return!1;if(null==f||null==y)return f===y;var _=g.call(f),A=g.call(y);if(_==s&&(_=c),A==s&&(A=c),_!=A)return!1;switch(_){case h:case l:return+f==+y;case u:return f!=+f?y!=+y:0==f?1/f==1/y:f==+y;case d:case p:return f==String(y)}var k=_==a;if(!k){var M=m.call(f,"__wrapped__"),B=m.call(y,"__wrapped__");if(M||B)return r(M?f.__wrapped__:f,B?y.__wrapped__:y,b,v,x,w);if(_!=c)return!1;var L=f.constructor,R=y.constructor;if(L!=R&&!(i(L)&&L instanceof L&&i(R)&&R instanceof R)&&"constructor"in f&&"constructor"in y)return!1}var E=!x;x||(x=e()),w||(w=e());for(var P=x.length;P--;)if(x[P]==f)return w[P]==y;var D=0;if(C=!0,x.push(f),w.push(y),k){if(P=f.length,D=y.length,C=D==P,C||v)for(;D--;){var O=P,F=y[D];if(v)for(;O--&&!(C=r(f[O],F,b,v,x,w)););else if(!(C=r(f[D],F,b,v,x,w)))break}}else t(y,function(t,e,i){return m.call(i,e)?(D++,C=m.call(f,e)&&r(f[e],t,b,v,x,w)):void 0}),C&&!v&&t(f,function(t,e,i){return m.call(i,e)?C=--D>-1:void 0});return x.pop(),w.pop(),E&&(o(x),o(w)),C}var s="[object Arguments]",a="[object Array]",h="[object Boolean]",l="[object Date]",u="[object Number]",c="[object Object]",d="[object RegExp]",p="[object String]",f=Object.prototype,g=f.toString,m=f.hasOwnProperty;return r}),define("lodash/internals/shimKeys",["./objectTypes"],function(t){var e=Object.prototype,i=e.hasOwnProperty,n=function(e){var n,o=e,r=[];if(!o)return r;if(!t[typeof e])return r;for(n in o)i.call(o,n)&&r.push(n);return r};return n}),define("lodash/objects/keys",["../internals/isNative","./isObject","../internals/shimKeys"],function(t,e,i){var n=t(n=Object.keys)&&n,o=n?function(t){return e(t)?n(t):[]}:i;return o}),define("lodash/utilities/property",[],function(){function t(t){return function(e){return e[t]}}return t}),define("lodash/functions/createCallback",["../internals/baseCreateCallback","../internals/baseIsEqual","../objects/isObject","../objects/keys","../utilities/property"],function(t,e,i,n,o){function r(r,s,a){var h=typeof r;if(null==r||"function"==h)return t(r,s,a);if("object"!=h)return o(r);var l=n(r),u=l[0],c=r[u];return 1!=l.length||c!==c||i(c)?function(t){for(var i=l.length,n=!1;i--&&(n=e(t[l[i]],r[l[i]],null,!0)););return n}:function(t){var e=t[u];return c===e&&(0!==c||1/c==1/e)}}return r}),define("lodash/arrays/findIndex",["../functions/createCallback"],function(t){function e(e,i,n){var o=-1,r=e?e.length:0;for(i=t(i,n,3);++o<r;)if(i(e[o],o,e))return o;return-1}return e}),define("lodash/arrays/findLastIndex",["../functions/createCallback"],function(t){function e(e,i,n){var o=e?e.length:0;for(i=t(i,n,3);o--;)if(i(e[o],o,e))return o;return-1}return e}),define("lodash/arrays/first",["../functions/createCallback","../internals/slice"],function(t,e){function i(i,s,a){var h=0,l=i?i.length:0;if("number"!=typeof s&&null!=s){var u=-1;for(s=t(s,a,3);++u<l&&s(i[u],u,i);)h++}else if(h=s,null==h||a)return i?i[0]:n;return e(i,0,r(o(0,h),l))}var n,o=Math.max,r=Math.min;return i}),define("lodash/objects/forOwn",["../internals/baseCreateCallback","./keys","../internals/objectTypes"],function(t,e,i){var n=function(n,o,r){var s,a=n,h=a;if(!a)return h;if(!i[typeof a])return h;o=o&&"undefined"==typeof r?o:t(o,r,3);for(var l=-1,u=i[typeof a]&&e(a),c=u?u.length:0;++l<c;)if(s=u[l],o(a[s],s,n)===!1)return h;return h};return n}),define("lodash/collections/map",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o){var r=-1,s=i?i.length:0;if(n=t(n,o,3),"number"==typeof s)for(var a=Array(s);++r<s;)a[r]=n(i[r],r,i);else a=[],e(i,function(t,e,i){a[++r]=n(t,e,i)});return a}return i}),define("lodash/arrays/flatten",["../internals/baseFlatten","../collections/map"],function(t,e){function i(i,n,o,r){return"boolean"!=typeof n&&null!=n&&(r=o,o="function"!=typeof n&&r&&r[n]===i?null:n,n=!1),null!=o&&(i=e(i,o,r)),t(i,n)}return i}),define("lodash/arrays/sortedIndex",["../functions/createCallback","../utilities/identity"],function(t,e){function i(i,n,o,r){var s=0,a=i?i.length:s;for(o=o?t(o,r,1):e,n=o(n);a>s;){var h=s+a>>>1;o(i[h])<n?s=h+1:a=h}return s}return i}),define("lodash/arrays/indexOf",["../internals/baseIndexOf","./sortedIndex"],function(t,e){function i(i,o,r){if("number"==typeof r){var s=i?i.length:0;r=0>r?n(0,s+r):r||0}else if(r){var a=e(i,o);return i[a]===o?a:-1}return t(i,o,r)}var n=Math.max;return i}),define("lodash/arrays/initial",["../functions/createCallback","../internals/slice"],function(t,e){function i(i,r,s){var a=0,h=i?i.length:0;if("number"!=typeof r&&null!=r){var l=h;for(r=t(r,s,3);l--&&r(i[l],l,i);)a++}else a=null==r||s?1:r||a;return e(i,0,o(n(0,h-a),h))}var n=Math.max,o=Math.min;return i}),define("lodash/arrays/intersection",["../internals/baseIndexOf","../internals/cacheIndexOf","../internals/createCache","../internals/getArray","../objects/isArguments","../objects/isArray","../internals/largeArraySize","../internals/releaseArray","../internals/releaseObject"],function(t,e,i,n,o,r,s,a,h){function l(){for(var l=[],u=-1,c=arguments.length,d=n(),p=t,f=p===t,g=n();++u<c;){var m=arguments[u];(r(m)||o(m))&&(l.push(m),d.push(f&&m.length>=s&&i(u?l[u]:g)))}var y=l[0],b=-1,v=y?y.length:0,x=[];t:for(;++b<v;){var w=d[0];if(m=y[b],(w?e(w,m):p(g,m))<0){for(u=c,(w||g).push(m);--u;)if(w=d[u],(w?e(w,m):p(l[u],m))<0)continue t;x.push(m)}}for(;c--;)w=d[c],w&&h(w);return a(d),a(g),x}return l}),define("lodash/arrays/last",["../functions/createCallback","../internals/slice"],function(t,e){function i(i,r,s){var a=0,h=i?i.length:0;if("number"!=typeof r&&null!=r){var l=h;for(r=t(r,s,3);l--&&r(i[l],l,i);)a++}else if(a=r,null==a||s)return i?i[h-1]:n;return e(i,o(0,h-a))}var n,o=Math.max;return i}),define("lodash/arrays/lastIndexOf",[],function(){function t(t,n,o){var r=t?t.length:0;for("number"==typeof o&&(r=(0>o?e(0,r+o):i(o,r-1))+1);r--;)if(t[r]===n)return r;return-1}var e=Math.max,i=Math.min;return t}),define("lodash/arrays/pull",[],function(){function t(t){for(var e=arguments,n=0,o=e.length,r=t?t.length:0;++n<o;)for(var s=-1,a=e[n];++s<r;)t[s]===a&&(i.call(t,s--,1),r--);return t}var e=[],i=e.splice;return t}),define("lodash/arrays/range",[],function(){function t(t,n,o){t=+t||0,o="number"==typeof o?o:+o||1,null==n&&(n=t,t=0);for(var r=-1,s=i(0,e((n-t)/(o||1))),a=Array(s);++r<s;)a[r]=t,t+=o;return a}var e=Math.ceil,i=Math.max;return t}),define("lodash/arrays/remove",["../functions/createCallback"],function(t){function e(e,i,o){var r=-1,s=e?e.length:0,a=[];for(i=t(i,o,3);++r<s;){var h=e[r];i(h,r,e)&&(a.push(h),n.call(e,r--,1),s--)}return a}var i=[],n=i.splice;return e}),define("lodash/arrays/rest",["../functions/createCallback","../internals/slice"],function(t,e){function i(i,o,r){if("number"!=typeof o&&null!=o){var s=0,a=-1,h=i?i.length:0;for(o=t(o,r,3);++a<h&&o(i[a],a,i);)s++}else s=null==o||r?1:n(0,o);return e(i,s)}var n=Math.max;return i}),define("lodash/internals/baseUniq",["./baseIndexOf","./cacheIndexOf","./createCache","./getArray","./largeArraySize","./releaseArray","./releaseObject"],function(t,e,i,n,o,r,s){function a(a,h,l){var u=-1,c=t,d=a?a.length:0,p=[],f=!h&&d>=o,g=l||f?n():p;if(f){var m=i(g);c=e,g=m}for(;++u<d;){var y=a[u],b=l?l(y,u,a):y;(h?!u||g[g.length-1]!==b:c(g,b)<0)&&((l||f)&&g.push(b),p.push(y))}return f?(r(g.array),s(g)):l&&r(g),p}return a}),define("lodash/arrays/union",["../internals/baseFlatten","../internals/baseUniq"],function(t,e){function i(){return e(t(arguments,!0,!0))}return i}),define("lodash/arrays/uniq",["../internals/baseUniq","../functions/createCallback"],function(t,e){function i(i,n,o,r){return"boolean"!=typeof n&&null!=n&&(r=o,o="function"!=typeof n&&r&&r[n]===i?null:n,n=!1),null!=o&&(o=e(o,r,3)),t(i,n,o)}return i}),define("lodash/arrays/without",["../internals/baseDifference","../internals/slice"],function(t,e){function i(i){return t(i,e(arguments,1))}return i}),define("lodash/arrays/xor",["../internals/baseDifference","../internals/baseUniq","../objects/isArguments","../objects/isArray"],function(t,e,i,n){function o(){for(var o=-1,r=arguments.length;++o<r;){var s=arguments[o];if(n(s)||i(s))var a=a?e(t(a,s).concat(t(s,a))):s}return a||[]}return o}),define("lodash/internals/charAtCallback",[],function(){function t(t){return t.charCodeAt(0)}return t}),define("lodash/collections/forEach",["../internals/baseCreateCallback","../objects/forOwn"],function(t,e){function i(i,n,o){var r=-1,s=i?i.length:0;if(n=n&&"undefined"==typeof o?n:t(n,o,3),"number"==typeof s)for(;++r<s&&n(i[r],r,i)!==!1;);else e(i,n);return i}return i}),define("lodash/objects/isString",[],function(){function t(t){return"string"==typeof t||t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object String]",i=Object.prototype,n=i.toString;return t}),define("lodash/collections/max",["../internals/charAtCallback","../functions/createCallback","./forEach","../objects/forOwn","../objects/isArray","../objects/isString"],function(t,e,i,n,o,r){function s(n,s,a){var h=-1/0,l=h;if("function"!=typeof s&&a&&a[s]===n&&(s=null),null==s&&o(n))for(var u=-1,c=n.length;++u<c;){var d=n[u];d>l&&(l=d)}else s=null==s&&r(n)?t:e(s,a,3),i(n,function(t,e,i){var n=s(t,e,i);n>h&&(h=n,l=t)});return l}return s}),define("lodash/collections/pluck",["./map"],function(t){var e=t;return e}),define("lodash/arrays/zip",["../collections/max","../collections/pluck"],function(t,e){function i(){for(var i=arguments.length>1?arguments:arguments[0],n=-1,o=i?t(e(i,"length")):0,r=Array(0>o?0:o);++n<o;)r[n]=e(i,n);return r}return i}),define("lodash/arrays/zipObject",["../objects/isArray"],function(t){function e(e,i){var n=-1,o=e?e.length:0,r={};for(i||!o||t(e[0])||(i=[]);++n<o;){var s=e[n];i?r[s]=i[n]:s&&(r[s[0]]=s[1])}return r}return e}),define("lodash/arrays",["./arrays/compact","./arrays/difference","./arrays/findIndex","./arrays/findLastIndex","./arrays/first","./arrays/flatten","./arrays/indexOf","./arrays/initial","./arrays/intersection","./arrays/last","./arrays/lastIndexOf","./arrays/pull","./arrays/range","./arrays/remove","./arrays/rest","./arrays/sortedIndex","./arrays/union","./arrays/uniq","./arrays/without","./arrays/xor","./arrays/zip","./arrays/zipObject"],function(t,e,i,n,o,r,s,a,h,l,u,c,d,p,f,g,m,y,b,v,x,w){return{compact:t,difference:e,drop:f,findIndex:i,findLastIndex:n,first:o,flatten:r,head:o,indexOf:s,initial:a,intersection:h,last:l,lastIndexOf:u,object:w,pull:c,range:d,remove:p,rest:f,sortedIndex:g,tail:f,take:o,union:m,uniq:y,unique:y,unzip:x,without:b,xor:v,zip:x,zipObject:w}}),define("lodash/internals/lodashWrapper",[],function(){function t(t,e){this.__chain__=!!e,this.__wrapped__=t}return t}),define("lodash/chaining/chain",["../internals/lodashWrapper"],function(t){function e(e){return e=new t(e),e.__chain__=!0,e}return e}),define("lodash/chaining/tap",[],function(){function t(t,e){return e(t),t}return t}),define("lodash/chaining/wrapperChain",[],function(){function t(){return this.__chain__=!0,this}return t}),define("lodash/chaining/wrapperToString",[],function(){function t(){return String(this.__wrapped__)}return t}),define("lodash/chaining/wrapperValueOf",["../collections/forEach","../support"],function(){function t(){return this.__wrapped__}return t}),define("lodash/chaining",["./chaining/chain","./chaining/tap","./chaining/wrapperChain","./chaining/wrapperToString","./chaining/wrapperValueOf"],function(t,e,i,n,o){return{chain:t,tap:e,value:o,wrapperChain:i,wrapperToString:n,wrapperValueOf:o}}),define("lodash/collections/at",["../internals/baseFlatten","../objects/isString"],function(t){function e(e){for(var i=arguments,n=-1,o=t(i,!0,!1,1),r=i[2]&&i[2][i[1]]===e?1:o.length,s=Array(r);++n<r;)s[n]=e[o[n]];return s}return e}),define("lodash/collections/contains",["../internals/baseIndexOf","../objects/forOwn","../objects/isArray","../objects/isString"],function(t,e,i,n){function o(o,s,a){var h=-1,l=t,u=o?o.length:0,c=!1;return a=(0>a?r(0,u+a):a)||0,i(o)?c=l(o,s,a)>-1:"number"==typeof u?c=(n(o)?o.indexOf(s,a):l(o,s,a))>-1:e(o,function(t){return++h>=a?!(c=t===s):void 0}),c}var r=Math.max;return o}),define("lodash/internals/createAggregator",["../functions/createCallback","../objects/forOwn","../objects/isArray"],function(t,e){function i(i){return function(n,o,r){var s={};o=t(o,r,3);var a=-1,h=n?n.length:0;if("number"==typeof h)for(;++a<h;){var l=n[a];i(s,l,o(l,a,n),n)}else e(n,function(t,e,n){i(s,t,o(t,e,n),n)});return s}}return i}),define("lodash/collections/countBy",["../internals/createAggregator"],function(t){var e=Object.prototype,i=e.hasOwnProperty,n=t(function(t,e,n){i.call(t,n)?t[n]++:t[n]=1
});return n}),define("lodash/collections/every",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o){var r=!0;n=t(n,o,3);var s=-1,a=i?i.length:0;if("number"==typeof a)for(;++s<a&&(r=!!n(i[s],s,i)););else e(i,function(t,e,i){return r=!!n(t,e,i)});return r}return i}),define("lodash/collections/filter",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o){var r=[];n=t(n,o,3);var s=-1,a=i?i.length:0;if("number"==typeof a)for(;++s<a;){var h=i[s];n(h,s,i)&&r.push(h)}else e(i,function(t,e,i){n(t,e,i)&&r.push(t)});return r}return i}),define("lodash/collections/find",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o){n=t(n,o,3);var r=-1,s=i?i.length:0;if("number"!=typeof s){var a;return e(i,function(t,e,i){return n(t,e,i)?(a=t,!1):void 0}),a}for(;++r<s;){var h=i[r];if(n(h,r,i))return h}}return i}),define("lodash/collections/forEachRight",["../internals/baseCreateCallback","../objects/forOwn","../objects/isArray","../objects/isString","../objects/keys"],function(t,e,i,n,o){function r(i,n,r){var s=i?i.length:0;if(n=n&&"undefined"==typeof r?n:t(n,r,3),"number"==typeof s)for(;s--&&n(i[s],s,i)!==!1;);else{var a=o(i);s=a.length,e(i,function(t,e,i){return e=a?a[--s]:--s,n(i[e],e,i)})}return i}return r}),define("lodash/collections/findLast",["../functions/createCallback","./forEachRight"],function(t,e){function i(i,n,o){var r;return n=t(n,o,3),e(i,function(t,e,i){return n(t,e,i)?(r=t,!1):void 0}),r}return i}),define("lodash/collections/groupBy",["../internals/createAggregator"],function(t){var e=Object.prototype,i=e.hasOwnProperty,n=t(function(t,e,n){(i.call(t,n)?t[n]:t[n]=[]).push(e)});return n}),define("lodash/collections/indexBy",["../internals/createAggregator"],function(t){var e=t(function(t,e,i){t[i]=e});return e}),define("lodash/collections/invoke",["./forEach","../internals/slice"],function(t,e){function i(i,n){var o=e(arguments,2),r=-1,s="function"==typeof n,a=i?i.length:0,h=Array("number"==typeof a?a:0);return t(i,function(t){h[++r]=(s?n:t[n]).apply(t,o)}),h}return i}),define("lodash/collections/min",["../internals/charAtCallback","../functions/createCallback","./forEach","../objects/forOwn","../objects/isArray","../objects/isString"],function(t,e,i,n,o,r){function s(n,s,a){var h=1/0,l=h;if("function"!=typeof s&&a&&a[s]===n&&(s=null),null==s&&o(n))for(var u=-1,c=n.length;++u<c;){var d=n[u];l>d&&(l=d)}else s=null==s&&r(n)?t:e(s,a,3),i(n,function(t,e,i){var n=s(t,e,i);h>n&&(h=n,l=t)});return l}return s}),define("lodash/collections/reduce",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o,r){if(!i)return o;var s=arguments.length<3;n=t(n,r,4);var a=-1,h=i.length;if("number"==typeof h)for(s&&(o=i[++a]);++a<h;)o=n(o,i[a],a,i);else e(i,function(t,e,i){o=s?(s=!1,t):n(o,t,e,i)});return o}return i}),define("lodash/collections/reduceRight",["../functions/createCallback","./forEachRight"],function(t,e){function i(i,n,o,r){var s=arguments.length<3;return n=t(n,r,4),e(i,function(t,e,i){o=s?(s=!1,t):n(o,t,e,i)}),o}return i}),define("lodash/collections/reject",["../functions/createCallback","./filter"],function(t,e){function i(i,n,o){return n=t(n,o,3),e(i,function(t,e,i){return!n(t,e,i)})}return i}),define("lodash/internals/baseRandom",[],function(){function t(t,n){return t+e(i()*(n-t+1))}var e=Math.floor,i=Math.random;return t}),define("lodash/collections/shuffle",["../internals/baseRandom","./forEach"],function(t,e){function i(i){var n=-1,o=i?i.length:0,r=Array("number"==typeof o?o:0);return e(i,function(e){var i=t(0,++n);r[n]=r[i],r[i]=e}),r}return i}),define("lodash/objects/values",["./keys"],function(t){function e(e){for(var i=-1,n=t(e),o=n.length,r=Array(o);++i<o;)r[i]=e[n[i]];return r}return e}),define("lodash/collections/sample",["../internals/baseRandom","../objects/isString","./shuffle","../objects/values"],function(t,e,i,n){function o(e,o,h){if(e&&"number"!=typeof e.length&&(e=n(e)),null==o||h)return e?e[t(0,e.length-1)]:r;var l=i(e);return l.length=a(s(0,o),l.length),l}var r,s=Math.max,a=Math.min;return o}),define("lodash/collections/size",["../objects/keys"],function(t){function e(e){var i=e?e.length:0;return"number"==typeof i?i:t(e).length}return e}),define("lodash/collections/some",["../functions/createCallback","../objects/forOwn","../objects/isArray"],function(t,e){function i(i,n,o){var r;n=t(n,o,3);var s=-1,a=i?i.length:0;if("number"==typeof a)for(;++s<a&&!(r=n(i[s],s,i)););else e(i,function(t,e,i){return!(r=n(t,e,i))});return!!r}return i}),define("lodash/internals/compareAscending",[],function(){function t(t,e){for(var i=t.criteria,n=e.criteria,o=-1,r=i.length;++o<r;){var s=i[o],a=n[o];if(s!==a){if(s>a||"undefined"==typeof s)return 1;if(a>s||"undefined"==typeof a)return-1}}return t.index-e.index}return t}),define("lodash/collections/sortBy",["../internals/compareAscending","../functions/createCallback","./forEach","../internals/getArray","../internals/getObject","../objects/isArray","./map","../internals/releaseArray","../internals/releaseObject"],function(t,e,i,n,o,r,s,a,h){function l(l,u,c){var d=-1,p=r(u),f=l?l.length:0,g=Array("number"==typeof f?f:0);for(p||(u=e(u,c,3)),i(l,function(t,e,i){var r=g[++d]=o();p?r.criteria=s(u,function(e){return t[e]}):(r.criteria=n())[0]=u(t,e,i),r.index=d,r.value=t}),f=g.length,g.sort(t);f--;){var m=g[f];g[f]=m.value,p||a(m.criteria),h(m)}return g}return l}),define("lodash/collections/toArray",["../objects/isString","../internals/slice","../objects/values"],function(t,e,i){function n(t){return t&&"number"==typeof t.length?e(t):i(t)}return n}),define("lodash/collections/where",["./filter"],function(t){var e=t;return e}),define("lodash/collections",["./collections/at","./collections/contains","./collections/countBy","./collections/every","./collections/filter","./collections/find","./collections/findLast","./collections/forEach","./collections/forEachRight","./collections/groupBy","./collections/indexBy","./collections/invoke","./collections/map","./collections/max","./collections/min","./collections/pluck","./collections/reduce","./collections/reduceRight","./collections/reject","./collections/sample","./collections/shuffle","./collections/size","./collections/some","./collections/sortBy","./collections/toArray","./collections/where"],function(t,e,i,n,o,r,s,a,h,l,u,c,d,p,f,g,m,y,b,v,x,w,C,S,T,_){return{all:n,any:C,at:t,collect:d,contains:e,countBy:i,detect:r,each:a,eachRight:h,every:n,filter:o,find:r,findLast:s,findWhere:r,foldl:m,foldr:y,forEach:a,forEachRight:h,groupBy:l,include:e,indexBy:u,inject:m,invoke:c,map:d,max:p,min:f,pluck:g,reduce:m,reduceRight:y,reject:b,sample:v,select:o,shuffle:x,size:w,some:C,sortBy:S,toArray:T,where:_}}),define("lodash/functions/after",["../objects/isFunction"],function(t){function e(e,i){if(!t(i))throw new TypeError;return function(){return--e<1?i.apply(this,arguments):void 0}}return e}),define("lodash/objects/functions",["./forIn","./isFunction"],function(t,e){function i(i){var n=[];return t(i,function(t,i){e(t)&&n.push(i)}),n.sort()}return i}),define("lodash/functions/bindAll",["../internals/baseFlatten","../internals/createWrapper","../objects/functions"],function(t,e,i){function n(n){for(var o=arguments.length>1?t(arguments,!0,!1,1):i(n),r=-1,s=o.length;++r<s;){var a=o[r];n[a]=e(n[a],1,null,null,n)}return n}return n}),define("lodash/functions/bindKey",["../internals/createWrapper","../internals/slice"],function(t,e){function i(i,n){return arguments.length>2?t(n,19,e(arguments,2),null,i):t(n,3,null,null,i)}return i}),define("lodash/functions/compose",["../objects/isFunction"],function(t){function e(){for(var e=arguments,i=e.length;i--;)if(!t(e[i]))throw new TypeError;return function(){for(var t=arguments,i=e.length;i--;)t=[e[i].apply(this,t)];return t[0]}}return e}),define("lodash/functions/curry",["../internals/createWrapper"],function(t){function e(e,i){return i="number"==typeof i?i:+i||e.length,t(e,4,null,null,null,i)}return e}),define("lodash/utilities/now",["../internals/isNative"],function(t){var e=t(e=Date.now)&&e||function(){return(new Date).getTime()};return e}),define("lodash/functions/debounce",["../objects/isFunction","../objects/isObject","../utilities/now"],function(t,e,i){function n(n,s,a){var h,l,u,c,d,p,f,g=0,m=!1,y=!0;if(!t(n))throw new TypeError;if(s=r(0,s)||0,a===!0){var b=!0;y=!1}else e(a)&&(b=a.leading,m="maxWait"in a&&(r(s,a.maxWait)||0),y="trailing"in a?a.trailing:y);var v=function(){var t=s-(i()-c);if(0>=t){l&&clearTimeout(l);var e=f;l=p=f=o,e&&(g=i(),u=n.apply(d,h),p||l||(h=d=null))}else p=setTimeout(v,t)},x=function(){p&&clearTimeout(p),l=p=f=o,(y||m!==s)&&(g=i(),u=n.apply(d,h),p||l||(h=d=null))};return function(){if(h=arguments,c=i(),d=this,f=y&&(p||!b),m===!1)var t=b&&!p;else{l||b||(g=c);var e=m-(c-g),o=0>=e;o?(l&&(l=clearTimeout(l)),g=c,u=n.apply(d,h)):l||(l=setTimeout(x,e))}return o&&p?p=clearTimeout(p):p||s===m||(p=setTimeout(v,s)),t&&(o=!0,u=n.apply(d,h)),!o||p||l||(h=d=null),u}}var o,r=Math.max;return n}),define("lodash/functions/defer",["../objects/isFunction","../internals/slice"],function(t,e){function i(i){if(!t(i))throw new TypeError;var o=e(arguments,1);return setTimeout(function(){i.apply(n,o)},1)}var n;return i}),define("lodash/functions/delay",["../objects/isFunction","../internals/slice"],function(t,e){function i(i,o){if(!t(i))throw new TypeError;var r=e(arguments,2);return setTimeout(function(){i.apply(n,r)},o)}var n;return i}),define("lodash/functions/memoize",["../objects/isFunction","../internals/keyPrefix"],function(t,e){function i(i,n){if(!t(i))throw new TypeError;var r=function(){var t=r.cache,s=n?n.apply(this,arguments):e+arguments[0];return o.call(t,s)?t[s]:t[s]=i.apply(this,arguments)};return r.cache={},r}var n=Object.prototype,o=n.hasOwnProperty;return i}),define("lodash/functions/once",["../objects/isFunction"],function(t){function e(e){var i,n;if(!t(e))throw new TypeError;return function(){return i?n:(i=!0,n=e.apply(this,arguments),e=null,n)}}return e}),define("lodash/functions/partial",["../internals/createWrapper","../internals/slice"],function(t,e){function i(i){return t(i,16,e(arguments,1))}return i}),define("lodash/functions/partialRight",["../internals/createWrapper","../internals/slice"],function(t,e){function i(i){return t(i,32,null,e(arguments,1))}return i}),define("lodash/functions/throttle",["./debounce","../objects/isFunction","../objects/isObject"],function(t,e,i){function n(n,r,s){var a=!0,h=!0;if(!e(n))throw new TypeError;return s===!1?a=!1:i(s)&&(a="leading"in s?s.leading:a,h="trailing"in s?s.trailing:h),o.leading=a,o.maxWait=r,o.trailing=h,t(n,r,o)}var o={leading:!1,maxWait:0,trailing:!1};return n}),define("lodash/functions/wrap",["../internals/createWrapper"],function(t){function e(e,i){return t(i,16,[e])}return e}),define("lodash/functions",["./functions/after","./functions/bind","./functions/bindAll","./functions/bindKey","./functions/compose","./functions/createCallback","./functions/curry","./functions/debounce","./functions/defer","./functions/delay","./functions/memoize","./functions/once","./functions/partial","./functions/partialRight","./functions/throttle","./functions/wrap"],function(t,e,i,n,o,r,s,a,h,l,u,c,d,p,f,g){return{after:t,bind:e,bindAll:i,bindKey:n,compose:o,createCallback:r,curry:s,debounce:a,defer:h,delay:l,memoize:u,once:c,partial:d,partialRight:p,throttle:f,wrap:g}}),define("lodash/objects/assign",["../internals/baseCreateCallback","./keys","../internals/objectTypes"],function(t,e,i){var n=function(n,o,r){var s,a=n,h=a;if(!a)return h;var l=arguments,u=0,c="number"==typeof r?2:l.length;if(c>3&&"function"==typeof l[c-2])var d=t(l[--c-1],l[c--],2);else c>2&&"function"==typeof l[c-1]&&(d=l[--c]);for(;++u<c;)if(a=l[u],a&&i[typeof a])for(var p=-1,f=i[typeof a]&&e(a),g=f?f.length:0;++p<g;)s=f[p],h[s]=d?d(h[s],a[s]):a[s];return h};return n}),define("lodash/internals/baseClone",["../objects/assign","../collections/forEach","../objects/forOwn","./getArray","../objects/isArray","../objects/isObject","./releaseArray","./slice"],function(t,e,i,n,o,r,s,a){function h(u,c,f,m,x){if(f){var T=f(u);if("undefined"!=typeof T)return T}var _=r(u);if(!_)return u;var A=w.call(u);if(!v[A])return u;var k=S[A];switch(A){case d:case p:return new k(+u);case g:case b:return new k(u);case y:return T=k(u.source,l.exec(u)),T.lastIndex=u.lastIndex,T}var M=o(u);if(c){var B=!m;m||(m=n()),x||(x=n());for(var L=m.length;L--;)if(m[L]==u)return x[L];T=M?k(u.length):{}}else T=M?a(u):t({},u);return M&&(C.call(u,"index")&&(T.index=u.index),C.call(u,"input")&&(T.input=u.input)),c?(m.push(u),x.push(T),(M?e:i)(u,function(t,e){T[e]=h(t,c,f,m,x)}),B&&(s(m),s(x)),T):T}var l=/\w*$/,u="[object Arguments]",c="[object Array]",d="[object Boolean]",p="[object Date]",f="[object Function]",g="[object Number]",m="[object Object]",y="[object RegExp]",b="[object String]",v={};v[f]=!1,v[u]=v[c]=v[d]=v[p]=v[g]=v[m]=v[y]=v[b]=!0;var x=Object.prototype,w=x.toString,C=x.hasOwnProperty,S={};return S[c]=Array,S[d]=Boolean,S[p]=Date,S[f]=Function,S[m]=Object,S[g]=Number,S[y]=RegExp,S[b]=String,h}),define("lodash/objects/clone",["../internals/baseClone","../internals/baseCreateCallback"],function(t,e){function i(i,n,o,r){return"boolean"!=typeof n&&null!=n&&(r=o,o=n,n=!1),t(i,n,"function"==typeof o&&e(o,r,1))}return i}),define("lodash/objects/cloneDeep",["../internals/baseClone","../internals/baseCreateCallback"],function(t,e){function i(i,n,o){return t(i,!0,"function"==typeof n&&e(n,o,1))}return i}),define("lodash/objects/create",["./assign","../internals/baseCreate"],function(t,e){function i(i,n){var o=e(i);return n?t(o,n):o}return i}),define("lodash/objects/defaults",["./keys","../internals/objectTypes"],function(t,e){var i=function(i,n,o){var r,s=i,a=s;if(!s)return a;for(var h=arguments,l=0,u="number"==typeof o?2:h.length;++l<u;)if(s=h[l],s&&e[typeof s])for(var c=-1,d=e[typeof s]&&t(s),p=d?d.length:0;++c<p;)r=d[c],"undefined"==typeof a[r]&&(a[r]=s[r]);return a};return i}),define("lodash/objects/findKey",["../functions/createCallback","./forOwn"],function(t,e){function i(i,n,o){var r;return n=t(n,o,3),e(i,function(t,e,i){return n(t,e,i)?(r=e,!1):void 0}),r}return i}),define("lodash/objects/forOwnRight",["../internals/baseCreateCallback","./keys"],function(t,e){function i(i,n,o){var r=e(i),s=r.length;for(n=t(n,o,3);s--;){var a=r[s];if(n(i[a],a,i)===!1)break}return i}return i}),define("lodash/objects/findLastKey",["../functions/createCallback","./forOwnRight"],function(t,e){function i(i,n,o){var r;return n=t(n,o,3),e(i,function(t,e,i){return n(t,e,i)?(r=e,!1):void 0}),r}return i}),define("lodash/objects/forInRight",["../internals/baseCreateCallback","./forIn"],function(t,e){function i(i,n,o){var r=[];e(i,function(t,e){r.push(e,t)});var s=r.length;for(n=t(n,o,3);s--&&n(r[s--],r[s],i)!==!1;);return i}return i}),define("lodash/objects/has",[],function(){function t(t,e){return t?i.call(t,e):!1}var e=Object.prototype,i=e.hasOwnProperty;return t}),define("lodash/objects/invert",["./keys"],function(t){function e(e){for(var i=-1,n=t(e),o=n.length,r={};++i<o;){var s=n[i];r[e[s]]=s}return r}return e}),define("lodash/objects/isBoolean",[],function(){function t(t){return t===!0||t===!1||t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object Boolean]",i=Object.prototype,n=i.toString;return t}),define("lodash/objects/isDate",[],function(){function t(t){return t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object Date]",i=Object.prototype,n=i.toString;return t}),define("lodash/objects/isElement",[],function(){function t(t){return t&&1===t.nodeType||!1}return t}),define("lodash/objects/isEmpty",["./forOwn","./isFunction"],function(t,e){function i(i){var a=!0;if(!i)return a;var l=h.call(i),u=i.length;return l==o||l==s||l==n||l==r&&"number"==typeof u&&e(i.splice)?!u:(t(i,function(){return a=!1}),a)}var n="[object Arguments]",o="[object Array]",r="[object Object]",s="[object String]",a=Object.prototype,h=a.toString;return i}),define("lodash/objects/isEqual",["../internals/baseCreateCallback","../internals/baseIsEqual"],function(t,e){function i(i,n,o,r){return e(i,n,"function"==typeof o&&t(o,r,2))}return i}),define("lodash/objects/isFinite",[],function(){function t(t){return e(t)&&!i(parseFloat(t))}var e=window.isFinite,i=window.isNaN;return t}),define("lodash/objects/isNumber",[],function(){function t(t){return"number"==typeof t||t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object Number]",i=Object.prototype,n=i.toString;return t}),define("lodash/objects/isNaN",["./isNumber"],function(t){function e(e){return t(e)&&e!=+e}return e}),define("lodash/objects/isNull",[],function(){function t(t){return null===t}return t}),define("lodash/internals/shimIsPlainObject",["../objects/forIn","../objects/isFunction"],function(t,e){function i(i){var o,a;return i&&r.call(i)==n&&(o=i.constructor,!e(o)||o instanceof o)?(t(i,function(t,e){a=e}),"undefined"==typeof a||s.call(i,a)):!1}var n="[object Object]",o=Object.prototype,r=o.toString,s=o.hasOwnProperty;return i}),define("lodash/objects/isPlainObject",["../internals/isNative","../internals/shimIsPlainObject"],function(t,e){var i="[object Object]",n=Object.prototype,o=n.toString,r=t(r=Object.getPrototypeOf)&&r,s=r?function(n){if(!n||o.call(n)!=i)return!1;var s=n.valueOf,a=t(s)&&(a=r(s))&&r(a);return a?n==a||r(n)==a:e(n)}:e;return s}),define("lodash/objects/isRegExp",[],function(){function t(t){return t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object RegExp]",i=Object.prototype,n=i.toString;return t}),define("lodash/objects/isUndefined",[],function(){function t(t){return"undefined"==typeof t}return t}),define("lodash/objects/mapValues",["../functions/createCallback","./forOwn"],function(t,e){function i(i,n,o){var r={};return n=t(n,o,3),e(i,function(t,e,i){r[e]=n(t,e,i)}),r}return i}),define("lodash/internals/baseMerge",["../collections/forEach","../objects/forOwn","../objects/isArray","../objects/isPlainObject"],function(t,e,i,n){function o(r,s,a,h,l){(i(s)?t:e)(s,function(t,e){var s,u,c=t,d=r[e];if(t&&((u=i(t))||n(t))){for(var p=h.length;p--;)if(s=h[p]==t){d=l[p];break}if(!s){var f;a&&(c=a(d,t),(f="undefined"!=typeof c)&&(d=c)),f||(d=u?i(d)?d:[]:n(d)?d:{}),h.push(t),l.push(d),f||o(d,t,a,h,l)}}else a&&(c=a(d,t),"undefined"==typeof c&&(c=t)),"undefined"!=typeof c&&(d=c);r[e]=d})}return o}),define("lodash/objects/merge",["../internals/baseCreateCallback","../internals/baseMerge","../internals/getArray","./isObject","../internals/releaseArray","../internals/slice"],function(t,e,i,n,o,r){function s(s){var a=arguments,h=2;if(!n(s))return s;if("number"!=typeof a[2]&&(h=a.length),h>3&&"function"==typeof a[h-2])var l=t(a[--h-1],a[h--],2);else h>2&&"function"==typeof a[h-1]&&(l=a[--h]);for(var u=r(arguments,1,h),c=-1,d=i(),p=i();++c<h;)e(s,u[c],l,d,p);return o(d),o(p),s}return s}),define("lodash/objects/omit",["../internals/baseDifference","../internals/baseFlatten","../functions/createCallback","./forIn"],function(t,e,i,n){function o(o,r,s){var a={};if("function"!=typeof r){var h=[];n(o,function(t,e){h.push(e)}),h=t(h,e(arguments,!0,!1,1));for(var l=-1,u=h.length;++l<u;){var c=h[l];a[c]=o[c]}}else r=i(r,s,3),n(o,function(t,e,i){r(t,e,i)||(a[e]=t)});return a}return o}),define("lodash/objects/pairs",["./keys"],function(t){function e(e){for(var i=-1,n=t(e),o=n.length,r=Array(o);++i<o;){var s=n[i];r[i]=[s,e[s]]}return r}return e}),define("lodash/objects/pick",["../internals/baseFlatten","../functions/createCallback","./forIn","./isObject"],function(t,e,i,n){function o(o,r,s){var a={};if("function"!=typeof r)for(var h=-1,l=t(arguments,!0,!1,1),u=n(o)?l.length:0;++h<u;){var c=l[h];c in o&&(a[c]=o[c])}else r=e(r,s,3),i(o,function(t,e,i){r(t,e,i)&&(a[e]=t)});return a}return o}),define("lodash/objects/transform",["../internals/baseCreate","../functions/createCallback","../collections/forEach","./forOwn","./isArray"],function(t,e,i,n,o){function r(r,s,a,h){var l=o(r);if(null==a)if(l)a=[];else{var u=r&&r.constructor,c=u&&u.prototype;a=t(c)}return s&&(s=e(s,h,4),(l?i:n)(r,function(t,e,i){return s(a,t,e,i)})),a}return r}),define("lodash/objects",["./objects/assign","./objects/clone","./objects/cloneDeep","./objects/create","./objects/defaults","./objects/findKey","./objects/findLastKey","./objects/forIn","./objects/forInRight","./objects/forOwn","./objects/forOwnRight","./objects/functions","./objects/has","./objects/invert","./objects/isArguments","./objects/isArray","./objects/isBoolean","./objects/isDate","./objects/isElement","./objects/isEmpty","./objects/isEqual","./objects/isFinite","./objects/isFunction","./objects/isNaN","./objects/isNull","./objects/isNumber","./objects/isObject","./objects/isPlainObject","./objects/isRegExp","./objects/isString","./objects/isUndefined","./objects/keys","./objects/mapValues","./objects/merge","./objects/omit","./objects/pairs","./objects/pick","./objects/transform","./objects/values"],function(t,e,i,n,o,r,s,a,h,l,u,c,d,p,f,g,m,y,b,v,x,w,C,S,T,_,A,k,M,B,L,R,E,P,D,O,F,I,j){return{assign:t,clone:e,cloneDeep:i,create:n,defaults:o,extend:t,findKey:r,findLastKey:s,forIn:a,forInRight:h,forOwn:l,forOwnRight:u,functions:c,has:d,invert:p,isArguments:f,isArray:g,isBoolean:m,isDate:y,isElement:b,isEmpty:v,isEqual:x,isFinite:w,isFunction:C,isNaN:S,isNull:T,isNumber:_,isObject:A,isPlainObject:k,isRegExp:M,isString:B,isUndefined:L,keys:R,mapValues:E,merge:P,methods:c,omit:D,pairs:O,pick:F,transform:I,values:j}}),define("lodash/utilities/constant",[],function(){function t(t){return function(){return t}}return t}),define("lodash/internals/htmlEscapes",[],function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return t}),define("lodash/internals/escapeHtmlChar",["./htmlEscapes"],function(t){function e(e){return t[e]}return e}),define("lodash/internals/reUnescapedHtml",["./htmlEscapes","../objects/keys"],function(t,e){var i=RegExp("["+e(t).join("")+"]","g");return i}),define("lodash/utilities/escape",["../internals/escapeHtmlChar","../objects/keys","../internals/reUnescapedHtml"],function(t,e,i){function n(e){return null==e?"":String(e).replace(i,t)}return n}),define("lodash/utilities/mixin",["../collections/forEach","../objects/functions","../objects/isFunction","../objects/isObject"],function(t,e,i,n){function o(o,r,a){var h=!0,l=r&&e(r);a===!1?h=!1:n(a)&&"chain"in a&&(h=a.chain);var u=o,c=i(u);t(l,function(t){var e=o[t]=r[t];c&&(u.prototype[t]=function(){var t=this.__chain__,i=this.__wrapped__,r=[i];s.apply(r,arguments);var a=e.apply(o,r);if(h||t){if(i===a&&n(a))return this;a=new u(a),a.__chain__=t}return a})})}var r=[],s=r.push;return o}),define("lodash/utilities/noConflict",[],function(){function t(){return window._=e,this}var e=window._;return t}),define("lodash/utilities/parseInt",["../objects/isString"],function(t){var e=" 	\fÂ ï»¿\n\r\u2028\u2029áš€á Žâ€€â€â€‚â€ƒâ€„â€…â€†â€‡â€ˆâ€‰â€Šâ€¯âŸã€€",i=RegExp("^["+e+"]*0+(?=.$)"),n=window.parseInt,o=8==n(e+"08")?n:function(e,o){return n(t(e)?e.replace(i,""):e,o||0)};return o}),define("lodash/utilities/random",["../internals/baseRandom"],function(t){function e(e,o,r){var s=null==e,a=null==o;if(null==r&&("boolean"==typeof e&&a?(r=e,e=1):a||"boolean"!=typeof o||(r=o,a=!0)),s&&a&&(o=1),e=+e||0,a?(o=e,e=0):o=+o||0,r||e%1||o%1){var h=n();return i(e+h*(o-e+parseFloat("1e-"+((h+"").length-1))),o)}return t(e,o)}var i=Math.min,n=Math.random;return e}),define("lodash/utilities/result",["../objects/isFunction"],function(t){function e(e,i){if(e){var n=e[i];return t(n)?e[i]():n}}return e}),define("lodash/internals/escapeStringChar",[],function(){function t(t){return"\\"+e[t]}var e={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};return t}),define("lodash/internals/reInterpolate",[],function(){var t=/<%=([\s\S]+?)%>/g;return t}),define("lodash/utilities/templateSettings",["./escape","../internals/reInterpolate"],function(t,e){var i={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:e,variable:"",imports:{_:{escape:t}}};return i}),define("lodash/utilities/template",["../objects/defaults","./escape","../internals/escapeStringChar","../objects/keys","../internals/reInterpolate","./templateSettings","../objects/values"],function(t,e,i,n,o,r,s){function a(e,a,g){var m=r.imports._.templateSettings||r;e=String(e||""),g=t({},g,m);var y,b=t({},g.imports,m.imports),v=n(b),x=s(b),w=0,C=g.interpolate||p,S="__p += '",T=RegExp((g.escape||p).source+"|"+C.source+"|"+(C===o?d:p).source+"|"+(g.evaluate||p).source+"|$","g");e.replace(T,function(t,n,o,r,s,a){return o||(o=r),S+=e.slice(w,a).replace(f,i),n&&(S+="' +\n__e("+n+") +\n'"),s&&(y=!0,S+="';\n"+s+";\n__p += '"),o&&(S+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),w=a+t.length,t}),S+="';\n";var _=g.variable,A=_;A||(_="obj",S="with ("+_+") {\n"+S+"\n}\n"),S=(y?S.replace(l,""):S).replace(u,"$1").replace(c,"$1;"),S="function("+_+") {\n"+(A?"":_+" || ("+_+" = {});\n")+"var __t, __p = '', __e = _.escape"+(y?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+S+"return __p\n}";try{var k=Function(v,"return "+S).apply(h,x)}catch(M){throw M.source=S,M}return a?k(a):(k.source=S,k)}var h,l=/\b__p \+= '';/g,u=/\b(__p \+=) '' \+/g,c=/(__e\(.*?\)|\b__t\)) \+\n'';/g,d=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,p=/($^)/,f=/['\n\r\t\u2028\u2029\\]/g;return a}),define("lodash/utilities/times",["../internals/baseCreateCallback"],function(t){function e(e,i,n){e=(e=+e)>-1?e:0;var o=-1,r=Array(e);for(i=t(i,n,1);++o<e;)r[o]=i(o);return r}return e}),define("lodash/internals/htmlUnescapes",["./htmlEscapes","../objects/invert"],function(t,e){var i=e(t);return i}),define("lodash/internals/reEscapedHtml",["./htmlUnescapes","../objects/keys"],function(t,e){var i=RegExp("("+e(t).join("|")+")","g");return i}),define("lodash/internals/unescapeHtmlChar",["./htmlUnescapes"],function(t){function e(e){return t[e]}return e}),define("lodash/utilities/unescape",["../objects/keys","../internals/reEscapedHtml","../internals/unescapeHtmlChar"],function(t,e,i){function n(t){return null==t?"":String(t).replace(e,i)}return n}),define("lodash/utilities/uniqueId",[],function(){function t(t){var i=++e;return String(null==t?"":t)+i}var e=0;return t}),define("lodash/utilities",["./utilities/constant","./functions/createCallback","./utilities/escape","./utilities/identity","./utilities/mixin","./utilities/noConflict","./utilities/noop","./utilities/now","./utilities/parseInt","./utilities/property","./utilities/random","./utilities/result","./utilities/template","./utilities/templateSettings","./utilities/times","./utilities/unescape","./utilities/uniqueId"],function(t,e,i,n,o,r,s,a,h,l,u,c,d,p,f,g,m){return{constant:t,createCallback:e,escape:i,identity:n,mixin:o,noConflict:r,noop:s,now:a,parseInt:h,property:l,random:u,result:c,template:d,templateSettings:p,times:f,unescape:g,uniqueId:m}}),define("lodash/main",["./arrays","./chaining","./collections","./functions","./objects","./utilities","./collections/forEach","./objects/forOwn","./objects/isArray","./internals/lodashWrapper","./utilities/mixin","./support","./utilities/templateSettings"],function(t,e,i,n,o,r,s,a,h,l,u,c){function d(t){return t&&"object"==typeof t&&!h(t)&&g.call(t,"__wrapped__")?t:new l(t)}var p=[],f=Object.prototype,g=f.hasOwnProperty;return l.prototype=d.prototype,u=function(t){var e=o.functions;return function(i,n,o){return n&&(o||e(n).length)||(null==o&&(o=n),n=i,i=d),t(i,n,o)}}(u),d.after=n.after,d.assign=o.assign,d.at=i.at,d.bind=n.bind,d.bindAll=n.bindAll,d.bindKey=n.bindKey,d.chain=e.chain,d.compact=t.compact,d.compose=n.compose,d.constant=r.constant,d.countBy=i.countBy,d.create=o.create,d.createCallback=n.createCallback,d.curry=n.curry,d.debounce=n.debounce,d.defaults=o.defaults,d.defer=n.defer,d.delay=n.delay,d.difference=t.difference,d.filter=i.filter,d.flatten=t.flatten,d.forEach=s,d.forEachRight=i.forEachRight,d.forIn=o.forIn,d.forInRight=o.forInRight,d.forOwn=a,d.forOwnRight=o.forOwnRight,d.functions=o.functions,d.groupBy=i.groupBy,d.indexBy=i.indexBy,d.initial=t.initial,d.intersection=t.intersection,d.invert=o.invert,d.invoke=i.invoke,d.keys=o.keys,d.map=i.map,d.mapValues=o.mapValues,d.max=i.max,d.memoize=n.memoize,d.merge=o.merge,d.min=i.min,d.omit=o.omit,d.once=n.once,d.pairs=o.pairs,d.partial=n.partial,d.partialRight=n.partialRight,d.pick=o.pick,d.pluck=i.pluck,d.property=r.property,d.pull=t.pull,d.range=t.range,d.reject=i.reject,d.remove=t.remove,d.rest=t.rest,d.shuffle=i.shuffle,d.sortBy=i.sortBy,d.tap=e.tap,d.throttle=n.throttle,d.times=r.times,d.toArray=i.toArray,d.transform=o.transform,d.union=t.union,d.uniq=t.uniq,d.values=o.values,d.where=i.where,d.without=t.without,d.wrap=n.wrap,d.xor=t.xor,d.zip=t.zip,d.zipObject=t.zipObject,d.collect=i.map,d.drop=t.rest,d.each=s,d.eachRight=i.forEachRight,d.extend=o.assign,d.methods=o.functions,d.object=t.zipObject,d.select=i.filter,d.tail=t.rest,d.unique=t.uniq,d.unzip=t.zip,u(d),d.clone=o.clone,d.cloneDeep=o.cloneDeep,d.contains=i.contains,d.escape=r.escape,d.every=i.every,d.find=i.find,d.findIndex=t.findIndex,d.findKey=o.findKey,d.findLast=i.findLast,d.findLastIndex=t.findLastIndex,d.findLastKey=o.findLastKey,d.has=o.has,d.identity=r.identity,d.indexOf=t.indexOf,d.isArguments=o.isArguments,d.isArray=h,d.isBoolean=o.isBoolean,d.isDate=o.isDate,d.isElement=o.isElement,d.isEmpty=o.isEmpty,d.isEqual=o.isEqual,d.isFinite=o.isFinite,d.isFunction=o.isFunction,d.isNaN=o.isNaN,d.isNull=o.isNull,d.isNumber=o.isNumber,d.isObject=o.isObject,d.isPlainObject=o.isPlainObject,d.isRegExp=o.isRegExp,d.isString=o.isString,d.isUndefined=o.isUndefined,d.lastIndexOf=t.lastIndexOf,d.mixin=u,d.noConflict=r.noConflict,d.noop=r.noop,d.now=r.now,d.parseInt=r.parseInt,d.random=r.random,d.reduce=i.reduce,d.reduceRight=i.reduceRight,d.result=r.result,d.size=i.size,d.some=i.some,d.sortedIndex=t.sortedIndex,d.template=r.template,d.unescape=r.unescape,d.uniqueId=r.uniqueId,d.all=i.every,d.any=i.some,d.detect=i.find,d.findWhere=i.find,d.foldl=i.reduce,d.foldr=i.reduceRight,d.include=i.contains,d.inject=i.reduce,u(function(){var t={};return a(d,function(e,i){d.prototype[i]||(t[i]=e)}),t}(),!1),d.first=t.first,d.last=t.last,d.sample=i.sample,d.take=t.first,d.head=t.first,a(d,function(t,e){var i="sample"!==e;d.prototype[e]||(d.prototype[e]=function(e,n){var o=this.__chain__,r=t(this.__wrapped__,e,n);return o||null!=e&&(!n||i&&"function"==typeof e)?new l(r,o):r})}),d.VERSION="2.4.1",d.prototype.chain=e.wrapperChain,d.prototype.toString=e.wrapperToString,d.prototype.value=e.wrapperValueOf,d.prototype.valueOf=e.wrapperValueOf,s(["join","pop","shift"],function(t){var e=p[t];d.prototype[t]=function(){var t=this.__chain__,i=e.apply(this.__wrapped__,arguments);return t?new l(i,t):i}}),s(["push","reverse","sort","unshift"],function(t){var e=p[t];d.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),s(["concat","slice","splice"],function(t){var e=p[t];d.prototype[t]=function(){return new l(e.apply(this.__wrapped__,arguments),this.__chain__)}}),d.support=c,(d.templateSettings=r.templateSettings).imports._=d,d}),define("lodash",["lodash/main"],function(t){return t}),define("absolute/screenmetrics",["absolute/debug","absolute/platform","lodash"],function(t,e,i){var n={kDefaultWidth:1536,kDefaultHeight:2008,resClass:"",stepDownResClass:!1,stepDownResClassAggressively:!0,realWindow:function(){var t,e;try{e=window.self!==window.top,t=e&&parent.window.devicePixelRatio&&"undefined"!=typeof parent.window.devicePixelRatio?parent.window:window}catch(i){t=window}return t}(),realScreen:function(){var t;try{t=parent!==window&&parent.screen?parent.screen:screen}catch(e){t=screen}return t}(),refresh:function(){this.devicePixelRatio=this.realWindow.devicePixelRatio||1,this.screenWidth=this.realScreen.width,this.screenHeight=this.realScreen.height,this.innerWidth=this.realWindow.innerWidth,this.innerHeight=this.realWindow.innerHeight,this.outerWidth=this.realWindow.outerWidth,this.outerHeight=this.realWindow.outerHeight,this.clientWidth=document.documentElement.clientWidth,this.clientHeight=document.documentElement.clientHeight},getMinNonZero:function(t){return Math.min.apply(null,i.filter(t,function(t){return t>0
}))},isPortrait:function(){this.refresh();var t=this.getMinNonZero([this.innerWidth,this.screenWidth,this.clientWidth]),i=this.getMinNonZero([this.innerHeight,this.screenHeight,this.clientHeight]);return e._isAndroid()&&(t=this.getMinNonZero([this.innerWidth,this.clientWidth]),i=this.getMinNonZero([this.innerHeight,this.clientHeight])),i>t},getWidth:function(t){t="undefined"!=typeof t?t:!1;var i=this.clientWidth,n=this.clientHeight;if(t&&(i*=this.devicePixelRatio,n*=this.devicePixelRatio),this.isPortrait()&&i>0)return i;if(n>i)return i;if(1280===i)return 800;if(e._isAndroid())return Math.max(this.realScreen.height,n);var o=this.realScreen.width;return t&&(o*=this.devicePixelRatio),Math.max(o,n)},getHeight:function(t){t="undefined"!=typeof t?t:!1;var e;return e=this.isPortrait()&&this.clientHeight>0?this.clientHeight:this.screenWidth<this.screenHeight?this.screenHeight-(this.screenWidth-(this.innerHeight||0)):this.screenWidth-(this.screenHeight-(this.innerHeight||0)),t&&(e*=this.devicePixelRatio),navigator.userAgent.match(/iPhone/i)&&(e-=16),e},getScaledViewportWidth:function(){return this.getWidth()/this.getViewportScale()},getScaledViewportHeight:function(){return this.getHeight()/this.getViewportScale()},getScaledContentWidth:function(){return this.getContentWidth()*this.getViewportScale()},getScaledContentHeight:function(){return this.getContentHeight()*this.getViewportScale()},getContentWidth:function(){return this.kDefaultWidth*this.getResScale()/this.devicePixelRatio},getContentHeight:function(){return this.kDefaultHeight*this.getResScale()/this.devicePixelRatio},getViewportScale:function(){var t=this.getWidth()/this.getContentWidth(),e=this.getHeight()/this.getContentHeight();return Math.min(t,e)},resClasses:[{id:"r320",resfloor:0},{id:"r640",resfloor:320},{id:"r768",resfloor:640},{id:"r1280",resfloor:768}],getResClass:function(){if(""!==this.resClass)return this.resClass;for(var t=Math.min(this.getHeight(!0),this.getWidth(!0)),i=0,n=this.resClasses.length-1;n>0;n--)if(t>this.resClasses[n].resfloor){i=n;break}return this.stepDownResClass&&(i-=e.getResStepsDown(i,this.stepDownResClassAggressively),0>i&&(i=0)),this.resClass=this.resClasses[i].id,this.resClass},getResScale:function(){switch(this.getResClass()){case"r320":return.21;case"r640":return.42;case"r768":return.5;case"r1280":return.83;case"r1536":return 1;default:return 1}},getScaleX:function(){return this.getWidth()*this.devicePixelRatio/(this.kDefaultWidth*this.getResScale())},getScaleY:function(){return this.getHeight()*this.devicePixelRatio/(this.kDefaultHeight*this.getResScale())},log:function(){t.log("devicePixelRatio "+this.devicePixelRatio),t.log("screenWidth "+this.screenWidth),t.log("screenHeight "+this.screenHeight),t.log("innerWidth "+this.innerWidth),t.log("innerHeight "+this.innerHeight),t.log("outerWidth "+this.outerWidth),t.log("outerHeight "+this.outerHeight),t.log("isPortrait() "+this.isPortrait()),t.log("getWidth() "+this.getWidth()),t.log("getHeight() "+this.getHeight()),t.log("getResClass() "+this.getResClass()),t.log("getResScale() "+this.getResScale()),t.log("getContentWidth() "+this.getContentWidth()),t.log("getContentHeight() "+this.getContentHeight()),t.log("getViewportScale() "+this.getViewportScale()),t.log("getScaledContentWidth "+this.getScaledContentWidth()),t.log("getScaledContentHeight "+this.getScaledContentHeight()),t.log("getScaledViewportWidth "+this.getScaledViewportWidth()),t.log("getScaledViewportHeight "+this.getScaledViewportHeight())},getScreenParams:function(){return"devicePixelRatio="+this.devicePixelRatio+"&screen.width="+this.realScreen.width+"&screen.height="+this.realScreen.height+"&window.innerWidth="+this.realWindow.innerWidth+"&window.innerHeight="+this.realWindow.innerHeight+"&window.outerWidth="+this.realWindow.outerWidth+"&window.outerHeight="+this.realWindow.outerHeight+"&document.documentElement.clientWidth="+document.documentElement.clientWidth+"&document.documentElement.clientHeight="+document.documentElement.clientHeight+"&resClass="+this.getResClass()+"&resScale="+this.getResScale()},detectOrientationChange:function(t){function i(){var e=this.getOrientation();this.lastOrienation!==e&&(t(e),this.lastOrienation=e)}this.lastOrienation=this.getOrientation(),e.supportsDeviceOrientation?this.realWindow.addEventListener("deviceorientation",i.bind(this)):this.realWindow.addEventListener("resize",i.bind(this))},getOrientation:function(){return this.refresh(),this.isPortrait()?"portrait":"landscape"}};return n}),define("absolute/coords",["absolute/screenmetrics"],function(t){var e={x:function(e){return Math.round(e*t.getResScale())},y:function(e){return Math.round(e*t.getResScale())},worldX:function(e){return Math.round(e/t.getResScale())},worldY:function(e){return Math.round(e/t.getResScale())},offsetX:function(t,e){return e.position.x+t},offsetY:function(t,e){return e.position.y+t},centerX:function(t,e){return(e.width-t.width)/2},centerY:function(t,e){return(e.height-t.height)/2}};return e}),define("absolute/snapshot",["pixi"],function(t){var e=function(t){this.initSnapshot(t)};return e.constructor=e,e.prototype.initSnapshot=function(e){var i=new t.Stage;this.renderer=new t.CanvasRenderer(e.width,e.height,null,!0),i.addChild(e),this.renderer.render(i)},e.prototype.getSnapshot=function(){return t.Texture.fromCanvas(this.renderer.view)},e}),define("absolute/spriteutils",["absolute/snapshot","pixi","lodash"],function(t,e,i){var n={offScreenRenderer:new e.CanvasRenderer(512,512,null,!0),brightness:function(t,e){var i,n=t.generateTexture(this.offScreenRenderer),o=null;if(n.textureBuffer.context){o=n.textureBuffer.context.getImageData(n.frame.x,n.frame.y,n.frame.width,n.frame.height);var r=255*e||255,s=o.data;for(i=0;i<s.length;i+=4)s[i]+=r,s[i+1]+=r,s[i+2]+=r;n.textureBuffer.context.putImageData(o,0,0)}return n},greyscale:function(t,e){var i,n=t.generateTexture(this.offScreenRenderer),o=null;if(n.textureBuffer.context){o=n.textureBuffer.context.getImageData(n.frame.x,n.frame.y,n.frame.width,n.frame.height);var r=e||1,s=-128*r+128,a=o.data;for(i=0;i<a.length;i+=4){var h=a[i],l=a[i+1],u=a[i+2],c=.2126*h+.7152*l+.0722*u;c=c*r+s,a[i]=a[i+1]=a[i+2]=c}n.textureBuffer.context.putImageData(o,0,0)}return n},blur:function(t){var e=t.generateTexture(),i=e.textureBuffer.context.getImageData(e.frame.x,e.frame.y,e.frame.width,e.frame.height);return e.textureBuffer.context.putImageData(this.convolute(i,e.textureBuffer.context,[1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16]),0,0),e},convolute:function(t,e,i,n){for(var o=Math.round(Math.sqrt(i.length)),r=Math.floor(o/2),s=t.data,a=t.width,h=t.height,l=a,u=h,c=e.createImageData(l,u),d=c.data,p=n?1:0,f=0;u>f;f++)for(var g=0;l>g;g++){for(var m=f,y=g,b=4*(f*l+g),v=0,x=0,w=0,C=0,S=0;o>S;S++)for(var T=0;o>T;T++){var _=m+S-r,A=y+T-r;if(_>=0&&h>_&&A>=0&&a>A){var k=4*(_*a+A),M=i[S*o+T];v+=s[k]*M,x+=s[k+1]*M,w+=s[k+2]*M,C+=s[k+3]*M}}d[b]=v,d[b+1]=x,d[b+2]=w,d[b+3]=C+p*(255-C)}return c},hitTest:function(t,e,i,n,o,r,s,a){return t+i>o&&o+s>t&&e+n>r&&r+a>e},destroyAllChildren:function(t){t&&t.children&&t.children.length>0&&i.each(t.children,function(t){this.destroyAllChildren.call(this,t)},this),t&&"function"==typeof t.destroy&&t.destroy(!0)}};return n}),define("absolute/threeslice",["pixi","lodash"],function(t,e){var i=function(t){var i={width:"470",height:"126",images:{left:"LW_3slice_btn_01.png",center:"LW_3slice_btn_02.png",right:"LW_3slice_btn_03.png"}};this._initThreeSlice(e.extend(i,t))};return i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype._initThreeSlice=function(e){t.DisplayObjectContainer.call(this),this.options=e,this.cachedContent=this.options.content,this._setSize(),this._createBackground()},i.prototype._setSize=function(){this.width=this.options.width,this.height=this.options.height},i.prototype._createBackground=function(){var e=t.Sprite.fromFrame(this.options.images.left);e.position.x=0,e.position.y=0;var i=t.Sprite.fromFrame(this.options.images.right);i.position.x=this.width-i.width,i.position.y=0;var n=t.Texture.fromFrame(this.options.images.center);this.centerTile=new t.TilingSprite(n,this.width-e.width-i.width,n.height),this.centerTile.position.x=e.width,this.centerTile.position.y=0,this.addChild(this.centerTile),this.addChild(e),this.addChild(i)},i.prototype.destroy=function(){this.centerTile.tilingTexture.destroy(!0)},i}),define("absolute/button",["pixi","absolute/coords","absolute/audiomanager","absolute/platform","absolute/spriteutils","absolute/threeslice","lodash"],function(t,e,i,n,o,r){var s=function(t,e,i,n,o,r){this._initButton(t,e,i,n,o,r)};return s.constructor=s,s.prototype=Object.create(t.Sprite.prototype),s.prototype._initButton=function(i,r,s,a,h,l){this.replaceOnHover=!!a,h="undefined"!=typeof h?h:!1,this.replaceOnHover||(this.replaceOnHover=!0),l&&"object"==typeof l&&(this.container=new t.DisplayObjectContainer,this.texture=this._createThreeSliceImage(l),i=this.texture),t.Sprite.call(this,i),this.active=!0,this.action=s,this.images={},this.defaultImage=i,this.hoverImage=o.brightness(this,.2);var u=new t.DisplayObjectContainer,c=new t.Sprite(o.greyscale(this,.5)),d=new t.Sprite(this.defaultImage);c.alpha=.8,u.addChild(d),u.addChild(c),this.disabledTexture=u.generateTexture(),this.buttonMode=!0,this.setInteractive(!0),this.startPos=new t.Point,this.moveThreshold=e.x(5),this.down=!1;var p=this;n.supportsTouch()||(this.mouseover=function(){p.setTexture(p.hoverImage)},this.mouseout=function(){p.setTexture(p.defaultImage)});var f=function(){p.setTexture(p.defaultImage),p.doAction()};n.supportsTouch()?h?(this.touchstart=function(t){this.clickCanceled=!1,this.startPos=t.global.clone(),this.down=!0}.bind(this),this.touchmove=function(t){this.down&&(Math.abs(this.startPos.x-t.global.x)>this.moveThreshold||Math.abs(this.startPos.y-t.global.y)>this.moveThreshold)&&(this.clickCanceled=!0)}.bind(this),this.touchend=function(){this.clickCanceled||f(),this.clickCancelled=!1,this.down=!1}.bind(this)):this.touchstart=function(){f()}:(this.mousedown=function(t){this.clickCanceled=!1,this.startPos=t.global.clone(),this.down=!0}.bind(this),this.mousemove=function(t){this.down&&(Math.abs(this.startPos.x-t.global.x)>this.moveThreshold||Math.abs(this.startPos.y-t.global.y)>this.moveThreshold)&&(this.clickCanceled=!0)}.bind(this),this.mouseup=function(){this.clickCanceled||f(),this.clickCancelled=!1,this.down=!1}.bind(this))},s.prototype.doAction=function(){i.simulSoundSupport()&&i.playSound("button_click"),this.action&&this.action()},s.prototype.isActive=function(){return this.active},s.prototype.disable=function(t){t?this.setActive(!1):(this.active=!1,this.interactive=!1)},s.prototype.enable=function(){this.setActive(!0)},s.prototype.updateHover=function(t){this.defaultImage=t,this.hoverImage=o.brightness(this,.2)},s.prototype.setActive=function(t){this.active!==t&&(this.active=t,this.setTexture(t?this.defaultImage:this.disabledTexture),this.interactive=t)},s.prototype.getWidth=function(){return this.defaultImage.width},s.prototype.getHeight=function(){return this.defaultImage.height},s.prototype._createThreeSliceImage=function(t){return this.threeSlice=new r(t),this.threeSlice.generateTexture()},s.prototype.destroy=function(){this.threeSlice&&this.threeSlice.destroy()},s}),define("absolute/digitsprite",["pixi"],function(t){"use strict";var e=function(t){this.initDigitSprite(t)};return e.constructor=e,e.prototype=Object.create(t.Sprite.prototype),e.prototype.initDigitSprite=function(e){var i;for(this.textures=[],i=0;10>i;i+=1)this.textures.push(t.Texture.fromFrame(e+"_0"+i+".png"));this.textures.push(t.Texture.fromFrame(e+"_colon.png")),this.textures.push(t.Texture.fromFrame(e+"_comma.png")),this.index=0,t.Sprite.call(this,this.textures[0])},e.prototype.setDigit=function(t){var e=parseInt(t);this.index=e>=0&&10>e?e:":"===t?10:","===t?11:0,this.setTexture(this.textures[this.index])},e.prototype.getDigitWidth=function(){return this.width},e}),define("absolute/digitlabel",["pixi","absolute/digitsprite"],function(t,e){var i=function(t,e,i){this.initDigitLabel(t,e,i)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype.initDigitLabel=function(i,n,o){t.DisplayObjectContainer.call(this),o=o||"number_large",n=n||1,this.text="",this.numDigits=i||8,this.numCommas=Math.ceil(this.numDigits/3-1),this.numSprites=this.numDigits+this.numCommas,this.sprites=[];for(var r=0;r<this.numSprites;++r){var s=new e(o);s.scale.x=s.scale.y=n,this.sprites.push(s),this.addChild(s)}this.layout()},i.prototype.getText=function(){return this.text},i.prototype.setText=function(t){this.text=t,this.layout()},i.prototype.layout=function(){for(var t=0,e=0;e<this.sprites.length;e++)this.sprites[e].visible=!1;if(this.text.length>0)for(var i=0,n=this.text.length;n>i;++i)this.sprites[i].visible=!0,this.sprites[i].setDigit(this.text[i]),this.sprites[i].position.x=t,t+=this.sprites[i].getDigitWidth();this.width=t,this.height=this.sprites[0].height},i}),define("absolute/eventbus",[],function(){var t={events:{},addEventListener:function(t,e){void 0===this.events[t]&&(this.events[t]=[]),this.events[t].push(e)},removeEventListener:function(t,e){var i=this.events[t];if(i)for(var n=0,o=i.length;o>n;++n)if(e===i[n])return void i.splice(n,1)},dispatchEvent:function(t){var e=this.events[t];if(e)for(var i in e){var n=e[i];"function"==typeof n&&n(t)}}};return t}),define("absolute/analytics",[],function(){var t={init:function(t){this.useFlurry=!1,"undefined"!=typeof FlurryAgent&&(FlurryAgent.startSession(t.flurry.apiKey),this.useFlurry=!0)},setGameVersion:function(t){this.useFlurry&&FlurryAgent.setAppVersion(t)},logEvent:function(t,e,i){e=e||{},i=!!i,this.useFlurry&&FlurryAgent.logEvent(t,e,i)},endTimedEvent:function(t){this.useFlurry&&FlurryAgent.endTimedEvent(t)}};return t}),define("absolute/game",["absolute/storagemanager","absolute/gameconfig","absolute/analytics","absolute/debug"],function(t,e,i,n){var o=function(t,e){this._initGame(t,e)};return o.prototype._initGame=function(n,o){t.prefix=n+"_",e.load(o),i.init(o.config.analytics),i.setGameVersion(o.versionString),this.ui=null,this.config=o.config,this.initVisibilityChangeHandlers()},o.prototype.start=function(){},o.prototype.initVisibilityChangeHandlers=function(){"hidden"in document?document.addEventListener("visibilitychange",function(){n.log("visibilitychange"),this.handleVisibilityChange(document.hidden)}.bind(this),!1):"mozHidden"in document?document.addEventListener("mozvisibilitychange",function(){n.log("mozvisibilitychange"),this.handleVisibilityChange(document.mozHidden)}.bind(this),!1):"webkitHidden"in document?document.addEventListener("webkitvisibilitychange",function(){n.log("webkitvisibilitychange"),this.handleVisibilityChange(document.webkitHidden)}.bind(this),!1):"msHidden"in document?document.addEventListener("msvisibilitychange",function(){n.log("msvisibilitychange"),this.handleVisibilityChange(document.msHidden)}.bind(this),!1):"onpagehide"in window&&(window.addEventListener("pagehide",function(){n.log("pagehide"),this.handleVisibilityChange(!0)}.bind(this),!1),window.addEventListener("pageshow",function(){n.log("pageshow"),this.handleVisibilityChange(!1)}.bind(this),!1)),"onblur"in document&&(window.addEventListener("blur",function(){n.log("blur"),this.handleVisibilityChange(!0)}.bind(this),!1),window.addEventListener("focus",function(){n.log("focus"),this.handleVisibilityChange(!1)}.bind(this),!1),visHandled=!0),"onfocusout"in document&&(window.addEventListener("focusout",function(){n.log("onfocusout"),this.handleVisibilityChange(!0)}.bind(this),!1),window.addEventListener("focusin",function(){n.log("onfocusin"),this.handleVisibilityChange(!1)}.bind(this),!1))},o.prototype.handleVisibilityChange=function(){},o.prototype.load=function(t,e,i){this.ui.load(t,e,i)},o}),void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var TWEEN=TWEEN||function(){var t=[];return{REVISION:"14",getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},update:function(e){if(0===t.length)return!1;var i=0;for(e=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();i<t.length;)t[i].update(e)?i++:t.splice(i,1);return!0}}}();TWEEN.Tween=function(t){var e=t,i={},n={},o={},r=1e3,s=0,a=!1,h=!1,l=!1,u=0,c=null,d=TWEEN.Easing.Linear.None,p=TWEEN.Interpolation.Linear,f=[],g=null,m=!1,y=null,b=null,v=null;for(var x in t)i[x]=parseFloat(t[x],10);this.to=function(t,e){return void 0!==e&&(r=e),n=t,this},this.start=function(t){TWEEN.add(this),h=!0,m=!1,c=void 0!==t?t:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),c+=u;for(var r in n){if(n[r]instanceof Array){if(0===n[r].length)continue;n[r]=[e[r]].concat(n[r])}i[r]=e[r],i[r]instanceof Array==!1&&(i[r]*=1),o[r]=i[r]||0}return this},this.stop=function(){return h?(TWEEN.remove(this),h=!1,null!==v&&v.call(e),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var t=0,e=f.length;e>t;t++)f[t].stop()},this.delay=function(t){return u=t,this},this.repeat=function(t){return s=t,this},this.yoyo=function(t){return a=t,this},this.easing=function(t){return d=t,this},this.interpolation=function(t){return p=t,this},this.chain=function(){return f=arguments,this},this.onStart=function(t){return g=t,this},this.onUpdate=function(t){return y=t,this},this.onComplete=function(t){return b=t,this},this.onStop=function(t){return v=t,this},this.update=function(t){var h;if(c>t)return!0;m===!1&&(null!==g&&g.call(e),m=!0);var v=(t-c)/r;v=v>1?1:v;var x=d(v);for(h in n){var w=i[h]||0,C=n[h];C instanceof Array?e[h]=p(C,x):("string"==typeof C&&(C=w+parseFloat(C,10)),"number"==typeof C&&(e[h]=w+(C-w)*x))}if(null!==y&&y.call(e,x),1==v){if(s>0){isFinite(s)&&s--;for(h in o){if("string"==typeof n[h]&&(o[h]=o[h]+parseFloat(n[h],10)),a){var S=o[h];o[h]=n[h],n[h]=S}i[h]=o[h]}return a&&(l=!l),c=t+u,!0}null!==b&&b.call(e);for(var T=0,_=f.length;_>T;T++)f[T].start(t);return!1}return!0}},TWEEN.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)))},Out:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/n)+1)},InOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?-.5*i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n):i*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)*.5+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*t*t*((e+1)*t-e):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-TWEEN.Easing.Bounce.Out(1-t)},Out:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*TWEEN.Easing.Bounce.In(2*t):.5*TWEEN.Easing.Bounce.Out(2*t-1)+.5}}},TWEEN.Interpolation={Linear:function(t,e){var i=t.length-1,n=i*e,o=Math.floor(n),r=TWEEN.Interpolation.Utils.Linear;return 0>e?r(t[0],t[1],n):e>1?r(t[i],t[i-1],i-n):r(t[o],t[o+1>i?i:o+1],n-o)},Bezier:function(t,e){var i,n=0,o=t.length-1,r=Math.pow,s=TWEEN.Interpolation.Utils.Bernstein;for(i=0;o>=i;i++)n+=r(1-e,o-i)*r(e,i)*t[i]*s(o,i);return n},CatmullRom:function(t,e){var i=t.length-1,n=i*e,o=Math.floor(n),r=TWEEN.Interpolation.Utils.CatmullRom;return t[0]===t[i]?(0>e&&(o=Math.floor(n=i*(1+e))),r(t[(o-1+i)%i],t[o],t[(o+1)%i],t[(o+2)%i],n-o)):0>e?t[0]-(r(t[0],t[0],t[1],t[1],-n)-t[0]):e>1?t[i]-(r(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):r(t[o?o-1:0],t[o],t[o+1>i?i:o+1],t[o+2>i?i:o+2],n-o)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=TWEEN.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:function(){var t=[1];return function(e){var i,n=1;if(t[e])return t[e];for(i=e;i>1;i--)n*=i;return t[e]=n}}(),CatmullRom:function(t,e,i,n,o){var r=.5*(i-t),s=.5*(n-e),a=o*o,h=o*a;return(2*e-2*i+r+s)*h+(-3*e+3*i-2*r-s)*a+r*o+e}}},define("tween",function(t){return function(){var e;return e||t.TWEEN}}(this)),function(t,e){"use strict";function i(t){return document.createElement(t)}function n(t,e){for(var i in e)try{t.style[i]=e[i]}catch(n){}return t}function o(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function r(t,e){if("array"!==o(e))return-1;if(e.indexOf)return e.indexOf(t);for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1}function s(){var t=arguments;for(var e in t[1])if(t[1].hasOwnProperty(e))switch(o(t[1][e])){case"object":t[0][e]=s({},t[0][e],t[1][e]);break;case"array":t[0][e]=t[1][e].slice(0);break;default:t[0][e]=t[1][e]}return t.length>2?s.apply(null,[t[0]].concat(Array.prototype.slice.call(t,2))):t[0]}function a(t,e,i){var n,o,r,s,a,l,u,c,d;return s=.5>=i?i*(1+e):i+e-i*e,0===s?"#000":(a=2*i-s,l=(s-a)/s,t=6*t,u=Math.floor(t),c=t-u,d=s*l*c,0===u||6===u?(n=s,o=a+d,r=a):1===u?(n=s-d,o=s,r=a):2===u?(n=a,o=s,r=a+d):3===u?(n=a,o=s-d,r=s):4===u?(n=a+d,o=a,r=s):(n=s,o=a,r=s-d),"#"+h(n)+h(o)+h(r))}function h(t){return t=Math.round(255*t).toString(16),1===t.length?"0"+t:t}function l(t,e,i,n){t.addEventListener?t[n?"removeEventListener":"addEventListener"](e,i,!1):t.attachEvent&&t[n?"detachEvent":"attachEvent"]("on"+e,i)}function u(t,h){function y(){for(D=I.history;D--;)q[D]=0===D?F.fps:q[D-1],Y[D]=0===D?F.duration:Y[D-1]}function b(t,e,i,n){return M[0|t][Math.round(Math.min((e-i)/(n-i)*W,W))]}function v(){j.legend.fps!==z&&(j.legend.fps=z,j.legend[f]=z?"FPS":"ms"),P=z?F.fps:F.duration,j.count[f]=P>999?"999+":P.toFixed(P>99?0:I.decimals)}function x(){if(B=c(),X<B-I.threshold&&(F.fps-=F.fps/Math.max(1,60*I.smoothing/I.interval),F.duration=1e3/F.fps),y(),v(),I.heat){if(G.length)for(D=G.length;D--;)G[D].el.style[k[G[D].name].heatOn]=z?b(k[G[D].name].heatmap,F.fps,0,I.maxFps):b(k[G[D].name].heatmap,F.duration,I.threshold,0);if(j.graph&&k.column.heatOn)for(D=N.length;D--;)N[D].style[k.column.heatOn]=z?b(k.column.heatmap,q[D],0,I.maxFps):b(k.column.heatmap,Y[D],I.threshold,0)}if(j.graph)for(O=0;O<I.history;O++)N[O].style.height=(z?q[O]?Math.round(E/I.maxFps*Math.min(q[O],I.maxFps)):0:Y[O]?Math.round(E/I.threshold*Math.min(Y[O],I.threshold)):0)+"px"}function w(){I.interval<20?(L=p(w),x()):(L=setTimeout(w,I.interval),R=p(x))}function C(t){t=t||window.event,t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),F.toggle()}function S(){I.toggleOn&&l(j.container,I.toggleOn,C,1),t.removeChild(j.container)}function T(){if(k=u.theme[I.theme],M=k.compiledHeatmaps||[],!M.length&&k.heatmaps.length){for(O=0;O<k.heatmaps.length;O++)for(M[O]=[],D=0;W>=D;D++)M[O][D]=a(.33/W*D,k.heatmaps[O].saturation,k.heatmaps[O].lightness);k.compiledHeatmaps=M}}function _(){j.container&&S(),T(),j.container=n(i("div"),k.container),j.count=j.container.appendChild(n(i("div"),k.count)),j.legend=j.container.appendChild(n(i("div"),k.legend)),j.graph=I.graph?j.container.appendChild(n(i("div"),k.graph)):0,G.length=0;for(var e in j)j[e]&&k[e].heatOn&&G.push({name:e,el:j[e]});if(N.length=0,j.graph)for(j.graph.style.width=I.history*k.column.width+(I.history-1)*k.column.spacing+"px",D=0;D<I.history;D++)N[D]=j.graph.appendChild(n(i("div"),k.column)),N[D].style.position="absolute",N[D].style.bottom=0,N[D].style.right=D*k.column.width+D*k.column.spacing+"px",N[D].style.width=k.column.width+"px",N[D].style.height="0px";A(),v(),t.appendChild(j.container),j.graph&&(E=j.graph.clientHeight),I.toggleOn&&("click"===I.toggleOn&&(j.container.style.cursor="pointer"),l(j.container,I.toggleOn,C))}function A(){n(j.container,I)}"object"===o(t)&&t.nodeType===e&&(h=t,t=document.body),t||(t=document.body);var k,M,B,L,R,E,P,D,O,F=this,I=s({},u.defaults,h||{}),j={},N=[],W=100,G=[],U=0,V=I.threshold,H=0,X=c()-V,q=[],Y=[],z="fps"===I.show;F.options=I,F.fps=0,F.duration=0,F.isPaused=0,F.tickStart=function(){H=c()},F.tick=function(){B=c(),U=B-X,V+=(U-V)/I.smoothing,F.fps=1e3/V,F.duration=X>H?V:B-H,X=B},F.pause=function(){return L&&(F.isPaused=1,clearTimeout(L),d(L),d(R),L=R=0),F},F.resume=function(){return L||(F.isPaused=0,w()),F},F.set=function(t,e){return I[t]=e,z="fps"===I.show,-1!==r(t,g)&&_(),-1!==r(t,m)&&A(),F},F.showDuration=function(){return F.set("show","ms"),F},F.showFps=function(){return F.set("show","fps"),F},F.toggle=function(){return F.set("show",z?"ms":"fps"),F},F.hide=function(){return F.pause(),j.container.style.display="none",F},F.show=function(){return F.resume(),j.container.style.display="block",F},F.destroy=function(){F.pause(),S(),F.tick=F.tickStart=function(){}},function(){_(),w()}()}var c;!function(){var e=t.performance;if(e&&(e.now||e.webkitNow)){var i=e.now?"now":"webkitNow";c=e[i].bind(e)}else c=function(){return+new Date}}();var d=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,p=t.requestAnimationFrame;!function(){for(var e=["moz","webkit","o"],i=0,n=0,o=e.length;o>n&&!d;++n)d=t[e[n]+"CancelAnimationFrame"]||t[e[n]+"CancelRequestAnimationFrame"],p=d&&t[e[n]+"RequestAnimationFrame"];d||(p=function(e){var n=c(),o=Math.max(0,16-(n-i));return i=n+o,t.setTimeout(function(){e(n+o)},o)},d=function(t){clearTimeout(t)})}();var f="string"===o(document.createElement("div").textContent)?"textContent":"innerText";u.extend=s,window.FPSMeter=u,u.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var g=["toggleOn","theme","heat","graph","history"],m=["position","zIndex","left","top","right","bottom","margin"]}(window),function(t,e){"use strict";e.theme={};var i=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},i,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},i,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},i,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},i,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter),define("fpsmeter",function(t){return function(){var e;return e||t.FPSMeter}}(this)),define("absolute/gameui",["pixi","tween","absolute/debug","absolute/screenmetrics","absolute/platform","absolute/coords","fpsmeter","lodash"],function(t,e,i,n,o,r,s,a){var h=function(t,e,i,n,o,r,s,a){n=n||16777215,this._initGameUI(t,e,i,n,o,r,s,a)};return h.prototype._initGameUI=function(e,n,r,a,h,l,u,c){this.currentScreen=null,this.modal=null,this.lastRender=0,this.frameRequest=0,this.width=Math.round(n),this.height=Math.round(r),this.baseWidth=n,this.baseHeight=r,this.origWidth=this.width,this.origHeight=this.height,this.origBaseWidth=this.baseWidth,this.origBaseHeight=this.baseHeight,this.container=document.getElementById(e),this.stage=[],this.refreshBackground=!1,this.backGroundColor=a,this.supportsOrientationChange=!!h,this.supportsLiquidLayout=!!l,this.supportsWebGL=!!u&&o.supportsWebGL(),this.usingWebGL=!1,this.lockAspectRatio=!!c,this.DIALOG_LAYER=0,this.modalStack=[],this.modalBgStack=[],this.stage.push(new t.Stage(0,!0)),this.stage.push(new t.Stage(0,!0)),this.stage.push(new t.Stage(0,!0)),i.enabled&&(this.meter=new s),"undefined"!=typeof kik&&document.getElementsByTagName("body")[0].appendChild(document.createElement("div")),this.container.onmousedown=this.container.ontouchstart=function(t){t.preventDefault()},this.renderer=[],window.addEventListener("resize",this.resize.bind(this)),this.resize()},h.prototype.buildRenderers=function(e,i){if(o._isOldAndroid()&&(e=this.baseWidth,i=this.baseHeight),0===this.renderer.length)this.supportsWebGL?(this.renderer.push(t.autoDetectRenderer(e,i,null,!0)),this.renderer.push(t.autoDetectRenderer(e,i,null,!0)),this.renderer[1]instanceof t.WebGLRenderer&&(this.renderer.push(t.autoDetectRenderer(e,i,null,!0)),this.usingWebGL=!0,this.DIALOG_LAYER=2)):(this.renderer.push(new t.CanvasRenderer(e,i,null,!0)),this.renderer.push(new t.CanvasRenderer(e,i,null,!0))),this.offScreenRenderer=new t.CanvasRenderer(e,i,null,!0),this.container.appendChild(this.renderer[1].view),this.container.appendChild(this.renderer[0].view),this.usingWebGL&&(this.renderer[2].view.style.display="none",this.container.appendChild(this.renderer[2].view));else{for(var n=0;n<this.renderer.length;n+=1)this.renderer[n].resize(e,i);this.refreshBackground=!0}},h.prototype.isFullScreen=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement},h.prototype.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},h.prototype.resize=function(){function t(){!o._isiPad||this.isPortrait||o.isCordova()||(a-=r.y(30));var t=this.baseWidth/this.baseHeight;h>l?(l=h/t,l>a&&(h*=a/l,l=h/t)):(h=l*t,h>a&&(l*=s/h,h=l*t))}var e,i=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;
if(""===this.container.style.width||""===this.container.style.height||i){n.refresh();var s=n.clientWidth>0?n.clientWidth:n.screenWidth,a=n.clientWidth>0?n.clientHeight:n.screenHeight,h=s,l=a;this.portrait=this.supportsOrientationChange?l>h:this.width<this.height;var u=s/a;for(this.supportsLiquidLayout?this.supportsLiquidLayout&&(this.portrait?(this.width=Math.floor(1536*n.getResScale()),this.height=Math.floor(this.width*(a/s))):(o._isiPad&&!o.isCordova()&&(a-=r.y(18),l-=r.y(18)),this.height=Math.floor(1536*n.getResScale()),this.width=Math.floor(Math.floor(this.height*(s/a))))):(this.portrait?(this.supportsOrientationChange&&this.width>this.height&&(this.baseWidth=this.origBaseHeight,this.baseHeight=this.origBaseWidth,this.width=this.origHeight,this.height=this.origWidth),this.lockAspectRatio?t.call(this):u>.85?h=.85*a:.56>u&&(l=s/.56)):(o._isiPad&&!o.isCordova()&&(l-=r.y(18)),this.supportsOrientationChange&&this.height>this.width&&(this.baseWidth=this.origBaseWidth,this.baseHeight=this.origBaseHeight,this.width=this.origWidth,this.height=this.origHeight),u=1/u,this.lockAspectRatio?t.call(this):u>.8?l=.8*s:.56>u&&(h=a/.56)),h=Math.floor(h),l=Math.floor(l)),this.buildRenderers(this.width,this.height),this.clientWidth=h,e=0;e<this.renderer.length;e+=1)this.renderer[e].view.style.width=h+"px",this.renderer[e].view.style.height=l+"px",this.renderer[e].view.style.position="absolute",this.renderer[e].view.style.left=s>h?Math.round((s-h)/2)+"px":"0",this.renderer[e].view.style.top=a>l?Math.round((a-l)/2)+"px":"0";this.resetStage(),this.supportsOrientationChange&&this.currentScreen&&this.currentScreen.handleOrientationChange(this.portrait),this.refreshModal()}else{for(this.width=this.origWidth,this.height=this.origHeight,this.buildRenderers(this.width,this.height),e=0;e<this.renderer.length;e+=1)this.renderer[e].view.style.width=this.container.style.width,this.renderer[e].view.style.height=this.container.style.height,this.renderer[e].view.style.position="absolute",this.renderer[e].view.style.left="",this.renderer[e].view.style.top="";this.supportsOrientationChange&&this.currentScreen&&this.currentScreen.handleOrientationChange(this.portrait)}},h.prototype.refreshModal=function(){if(this.supportsOrientationChange&&this.modalStack.length>0){var t=this.modalStack[this.modalStack.length-1];this.hideModal(),"undefined"!=typeof t.handleOrientationChange&&t.handleOrientationChange(this.portrait),this.showModal(t)}},h.prototype.render=function(){this.renderer[0].render(this.stage[0])},h.prototype.renderOffScreen=function(){this.offScreenRenderer.render(this.stage[0])},h.prototype.animate=function(){var t=function(){Date.now()-this.lastRender>200&&(cancelAnimationFrame(this.frameRequest),this.frameRequest=requestAnimFrame(this._animate.bind(this))),setTimeout(t,100)}.bind(this);this.frameRequest&&cancelAnimationFrame(this.frameRequest),this.frameRequest=requestAnimFrame(this._animate.bind(this)),setTimeout(t,100)},h.prototype._animate=function(){i.enabled&&this.meter.tick(),this.beforeRender(),e.update(),this.renderer[0].render(this.stage[0]),this.refreshBackground&&(this.refreshBackground=!1,this.renderer[1].render(this.stage[1])),this.hasModal()&&this.renderer.length>2&&this.renderer[2].render(this.stage[2]),this.afterRender(),this.lastRender=Date.now(),this.frameRequest=requestAnimFrame(this._animate.bind(this))},h.prototype.beforeRender=function(){},h.prototype.afterRender=function(){},h.prototype.showScreen=function(t){this.currentScreen&&this.currentScreen.onHide(),this.currentScreen=t,this.hideCurrent(),this.showCurrent(),this.currentScreen.onShow(this.portrait),this.showActiveAtlases()},h.prototype.showModal=function(t,e){e="undefined"==typeof e?.5:e,0===this.modalStack.length?this.usingWebGL?(this.modalOverlay=this.buildModalOverlay(e),this.stage[0].addChildAt(this.modalOverlay,this.stage[0].children.indexOf(this.currentScreen)+1),this.renderer[2].view.style.display="block"):(this.modalBG=this.buildModalBackground(e),this.stage[0].removeChild(this.currentScreen),this.stage[0].addChildAt(this.modalBG,0)):this.stage[this.DIALOG_LAYER].removeChild(this.modalStack[this.modalStack.length-1]),this.modalStack.push(t),this.stage[this.DIALOG_LAYER].addChild(t),t.onShow(),this.showActiveAtlases()},h.prototype.hasModal=function(){return this.modalStack.length>0},h.prototype.hideModal=function(){if(this.modalStack.length>0){var t=this.modalStack.pop();t.onHide(),this.stage[this.DIALOG_LAYER].removeChild(t);var e=this.modalStack.length;0===e?this.usingWebGL?(this.stage[0].removeChild(this.modalOverlay),this.renderer[2].view.style.display="none"):(this.stage[0].removeChild(this.modalBG),this.modalBG.texture.destroy(!0),this.modalBG=null,this.stage[0].addChildAt(this.currentScreen,0)):(this.stage[this.DIALOG_LAYER].addChild(this.modalStack[e-1]),this.refreshModal())}},h.prototype.hideCurrent=function(){if(this.stage[0].children.length>0){var t=this.stage[0].getChildAt(0);this.stage[0].removeChild(t)}if(this.stage[1].children.length>0){var e=this.stage[1].getChildAt(0);this.stage[1].removeChild(e)}},h.prototype.buildModalOverlay=function(e){var i=new t.DisplayObjectContainer,n=new t.Graphics;return n.beginFill(65793,e),n.drawRect(0,0,this.width,this.height),n.endFill(),i.addChild(n),i},h.prototype.buildModalBackground=function(e){var i,n=.5,o=Math.ceil(this.width*n),r=Math.ceil(this.height*n),s=new t.CanvasRenderer(o,r,null,!0),a=new t.Graphics;return s.clearBeforeRender=!1,s.roundPixels=!0,a.beginFill(0,e),a.drawRect(0,0,o,r),a.endFill(),this.stage[0].addChild(a),this.currentScreen.scale.x=this.currentScreen.scale.y=n,s.render(this.stage[0]),this.currentScreen.scale.x=this.currentScreen.scale.y=1,this.stage[0].removeChild(a),i=new t.Sprite(t.Texture.fromCanvas(s.view)),i.scale.x=i.scale.y=1/n,i},h.prototype.showCurrent=function(){if(this.currentScreen)try{this.stage[0].addChildAt(this.currentScreen,0),this.stage[1].addChildAt(this.currentScreen.background,0),this.renderer[1].render(this.stage[1]),this.refreshBackground=!0}catch(t){}},h.prototype.resetStage=function(e){if(e="undefined"!==e?e:500,0==this.stage[1].children.length)return!1;for(var i=0;i<this.stage[1].children.length;i++)this.stage[1].removeChildAt(i);if(this.stage[0].children.length>0){var n=this.stage[0].getChildAt(0);n.visible=!1}var o=new t.Graphics;o.beginFill(this.backGroundColor,1),o.drawRect(0,0,this.width,this.height),o.endFill(),this.stage[1].addChildAt(o,0),this.renderer[1].render(this.stage[1]),window.setTimeout(function(){if(this.stage[1].removeChildAt(0),this.stage[0].children.length>0){var t=this.stage[0].getChildAt(0);t.visible=!0}this.currentScreen&&this.currentScreen.background&&(this.stage[1].addChild(this.currentScreen.background),this.renderer[1].render(this.stage[1]))}.bind(this),e)},h.prototype.showActiveAtlases=function(){if(i.enabled){var e={};this.walkSprites(this.stage[0],function(i){if(i instanceof t.Sprite&&i.texture&&i.texture.baseTexture){var n=i.texture.baseTexture.source.src||"/offscreen";e[n]=(e[n]||0)+1}}),i.log("Active Atlases");for(var n in e)if(e.hasOwnProperty(n)){var o=n.substr(n.lastIndexOf("/")+1);i.log(o+" has "+e[n]+" sprites active")}i.log("There are "+a.size(t.BaseTextureCache)+" textures in the PIXI.BaseTextureCache.")}},h.prototype.walkSprites=function(t,e){e(t);for(var i=0;i<t.children.length;i+=1)this.walkSprites(t.children[i],e)},h}),define("absolute/textutils",[],function(){var t={_thousandsSep:",",formatInt:function(t){return t>999?this.formatInt(Math.floor(t/1e3))+this._thousandsSep+this.zeroPad(t%1e3):t+""},zeroPad:function(t){var e="";return 100>t&&(e+="0"),10>t&&(e+="0"),e+=t}};return t}),define("absolute/togglebutton",["pixi","absolute/button"],function(t,e){var i=function(t,e,i,n){this.initToggleButton(t,e,i,n)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype.initToggleButton=function(i,n,o,r){this.enabled=!!o,this.action=n,r="undefined"!=typeof r?r:!0;var s=r?"button_overlay.png":i+"_1.png",a=r?"button_overlay.png":i+"OFF_1.png";t.DisplayObjectContainer.call(this),this.enabledButton=new e(t.Texture.fromFrame(i+"_1.png"),t.Texture.fromFrame(s),this.onAction.bind(this)),this.disabledButton=new e(t.Texture.fromFrame(i+"OFF_1.png"),t.Texture.fromFrame(a),this.onAction.bind(this)),this.addChild(this.enabled?this.enabledButton:this.disabledButton),this.width=t.Texture.fromFrame(i+"_1.png").width,this.height=t.Texture.fromFrame(i+"_1.png").height},i.prototype.onAction=function(){this.setEnabled(!this.enabled),this.action&&this.action()},i.prototype.setEnabled=function(t){t!==this.enabled&&(this.enabled=t,this.enabled?(this.removeChild(this.disabledButton),this.addChild(this.enabledButton)):(this.removeChild(this.enabledButton),this.addChild(this.disabledButton)))},i}),define("absolute/musicmanager",["absolute/gameconfig","absolute/audiomanager","absoluteaudio"],function(t,e,i){var n={currentTrack:null,isMuted:function(){return!t.getVal("musicEnabled")},playMusic:function(t){t!==this.currentTrack&&(this.currentTrack&&e.stopSound(this.currentTrack),this.currentTrack=t,this.isMuted()?e.muteSound(this.currentTrack):e.unmuteSound(this.currentTrack),(e.simulSoundSupport()||!e.isSfxEnabled())&&(i.context.usingWebAudio()||i.context.usingSoundManagerAudio()?e.playSound(this.currentTrack):window.setTimeout(function(){e.playSound(this.currentTrack)}.bind(this),500)))},stopMusic:function(){e.stopSound(this.currentTrack),this.currentTrack=null},setMuted:function(i,n){var o=!!n;if(!o){if(i===this.isMuted())return;t.setVal("musicEnabled",!i)}this.currentTrack&&(i?e.muteSound(this.currentTrack):e.unmuteSound(this.currentTrack))}};return n}),define("absolute/tweenutils",["tween"],function(t){var e={fadeIn:function(t,i,n){this._doTween(t,i,n,e._fadeIn)},_fadeIn:function(e,i,n){"undefined"==typeof i.delay&&(i.delay=0),new t.Tween({alpha:e.alpha}).delay(i.delay).to({alpha:1},i.duration).easing(t.Easing.Cubic.In).onUpdate(function(){e.alpha=this.alpha}).onComplete(function(){n()}).start()},fadeOut:function(t,i,n){this._doTween(t,i,n,e._fadeOut)},_fadeOut:function(e,i,n){"undefined"==typeof i.delay&&(i.delay=0),new t.Tween({alpha:e.alpha}).delay(i.delay).to({alpha:0},i.duration).easing(t.Easing.Cubic.In).onUpdate(function(){e.alpha=this.alpha}).onComplete(function(){n()}).start()},bounceIn:function(t,i,n){this._doTween(t,i,n,e._bounceIn)},_bounceIn:function(e,i,n){void 0===i.endScale&&(i.endScale=1),new t.Tween({scale:e.scale.x}).to({scale:i.endScale},i.duration).easing(t.Easing.Elastic.Out).onUpdate(function(){e.scale.x=e.scale.y=this.scale}).onComplete(function(){n()}).start()},_doTween:function(t,e,i,n){var o,r,s=0,a=function(){s+=1,s===r&&i&&"function"==typeof i&&i()};if(t instanceof Array)for(r=t.length,o=0;r>o;o+=1)n(t[o],e,a);else n(t,e,function(){i&&"function"==typeof i&&i()})}};return e}),define("absolute/progressbar",["pixi","absolute/coords","absolute/tweenutils"],function(t,e){var i=function(t,e,i,n,o){this._initProgressBar(t,e,i,n,o)};return i.constructor=i,i.prototype=Object.create(t.Sprite.prototype),i.prototype._initProgressBar=function(e,i,n,o){t.Sprite.call(this,e),this.fillSprite=new t.Sprite(i),this.previousWidth=0,this.start=n?n:0,this.end=o?o:this.fillSprite.texture.frame.width,this.fillMask=new t.Graphics,this.fillMask.beginFill(0,0),this.fillMask.drawRect(this.start,0,0,this.height),this.fillMask.endFill(),this.addChild(this.fillMask),this.fillSprite.mask=this.fillMask,this.addChild(this.fillSprite)},i.prototype.setProgress=function(t,e,i,n){0>t?t=0:t>1&&(t=1),n=n||500;var o=(this.end-this.start)*t;if(e){var r=this;new TWEEN.Tween({width:this.previousWidth}).to({width:o},n).easing(TWEEN.Easing.Quadratic.Out).onUpdate(function(){r.fillMask.clear(),r.fillMask.beginFill(0,0),r.fillMask.drawRect(r.start,0,this.width,r.height),r.fillMask.endFill(),r.previousWidth=this.width}).onComplete(function(){"function"==typeof i&&i()}).start()}else this.fillMask.clear(),this.fillMask.beginFill(0,0),this.fillMask.drawRect(this.start,0,o,this.height),this.fillMask.endFill();this.waitContainer&&(this.waitContainer.mask=null,this.removeChild(this.waitContainer),this.waitContainer=null)},i.prototype.showWaiting=function(i){if(this.waitImage=i,this.waitImage){this.setProgress(100),this.waitContainer=new t.DisplayObjectContainer,this.waitSprites=[];for(var n=0;11>n;n+=1)this.waitSprites.push(new t.Sprite(this.waitImage)),this.waitSprites[n].position.x=n*this.waitSprites[n].width,this.waitContainer.addChild(this.waitSprites[n]);this.addChild(this.waitContainer);var o=new t.Graphics;o.beginFill(),o.drawRect(e.x(50),0,this.width-e.x(100),this.height),o.endFill(),this.waitContainer.addChild(o),this.waitContainer.mask=o}},i.prototype.updateWaiting=function(){for(var t=0;11>t;t+=1)this.waitSprites[t].position.x+=e.x(4);this.waitSprites[10].position.x>this.width&&(this.waitSprites[10].position.x=this.waitSprites[0].position.x-this.waitSprites[10].width,this.waitSprites.unshift(this.waitSprites.pop()))},i}),define("absolute/progressdial",["pixi"],function(t){var e=function(t,e){this._initProgressDial(t,e)};return e.constructor=e,e.prototype=Object.create(t.Sprite.prototype),e.prototype._initProgressDial=function(e,i){t.Sprite.call(this,e),this.fillSprite=new t.Sprite(i),this.previousRotation=-180*Math.PI/180,this.fillMask=new t.Graphics,this.fillMask.beginFill(0,0),this.fillMask.drawRect(1.1*-this.fillSprite.width/2,1.1*-this.fillSprite.height,1.1*this.fillSprite.width,1.1*this.fillSprite.height),this.fillMask.position.x=this.fillSprite.width/2,this.fillMask.position.y=this.fillSprite.height,this.fillMask.endFill(),this.addChild(this.fillMask),this.fillSprite.mask=this.fillMask,this.addChild(this.fillSprite)},e.prototype.setProgress=function(t,e,i){0>t?t=0:t>1&&(t=1);var n=(-180+180*t)*Math.PI/180;if(e){var o=this;new TWEEN.Tween({rotation:this.previousRotation}).to({rotation:n},500).easing(TWEEN.Easing.Quadratic.Out).onUpdate(function(){o.fillMask.rotation=this.rotation,o.previousRotation=this.rotation}).onComplete(function(){"function"==typeof i&&i()}).start()}else this.fillMask.rotation=n},e}),define("absolute/screen",["pixi","absolute/button","absolute/togglebutton","absolute/debug"],function(t,e,i,n){var o=function(){this._initScreen()};return o.constructor=o,o.prototype=Object.create(t.DisplayObjectContainer.prototype),o.prototype._initScreen=function(){t.DisplayObjectContainer.call(this),this.background=new t.DisplayObjectContainer},o.prototype.addButton=function(i,o,r,s,a){var h,l=!!a,u=t.Texture.fromFrame(i+"_1.png");h=t.Texture.fromFrame(l?"button_small_overlay.png":"button_overlay.png");var c=new e(u,h,function(){n.log(i+" pressed!"),s()});return c.position.x=o,c.position.y=r,this.addChild(c),c},o.prototype.addToggleButton=function(t,e,o,r,s){var a=new i(t,function(){n.log(t+" pressed!"),r()},s);return a.position.x=e,a.position.y=o,this.addChild(a),a},o.prototype.onShow=function(){},o.prototype.onHide=function(){},o.prototype.beforeRender=function(){},o.prototype.afterRender=function(){},o.prototype.handleVisibilityChange=function(){},o.prototype.handleOrientationChange=function(){},o}),define("absolute/simplemessagebox",["pixi","absolute/button","absolute/coords"],function(t,e,i){var n=function(t,e,i){this._initSimpleMessageBox(t,e,i)};return n.constructor=n,n.prototype=Object.create(t.DisplayObjectContainer.prototype),n.prototype._initSimpleMessageBox=function(e,i,n){t.DisplayObjectContainer.call(this),this.width=e,this.height=i,this.textStyle=n,this.textStyle.wordWrapWidth=e-60,this.textStyle.wordWrap=!0;var o=new t.Graphics;o.lineStyle(8,0,1),o.beginFill(16777215,1),o.drawRect(0,0,e,i),o.endFill(),this.addChild(o),this.text=null},n.prototype.setText=function(e){this.text&&this.removeChild(this.text),this.text=new t.Text(e,this.textStyle),this.text.position.x=(this.width-this.text.width)/2,this.text.position.y=i.y(30),this.addChild(this.text)},n}),define("absolute/spritemessagebox",["pixi","absolute/button","absolute/coords"],function(t,e,i){var n=function(t,e,i){this._initSpriteMessageBox(t,e,i)};return n.constructor=n,n.prototype=Object.create(t.Sprite.prototype),n.prototype._initSpriteMessageBox=function(i,n,o){t.Sprite.call(this,t.Texture.fromFrame(i)),this.action=null,this.buttonText=null,this.button=new e(t.Texture.fromFrame(n),t.Texture.fromFrame(n),function(){this.action&&"function"==typeof this.action&&this.action()}.bind(this)),this.button.position.x=(this.width-this.button.width)/2,this.button.position.y=this.height-this.button.height/2,this.addChild(this.button),this.textStyle=o,this.textStyle.wordWrapWidth=this.width-40,this.text=null},n.prototype.setText=function(e){this.text&&this.removeChild(this.text),this.text=new t.Text(e,this.textStyle),this.text.position.x=(this.width-this.text.width)/2,this.text.position.y=i.y(30),this.addChild(this.text)},n.prototype.setButtonTextAndAction=function(e,i){this.button&&(this.buttonText&&this.button.removeChild(this.buttonText),this.buttonText=new t.Text(e,this.textStyle),this.buttonText.position.x=(this.button.width-this.buttonText.width)/2,this.buttonText.position.y=this.button.height/4,this.button.addChild(this.buttonText),this.action=i)},n}),define("absolute/loader",["pixi","absolute/platform","absolute/audiomanager","absolute/asyncqueue","absolute/screenmetrics"],function(t,e,i,n,o){"use strict";var r=function(){this._initLoader()};return r.prototype._initLoader=function(){},r.prototype.loadSound=function(t,e,n){i.init(function(){i.loadSounds(t,e,n)})},r.prototype.loadArt=function(i,n,r){for(var s=i.length,a=[],h=0;s>h;++h){var l=i[h],u="image",c="undefined"!=typeof l.lazyload?l.lazyload:!1;c||("string"!=typeof l&&(l.type&&(u=l.type),l=l.name),"image"===u?-1===l.indexOf(".json")&&(l+=".json"):"font"===u&&-1===l.indexOf(".fnt")&&(l+=".fnt"),a.push(e.artPathPrefix+"/"+o.getResClass()+"/"+l))}this.assetLoader=new t.AssetLoader(a),this.assetLoader.addEventListener("onComplete",function(){r()}),this.assetLoader.addEventListener("onProgress",function(t){n(1-t.content.loadCount/s)}),this.assetLoader.load()},r.prototype.loadAssets=function(t,e,i){var o=new n;o.pushTasks([function(e,i){this.loadArt(t.artAssets,e,i)}.bind(this),function(e,i){this.loadSound(t.audioAssets,e,i)}.bind(this)]),o.run(e,i)},r}),define("absolute/layouthelper",["absolute/coords"],function(t){var e=null;return{setLayoutMap:function(t){e=t},layout:function(i,n,o){if("undefined"!=typeof e[n]&&"undefined"!=typeof e[n][o]){var r=e[n][o].x||0,s=e[n][o].y||0;i.position.x=t.x(r),i.position.y=t.y(s)}}}}),define("absolute/draggable",["pixi","absolute/platform"],function(t,e){var i=function(t,e,i,n,o,r){this._initDraggable(t,e,i,n,o,r)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype._initDraggable=function(i,n,o,r,s,a){t.DisplayObjectContainer.call(this),this.addChild(i),this.child=i,this.positionChild="undefined"!=typeof a?a:!1,this.limit=n||new t.Rectangle(0,0,0,0),this.onGrab=o,this.onMove=r,this.onDrop=s,this.interactive=!0,this.data=null,this.dragging=!1,e.supportsTouch()?(this.touchstart=this._onGrab,this.touchend=this.touchendoutside=this._onDrop,this.touchmove=this._onMove):(this.mousedown=this._onGrab,this.mouseup=this.mouseupoutside=this._onDrop,this.mousemove=this._onMove)},i.prototype._onGrab=function(t,e){t.originalEvent.preventDefault(),e="undefined"!=typeof e?e:.8,this.data=t,this.alpha=e,this.dragging=!0,"function"==typeof this.onGrab&&this.onGrab(this)},i.prototype._onDrop=function(t){t.originalEvent.preventDefault(),this.alpha=1,this.dragging=!1,this.data=null,"function"==typeof this.onDrop&&this.onDrop(this)},i.prototype._onMove=function(t){if(t.originalEvent.preventDefault(),this.dragging){var e=this.data.getLocalPosition(this.parent);if(this.limit&&e.x>this.limit.x&&e.x<this.limit.x+this.limit.width&&e.y>this.limit.y&&e.y<this.limit.y+this.limit.height){var i=this.positionChild?this.child:this;i.position.x=Math.round(e.x),i.position.y=Math.round(e.y)}"function"==typeof this.onMove&&this.onMove(this)}},i}),define("text!absolute/ui/assetmap.json",[],function(){return'{\n    "loading_bar_frame": "loading_bar_frame.png",\n    "loading_bar_marker": "loading_bar_marker.png",\n    \n    "dialogNineSlice": {\n        "topLeft":"MDS_9slice_modal_01.png",\n        "topCenter":"MDS_9slice_modal_02.png",\n        "topRight":"MDS_9slice_modal_03.png",\n        "topRight_closeBackground":"MDS_9slice_modal_03.png",\n        "middleLeft":"MDS_9slice_modal_04.png",\n        "middleCenter":"MDS_9slice_modal_05.png",\n        "middleRight":"MDS_9slice_modal_06.png",\n        "bottomLeft":"MDS_9slice_modal_07.png",\n        "bottomCenter":"MDS_9slice_modal_08.png",\n        "bottomRight":"MDS_9slice_modal_09.png",\n        "close": "btn_level_exit.png"\n    }\n}'}),define("absolute/assetmap",["lodash","text!absolute/ui/assetmap.json"],function(t,e){function i(t){for(var e=0,i=t.split("."),o=n;o&&"object"==typeof o;)o=o[i[e++]];return o}var n=JSON.parse(e),o=function(t){return i(t)||t};return o.load=function(e){var i=JSON.parse(e);t.merge(n,i)},o}),define("text!absolute/ui/strings.json",[],function(){return"{\n\n}"}),define("absolute/stringmanager",["lodash","text!absolute/ui/strings.json"],function(t,e){function i(t,e){for(var i=0,o=t.split("."),r=n[e];r&&"object"==typeof r;)r=r[o[i++]];return r}var n=JSON.parse(e),o="en",r=function(t,e){var n=i(t,o)||i(t,"en");if(n&&"string"==typeof n&&""!==n&&e&&e.length>0)for(var r=0;r<e.length;r+=1)n=n.replace("%"+r,String(e[r]));return n||t};return r.setLocale=function(t){o=t},r.load=function(e){var i=JSON.parse(e);t.merge(n,i)},r}),define("absolute/nineslice",["pixi","absolute/screen","absolute/debug","lodash"],function(t,e,i,n){var o=function(t){var e={width:"100",height:"100",images:{topLeft:"MDS_9slice_modal_01.png",topCenter:"MDS_9slice_modal_02.png",topRight:"MDS_9slice_modal_03.png",middleLeft:"MDS_9slice_modal_04.png",middleCenter:"MDS_9slice_modal_05.png",middleRight:"MDS_9slice_modal_06.png",bottomLeft:"MDS_9slice_modal_07.png",bottomCenter:"MDS_9slice_modal_08.png",bottomRight:"MDS_9slice_modal_09.png"}};this._initNineSlice(n.extend(e,t))};return o.prototype=Object.create(t.DisplayObjectContainer.prototype),o.prototype._initNineSlice=function(e){t.DisplayObjectContainer.call(this),this.options=e,this.cachedContent=this.options.content,this._setSize(),this._createBackground()},o.prototype._setSize=function(){this.width=this.options.width,this.height=this.options.height},o.prototype._createBackground=function(){this.container=new t.DisplayObjectContainer;var e=t.Sprite.fromFrame(this.options.images.topLeft);e.position.x=0,e.position.y=0;var i=t.Sprite.fromFrame(this.options.images.topRight);i.position.x=this.width-i.width,i.position.y=0;var n=t.Sprite.fromFrame(this.options.images.bottomLeft);n.position.x=0,n.position.y=this.height-n.height;var o=t.Sprite.fromFrame(this.options.images.bottomRight);o.position.x=this.width-o.width,o.position.y=this.height-o.height;var r=t.Texture.fromFrame(this.options.images.middleLeft);this.middleLeftTile=new t.TilingSprite(r,r.width,this.height-e.height-n.height),this.middleLeftTile.position.x=0,this.middleLeftTile.position.y=e.height;var s=t.Texture.fromFrame(this.options.images.middleRight);this.middleRightTile=new t.TilingSprite(s,s.width,this.height-e.height-n.height),this.middleRightTile.position.x=this.width-i.width,this.middleRightTile.position.y=i.height;var a=t.Texture.fromFrame(this.options.images.topCenter);this.topCenterTile=new t.TilingSprite(a,this.width-e.width-i.width,a.height),this.topCenterTile.position.x=e.width,this.topCenterTile.position.y=0;var h=t.Texture.fromFrame(this.options.images.bottomCenter);this.bottomCenterTile=new t.TilingSprite(h,this.width-n.width-o.width,h.height),this.bottomCenterTile.position.x=n.width,this.bottomCenterTile.position.y=this.height-n.height;var l=t.Texture.fromFrame(this.options.images.middleCenter);this.middleCenterTile=new t.TilingSprite(l,this.width-e.width-i.width,Math.ceil(this.height-o.height-i.height)),this.middleCenterTile.position.x=e.width,this.middleCenterTile.position.y=e.height,this.container.addChild(e),this.container.addChild(this.topCenterTile),this.container.addChild(i),this.container.addChild(this.middleLeftTile),this.container.addChild(this.middleCenterTile),this.container.addChild(this.middleRightTile),this.container.addChild(n),this.container.addChild(this.bottomCenterTile),this.container.addChild(o),this.addChild(this.container),this.container.cacheAsBitmap=!0},o.prototype.destroy=function(){this.topCenterTile.tilingTexture.destroy(!0),this.middleLeftTile.tilingTexture.destroy(!0),this.middleCenterTile.tilingTexture.destroy(!0),this.middleRightTile.tilingTexture.destroy(!0),this.bottomCenterTile.tilingTexture.destroy(!0)},o}),define("absolute/animatedbutton",["pixi","absolute/button","lodash","absolute/screenmetrics","absolute/platform"],function(t,e,i,n,o){var r=function(t,e,i,n,o,r){this._initAnimatedButton(t,e,i,n,o,r)};return r.constructor=r,r.prototype=Object.create(e.prototype),r.prototype._initAnimatedButton=function(t,i,n,r,s,a){e.call(this,t,i,n,r,s,a),o.supportsTouch()||(this.mouseover=function(){this.setTexture(this.hoverImage),this.defaultY=this.position.y,this.position.y=this.defaultY+2},this.mouseout=function(){this.setTexture(this.defaultImage),this.position.y=this.defaultY})},r}),define("absolute/textbutton",["pixi","absolute/button","absolute/threeslice","lodash","absolute/screenmetrics"],function(t,e,i,n,o){var r=function(t,e,i,r,s,a,h){var l={text:"",textStyle:{font:Math.floor(90*o.getResScale())+"px Ganache",align:"center"},useBitmapFont:!0},u=a||l;this._initTextButton(t,e,i,r,s,n.extend(l,u),h)};return r.constructor=r,r.prototype=Object.create(e.prototype),r.prototype._initTextButton=function(t,i,n,o,r,s,a){this.textStyleOptions=s,e.call(this,t,i,n,o,r,a),this.setText(this.textStyleOptions.text)},r.prototype.setText=function(e){if(this.labelContainer&&this.removeChild(this.labelContainer),this.labelContainer=new t.DisplayObjectContainer,this.textStyleOptions.useBitmapFont){var i=new t.BitmapText(e,this.textStyleOptions);this.label=new t.Sprite(i.generateTexture())}else this.label=new t.Text(e,this.textStyleOptions);this.labelContainer.width=this.label.width,this.labelContainer.height=this.label.height,this.labelContainer.pivot.x=this.labelContainer.width/2,this.labelContainer.pivot.y=this.labelContainer.height/2,this.labelContainer.x=this.width/2,this.labelContainer.y=this.height/2,"undefined"!=typeof this.textStyleOptions.position&&("number"==typeof this.textStyleOptions.position.x&&(this.labelContainer.x=this.textStyleOptions.position.x),"number"==typeof this.textStyleOptions.position.y&&(this.labelContainer.y=this.textStyleOptions.position.y)),this.labelContainer.addChild(this.label),this.addChild(this.labelContainer)},r.prototype.destroy=function(){"function"==typeof this.label.destroy&&this.label.destroy(!0),e.prototype.destroy.call(this)},r}),define("absolute/animatedtextbutton",["pixi","absolute/textbutton","lodash","absolute/platform"],function(t,e,i,n){var o=function(t,e,i,n,o,r,s){this._initAnimatedTextButton(t,e,i,n,o,r,s)};return o.constructor=o,o.prototype=Object.create(e.prototype),o.prototype._initAnimatedTextButton=function(t,i,o,r,s,a,h){e.call(this,t,i,o,r,s,a,h),n.supportsTouch()||(this.mouseover=function(){this.setTexture(this.hoverImage),this.defaultY=this.position.y,this.position.y=this.defaultY+2},this.mouseout=function(){this.setTexture(this.defaultImage),this.position.y=this.defaultY})},o}),define("text!absolute/ui/layout.json",[],function(){return"{\n\n}"}),define("absolute/uibuilder",["pixi","lodash","absolute/assetmap","absolute/stringmanager","absolute/coords","absolute/screenmetrics","absolute/progressbar","absolute/nineslice","absolute/animatedbutton","absolute/animatedtextbutton","absolute/togglebutton","text!absolute/ui/layout.json"],function(t,e,i,n,o,r,s,a,h,l,u,c){var d=JSON.parse(c);return{load:function(t){try{var i=JSON.parse(t);e.extend(d,i)}catch(n){throw alert("UIBuilder: error in layout.json"),n}},findWidget:function(t,e){var i=null;for(var n in e.widgets)if(e.widgets.hasOwnProperty(n)&&(i=n==t?e.widgets[n]:this.findWidget(t,e.widgets[n])),i)return i;return null},getConfigData:function(t){return d[t]},buildLayout:function(e,c,p){var f=null,g=this;switch("string"==typeof e&&(e=d[e]),e.type){case"ProgressBar":this.checkParams({frame:"string",fill:"string"},e.params),f=new s(t.Texture.fromFrame(i(e.params.frame)),t.Texture.fromFrame(i(e.params.fill)));break;case"Text":this.checkParams({text:"string",fontSize:"number",fontFamily:"string",fill:"string",align:"string"},e.params);var m=e.params.fontWeight||"normal",y=e.params.wordWrap||"false",b=o.x(e.params.wordWrapWidth)||"0";f=new t.Text(n(e.params.text),{font:m+" "+Math.floor(e.params.fontSize*r.getResScale())+"px "+e.params.fontFamily,fill:e.params.fill,align:e.params.align,wordWrap:y,wordWrapWidth:b}),f._setText=f.setText,f.setText=function(t){this._setText(t),this.updateText(),g.positionWidget(this,e,this.parent)};break;case"BitmapText":var v="0xFFFFFF";this.checkParams({text:"string",fontSize:"number",fontFamily:"string"},e.params),e.params.tint&&(v=e.params.tint),f=new t.BitmapText(n(e.params.text),{font:Math.floor(e.params.fontSize*r.getResScale())+"px "+e.params.fontFamily,tint:v}),f.width=f.textWidth,f.height=f.textHeight,f.tint=parseInt(v,16),f._setText=f.setText,f.setText=function(t){this._setText(t),this.updateText(),f.width=f.textWidth,f.height=f.textHeight,g.positionWidget(this,e,this.parent)};break;case"Sprite":this.checkParams({texture:"string"},e.params);var x=1,w=1;e.params.scale&&(x=e.params.scale.x,w=e.params.scale.y);try{f=t.Sprite.fromFrame(i(e.params.texture)),f.scale.x=x,f.scale.y=w}catch(C){alert(C)}break;case"Container":f=new t.DisplayObjectContainer,e.params?(f.width=o.x(e.params.width)||c.width,f.height=o.y(e.params.height)||c.height):(f.width=c.width,f.height=c.height);break;case"NineSlice":this.checkParams({width:"number",height:"number",imageBase:"string"},e.params);var S={width:o.x(e.params.width),height:o.y(e.params.height),images:{topLeft:i(e.params.imageBase+".topLeft"),topCenter:i(e.params.imageBase+".topCenter"),topRight:i(e.params.imageBase+".topRight"),middleLeft:i(e.params.imageBase+".middleLeft"),middleCenter:i(e.params.imageBase+".middleCenter"),middleRight:i(e.params.imageBase+".middleRight"),bottomLeft:i(e.params.imageBase+".bottomLeft"),bottomCenter:i(e.params.imageBase+".bottomCenter"),bottomRight:i(e.params.imageBase+".bottomRight")}};f=new a(S);break;case"AnimatedButton":this.checkParams({action:"string"},e.params);var T=e.params.threeSlice||null;T&&this.checkParams({width:"number",height:"number",imageBase:"string"},e.params.threeSlice);var _=e.params.defaultTexture&&"string"==typeof e.params.defaultTexture?e.params.defaultTexture:null,A=e.params.hoverTexture&&"string"==typeof e.params.hoverTexture?e.params.hoverTexture:null,k=null!==_?t.Texture.fromFrame(i(_)):null,M=null!==A?t.Texture.fromFrame(i(A)):null,B=p&&p[e.params.action]&&p[e.params.action].bind(p)||null,L=e.params.replaceOnHover||null,R=e.params.replaceOnHover||null,E=null;T&&(E={width:o.x(e.params.threeSlice.width),height:o.y(e.params.threeSlice.height),images:{left:i(e.params.threeSlice.imageBase+".left"),center:i(e.params.threeSlice.imageBase+".center"),right:i(e.params.threeSlice.imageBase+".right")}}),f=new h(k,M,B,L,R,E);break;case"AnimatedTextButton":this.checkParams({action:"string"},e.params),this.checkParams({text:"string",fontSize:"number",fontFamily:"string"},e.params.textStyle);var T=e.params.threeSlice||null;T&&this.checkParams({width:"number",height:"number",imageBase:"string"},e.params.threeSlice);var _=e.params.defaultTexture&&"string"==typeof e.params.defaultTexture?e.params.defaultTexture:null,A=e.params.hoverTexture&&"string"==typeof e.params.hoverTexture?e.params.hoverTexture:null,k=null!==_?t.Texture.fromFrame(i(_)):null,M=null!==A?t.Texture.fromFrame(i(A)):null,L=e.params.replaceOnHover||null,R=e.params.replaceOnHover||null,B=p&&p[e.params.action]&&p[e.params.action].bind(p)||null,P={text:n(e.params.textStyle.text),font:Math.floor(e.params.textStyle.fontSize*r.getResScale())+"px "+e.params.textStyle.fontFamily,align:e.params.textStyle.align,fontSize:e.params.textStyle.fontSize,useBitmapFont:"undefined"!=typeof e.params.textStyle.useBitmapFont?e.params.textStyle.useBitmapFont:!0};
e.params.textStyle.fill&&(P.fill=e.params.textStyle.fill),e.params.textStyle.stroke&&(P.stroke=e.params.textStyle.stroke),e.params.textStyle.strokeThickness&&(P.strokeThickness=o.x(e.params.textStyle.strokeThickness)),e.params.textStyle.tint&&(P.tint=parseInt(e.params.textStyle.tint,16)),e.params.textStyle.position&&(P.position={},e.params.textStyle.position.x&&(P.position.x=o.x(e.params.textStyle.position.x)),e.params.textStyle.position.y&&(P.position.y=o.x(e.params.textStyle.position.y)));var E=null;T&&(E={width:o.x(e.params.threeSlice.width),height:o.y(e.params.threeSlice.height),images:{left:i(e.params.threeSlice.imageBase+".left"),center:i(e.params.threeSlice.imageBase+".center"),right:i(e.params.threeSlice.imageBase+".right")}}),f=new l(k,M,B,L,R,P,E);break;case"ToggleButton":this.checkParams({baseName:"string",action:"string",enabled:"boolean"},e.params);var B=p&&p[e.params.action]&&p[e.params.action].bind(p)||null,D=e.params.useOverlay||!1;f=new u(e.params.baseName,B,e.params.enabled,D)}if(f){if(f instanceof t.DisplayObjectContainer&&e.children){f.widgets={};for(var O in e.children)e.children.hasOwnProperty(O)&&(f.widgets[O]=this.buildLayout(e.children[O],f,p),f.addChild(f.widgets[O]))}this.anchorWidget(f,e),this.scaleWidget(f,e,c),this.rotateWidget(f,e,c),this.positionWidget(f,e,c)}return f},checkParams:function(t,e){for(var i in t)if(t.hasOwnProperty(i)){if(!e||!e[i]&&""!==e[i])throw"Error: missing required parameter: "+i;if(typeof e[i]!==t[i])throw"Error: parameter '"+i+"' must be of type "+t[i]}},anchorWidget:function(t,e){e.anchor&&(e.anchor.x&&(t.anchor.x=e.anchor.x),e.anchor.y&&(t.anchor.y=e.anchor.y))},scaleWidget:function(t,e,i){if(e.scale){if(e.scale.x)if("string"==typeof e.scale.x){if("height"===e.scale.x){if(!i||!i.height)throw"Error: relative scale used but parent height not set!";t.scale.x=i.height/t.height}if("width"===e.scale.x){if(!i||!i.width)throw"Error: relative scale used but parent width not set!";t.scale.x=i.width/t.width}}else t.scale.x=e.scale.x;if(e.scale.y)if("string"==typeof e.scale.y){if("height"===e.scale.y){if(!i||!i.height)throw"Error: relative scale used but parent height not set!";t.scale.y=i.height/t.height}if("width"===e.scale.y){if(!i||!i.width)throw"Error: relative scale used but parent width not set!";t.scale.y=i.width/t.width}}else t.scale.y=e.scale.y}},rotateWidget:function(t,e){e.rotation&&(t.rotation=e.rotation)},positionWidget:function(t,e,i){var n,r;if(e.position){if("string"==typeof e.position.x){if(!i||!i.width)throw"Error: relative position used but parent width not set!";if(-1!==e.position.x.indexOf("%"))n=e.position.x.split("%"),r=parseInt(n[0])/100,t.position.x=i.width*r;else switch(e.position.x){case"left":t.position.x=0;break;case"right":t.position.x=i.width-t.width;break;case"center":t.position.x=(i.width-t.width)/2}}else"number"==typeof e.position.x&&(t.position.x=o.x(e.position.x));if("string"==typeof e.position.y){if(!i||!i.height)throw"Error: relative position used but parent height not set!";if(-1!==e.position.y.indexOf("%"))n=e.position.y.split("%"),r=parseInt(n[0])/100,t.position.y=i.height*r;else switch(e.position.y){case"top":t.position.y=0;break;case"bottom":t.position.y=i.height-t.height;break;case"middle":t.position.y=(i.height-t.height)/2}}else"number"==typeof e.position.y&&(t.position.y=o.y(e.position.y))}}}}),define("absolute/dialog",["pixi","absolute/uibuilder","absolute/assetmap","absolute/coords","absolute/screen","absolute/debug","lodash","absolute/button","absolute/audiomanager","absolute/nineslice"],function(t,e,i,n,o,r,s,a,h,l){var u=function(t,e){var o={width:"80%",height:"70%",x:null,y:null,landscapeX:null,landscapeY:null,portraitX:null,portraitY:null,name:"default",images:{topLeft:i("dialogNineSlice.topLeft"),topCenter:i("dialogNineSlice.topCenter"),topRight:i("dialogNineSlice.topRight"),topRight_closeBackground:i("dialogNineSlice.topRight_closeBackground"),middleLeft:i("dialogNineSlice.middleLeft"),middleCenter:i("dialogNineSlice.middleCenter"),middleRight:i("dialogNineSlice.middleRight"),bottomLeft:i("dialogNineSlice.bottomLeft"),bottomCenter:i("dialogNineSlice.bottomCenter"),bottomRight:i("dialogNineSlice.bottomRight"),close:i("dialogNineSlice.close")},closeButtonPosition:null,fillOpacity:.95,content:"",displayCloseButton:!0,callbacks:{onClose:null},audio:{close:"",open:"show_details_window"},tween:{type:"none",onClose:!1},buttons:[],buttonSpacing:n.x(20),layout:"",backgroundAlpha:.5};this._initDialog(t,s.extend(o,e))};return u.prototype=Object.create(o.prototype),u.prototype._initDialog=function(e,i){o.call(this),this.ui=e,this.options=i,this.cachedContent=this.options.content,this.isOpen=!1,this.container=new t.DisplayObjectContainer,this._setSize(),this._setPosition(),this._createBackground(),this.options.displayCloseButton&&this._createCloseButton(),this.options.buttons.length>0&&this.addButtons(this.options.buttons,this.options.buttonSpacing),this._setContent(this.options.content),this.addChild(this.container)},u.prototype.open=function(t){this.nineSlice&&null!==this.nineSlice||this._createBackground(),"function"==typeof t&&(this.options.callbacks.onClose=t),this.options.audio.open&&""!==this.options.audio.open&&h.playSound(this.options.audio.open),"none"!==this.options.tween.type?this.tweenIn():this.onOpenComplete(),this.ui.showModal(this,this.options.backgroundAlpha),this.isOpen=!0},u.prototype.tweenIn=function(){var t=this,e=this.position.x;this.position.x=this.ui.width,new TWEEN.Tween({x:this.position.x}).to({x:e},500).easing(TWEEN.Easing.Cubic.InOut).onUpdate(function(){t.position.x=this.x}).onComplete(function(){t.onOpenComplete()}).start()},u.prototype.onOpenComplete=function(){},u.prototype.close=function(t){if(this.options.audio.close&&""!==this.options.audio.close&&h.playSound(this.options.audio.close),this.options.tween.onClose){var e=this,i=this.ui.width;new TWEEN.Tween({x:this.position.x}).to({x:i},500).easing(TWEEN.Easing.Cubic.InOut).onUpdate(function(){e.position.x=this.x}).onComplete(function(){e.ui.hideModal(this),e.destroy(),t&&t()}).start()}else this.destroy(),this.ui.hideModal(this);this.isOpen=!1},u.prototype._setSize=function(){function t(t,e){var i=parseInt(e.slice(0,e.length-1))/100;return Math.round(t*i)}if(this.options.layout){var i=e.getConfigData(this.options.layout);i&&(i.width&&(this.options.width=n.x(i.width)),i.height&&(this.options.height=n.y(i.height)))}"string"==typeof this.options.width&&this.options.width.indexOf("%")>-1?(this.width=t(this.ui.width,this.options.width),this.options.width=this.width):this.width=this.options.width,"string"==typeof this.options.height&&this.options.height.indexOf("%")>-1?(this.height=t(this.ui.height,this.options.height),this.options.height=this.height):this.height=this.options.height},u.prototype.setLandscapePositions=function(t){"number"==typeof t.x&&(this.options.landscapeX=Math.round(t.x)),"number"==typeof t.y&&(this.options.landscapeY=Math.round(t.y))},u.prototype.setPortraitPositions=function(t){"number"==typeof t.x&&(this.options.portraitX=Math.round(t.x)),"number"==typeof t.y&&(this.options.portraitY=Math.round(t.y))},u.prototype._setPosition=function(t){"undefined"!=typeof t?t?(null===this.options.portraitX?this._setStandardX():this.position.x=Math.round(this.options.portraitX),null===this.options.portraitY?this._setStandardY():this.position.y=Math.round(this.options.portraitY)):(null===this.options.landscapeX?this._setStandardX():this.position.x=Math.round(this.options.landscapeX),null===this.options.landscapeY?this._setStandardY():this.position.y=Math.round(this.options.landscapeY)):(this._setStandardX(),this._setStandardY())},u.prototype._setStandardX=function(){this.position.x=Math.round(null===this.options.x?(this.ui.width-this.width)/2:this.options.x)},u.prototype._setStandardY=function(){this.position.y=Math.round(null===this.options.y?(this.ui.height-this.height)/2:this.options.y)},u.prototype._onClose=function(){"function"==typeof this.options.callbacks.onClose&&this.options.callbacks.onClose(this),this.close()},u.prototype._createCloseButton=function(){this.closeButton=new a(t.Texture.fromFrame(this.options.images.close),t.Texture.fromFrame(this.options.images.close),s.bind(this._onClose,this),!0),this.closeButton.hitArea=new t.Rectangle(-this.closeButton.width/3,-this.closeButton.height/3,1.6*this.closeButton.width,1.6*this.closeButton.height),this.options.images.topRight_closeBackground&&!this.options.closeButtonPosition?(this.closeButton.position.x=this.width-this.closeButton.width,this.closeButton.position.y=0):this.options.closeButtonPosition?(this.closeButton.position.x=this.options.closeButtonPosition.x,this.closeButton.position.y=this.options.closeButtonPosition.y):(this.closeButton.position.x=this.width-this.closeButton.width/1.5,this.closeButton.position.y=-(this.closeButton.height/3)),this.container.addChild(this.closeButton)},u.prototype.addButtons=function(e,i){var n=0,o=0;if(i=i||0,e.length>0){this.buttonContainer&&this.removeChild(this.buttonContainer),this.buttonContainer=new t.DisplayObjectContainer;for(var r=0;r<e.length;r+=1){var s=e[r];s.x=n,this.buttonContainer.addChild(s),n+=s.width+i,s.height>o&&(o=s.height)}this.buttonContainer.position.x=(this.width-(n-i))/2,this.buttonContainer.position.y=this.height-o,this.container.addChild(this.buttonContainer)}},u.prototype._createBackground=function(){var t=this.options.images;this.options.displayCloseButton&&t.topRight_closeBackground&&(t.topRight=t.topRight_closeBackground,this.options.images=t),this.nineSlice=new l(this.options),this.container.addChildAt(this.nineSlice,0)},u.prototype._setContent=function(t){if("undefined"!=typeof t){try{this.removeChild(this.cachedContent)}catch(e){}this.cachedContent=t}"undefined"==typeof this.cachedContent||s.isEmpty(this.cachedContent)||(this.container.addChild(this.cachedContent),this.container.getChildAt(0).cacheAsBitmap=!0)},u.prototype.resize=function(t,e){this.updateDialog(t,e)},u.prototype.updateDialog=function(e,i){s.extend(this.options,e);try{this.removeChild(this.container)}catch(n){}this.container=new t.DisplayObjectContainer,this._setSize(),this._setPosition(i),this._createBackground(),this.options.displayCloseButton&&this._createCloseButton(),this._setContent(this.options.content),this.addChild(this.container)},u.prototype.resetContent=function(t){this.options.content=t;try{this.container.removeChild(this.cachedContent)}catch(e){}this.cachedContent=t,this.container.addChild(this.cachedContent)},u.prototype.handleOrientationChange=function(t){this.updateDialog(this.options,t)},Object.defineProperty(u.prototype,"isOpen",{get:function(){return this.openState},set:function(t){this.openState=t}}),u.prototype.destroy=function(){this.nineSlice&&(this.nineSlice.destroy(),this.nineSlice=null)},u}),define("absolute/shims",["pixi"],function(t){if(window.navigator.userAgent.indexOf("Linux; U; Android 4")>=0){var e=Math.sin,i=Math.cos;Math.sin=function(t){return 0==t?0:e(t)},Math.cos=function(t){return 0==t?1:i(t)}}Date.now||(Date.now=function(){return+new Date}),t.JsonLoader.prototype.load=function(){this.ajaxRequest=new window.XMLHttpRequest;var t=this;this.ajaxRequest.onload=function(){t.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!1),this.ajaxRequest.send()},(t.VERSION="v1.5.3")&&(t.InteractionManager.prototype.onTouchMove=function(t){var e,i=this.interactionDOMElement.getBoundingClientRect(),n=t.changedTouches,o=0;for(o=0;o<n.length;o++){var r=n[o];e=this.touchs[r.identifier],e.originalEvent=t||window.event,e.global.x=(r.clientX-i.left)*(this.target.width/i.width),e.global.y=(r.clientY-i.top)*(this.target.height/i.height),navigator.isCocoonJS&&(e.global.x=r.clientX,e.global.y=r.clientY);for(var s=0;s<this.interactiveItems.length;s++){var a=this.interactiveItems[s];a.touchmove&&a.__touchData&&a.__touchData[r.identifier]&&a.touchmove(e)}}},t.Text.prototype.destroy=function(t){this.texture.destroy(t)},t.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete t.BaseTextureCache[this.imageUrl],this.imageUrl=null,this.source.src=null):this.source&&this.source._pixiId&&delete t.BaseTextureCache[this.source._pixiId],this.source=null,t.texturesToDestroy.push(this)},t.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(window.XMLHttpRequest)return new window.XMLHttpRequest;if(!window.ActiveXObject)return!1;for(var e=0;e<t.length;e++)try{return new window.ActiveXObject(t[e])}catch(i){}})}),define("absolute/sprite",["pixi","absolute/screenmetrics","absolute/debug"],function(t,e,i){return{fromFrame:function(n){var o;try{if(o=t.Sprite.fromFrame(n),i.enabled){var r=o.texture.baseTexture.imageUrl.substr(o.texture.baseTexture.imageUrl.lastIndexOf("/")+1),s=new t.Text(r,{font:Math.floor(30*e.getResScale())+"px Arial, Helvetica, sans-serif",fill:"white",align:"center"});s.position.y=0,s.position.x=0,o.addChild(s)}}catch(a){if(!i.enabled)throw a;o=t.Sprite.fromFrame("missing.png");var h=new t.Text(n,{font:Math.floor(40*e.getResScale())+"px Arial, Helvetica, sans-serif",fill:"black",align:"center"});h.position.y=o.height,h.position.x=(o.width-h.width)/2,o.addChild(h)}return o}}}),define("absolute/texture",["pixi","absolute/platform","absolute/debug"],function(t,e,i){return{fromFrame:function(e){var n;try{n=t.Texture.fromFrame(e)}catch(o){if(!i.enabled)throw o;n=t.Texture.fromFrame("missing.png")}return n}}}),define("absolute/mathutils",[],function(){return MathUtils={distance:function(t,e,i,n){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-n,2))}}}),define("absolute/randomutils",["absolute/mathutils","absolute/coords","pixi","lodash","absolute/spriteutils"],function(t,e,i,n,o){var r={getRandomIntFromRange:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},distributeItems:function(e,r,s,a,h){function l(e,n){for(var r=f.getRandomIntFromRange(0,s.width),u=f.getRandomIntFromRange(s.y,s.y+s.height),d=0;d<a.children.length;d++){var p=t.distance(r,u,a.children[d].position.x,a.children[d].position.y);if(e>=n)return!1;if(p<h.minSpacing)return e++,l(e,n),!1}if(c.sprite=new i.Sprite.fromFrame(c.url),c.sprite.anchor.x=h.anchor.x,c.sprite.anchor.y=h.anchor.y,h.shade>0){var g=new i.Sprite(o.greyscale(i.Sprite.fromFrame(c.url),.5));g.alpha=h.shade,c.sprite.addChild(g)}if(c.sprite.position.x=null!==h.lockX?h.lockX:r,c.sprite.position.y=null!==h.lockY?h.lockY:u,h.scaleWithY){var m=(u-s.y)/s.height;m+=h.minScale,m>1&&(m=1),c.sprite.scale.x=c.sprite.scale.y=m,c.sprite.alpha=Math.max(c.sprite.scale.y,h.minAlpha)}else{var y=f.getRandomIntFromRange(100*h.minScale,100*h.maxScale)/100;c.sprite.scale.x=c.sprite.scale.y=y,Math.random()>.5&&!h.lockScale&&(c.sprite.scale.x=-c.sprite.scale.x),y>1&&(c.sprite.y=c.sprite.texture.height-c.sprite.texture.height*y)}a.addChild(c.sprite)}h=n.extend({minSpacing:100,scaleWithY:!0,minScale:.3,maxScale:1,lockScale:!1,minAlpha:.2,lockY:null,lockX:null,anchor:{x:0,y:0},shade:0},h),this.ui=e,s.area=s.width*s.height;for(var u=0;u<r.length;u++){var c=r[u],d=new i.Texture.fromFrame(c.url);c.area=d.width*d.height,c.count=Math.ceil(c.fillDensity*s.area/c.area);for(var p=0;p<c.count;p++){var f=this;l(0,1e3)}}return a}};return r}),define("absolute/pageindicator",["absolute/coords","pixi","lodash"],function(t,e,i){var n=function(e,n,o){n="undefined"!=typeof n?n:0;var r={pageIndicators:{empty:"btn_main_pagepip_empty.png",full:"btn_main_pagepip_full.png"},pipPadding:t.x(10),clickCallback:function(){}};this.initPageIndicator(e,n,i.extend(r,o))};return n.prototype=Object.create(e.DisplayObjectContainer.prototype),n.prototype.initPageIndicator=function(t,i,n){e.DisplayObjectContainer.call(this),this.pageCount=t,this.currentPage=i,this.options=n,this.pips=[],this.makePips()},n.prototype.setPageIndex=function(t){this.currentPage=t,this._update()},n.prototype.makePips=function(){for(var t=0;t<this.pageCount;t++){var i=new e.DisplayObjectContainer;i.on=new e.Sprite.fromFrame(this.options.pageIndicators.full),i.off=new e.Sprite.fromFrame(this.options.pageIndicators.empty),i.position.x=(i.on.width+this.options.pipPadding)*t,t!==this.currentPage?(i.on.visible=!1,i.off.visible=!0):(i.on.visible=!0,i.off.visible=!1),i.addChild(i.on),i.addChild(i.off),i.off.interactive=!0,i.off.pageIndex=t,i.off.click=function(t){this.options.clickCallback(t.target.pageIndex)}.bind(this),this.addChild(i),this.pips.push(i)}this.height=i.on.height,this.width=(i.on.width+this.options.pipPadding)*this.pageCount},n.prototype._update=function(){for(var t=0;t<this.pips.length;t++){var e=this.pips[t];this.currentPage==t?(e.on.visible=!0,e.off.visible=!1):(e.on.visible=!1,e.off.visible=!0)}},n.prototype.nextPage=function(){this.currentPage++,this.currentPage>=this.pageCount&&0==this.currentPage,this._update()},n.prototype.previousPage=function(){this.currentPage--,this.currentPage<0&&0==this.currentPage,this._update()},n}),define("absolute/multipagedialog",["pixi","absolute/dialog","absolute/button","absolute/screenmetrics","lodash","absolute/pageindicator","absolute/coords","absolute/platform"],function(t,e,i,n,o,r,s,a){var h=function(t,e){var i={pages:[],pagePadding:{x:s.x(10),y:s.y(100)},borderThickness:{left:s.x(18),right:s.x(35)},interfacePadding:{arrows:{x:s.x(50),y:s.y(50)},pips:s.y(50)},buttonScale:.5,pageButtonImage:"btn_main_LAGOONRETURN.png",pageChangedCallback:function(){},startPage:0};this.initMultiPageDialog(t,o.extend(i,e))};return h.prototype=Object.create(e.prototype),h.prototype.initMultiPageDialog=function(t,i){e.call(this,t,i),this.pages=this.options.pages;var n=this.options.startPage<this.pages.length?this.options.startPage:0;this.reset(!1,n)},h.prototype.reset=function(t,e,i){if(t)try{this.removeChild(this.pageTray),this.removeChild(this.pips),this.removeChild(this.nextpageButton),this.removeChild(this.prevpageButton)}catch(n){}i&&(this.options.pages=i,this.pages=i),this.initContent(),this.initNonTouchInterface(),a._isOldAndroid()||this.initTouchInterface(),this.initPagePips(),this.scrollToPage(e)},h.prototype.initContent=function(){this.pageTray=new t.DisplayObjectContainer;for(var e=0,i=this.pages.length;i>e;e+=1){var n=this.pages[e];n.position.x=e*n.width,n.position.y=this.options.pagePadding.y,this.pageTray.addChild(n)}this.kPanThreshold=n.width/5,this.centerOffset=(this.width-n.width)/2,this.pageTray.position.x=this.centerOffset;var o=new t.Graphics;o.beginFill(16777215,1),o.drawRect(this.position.x+this.options.borderThickness.left,this.position.y,this.width-this.options.borderThickness.right,this.height),o.endFill(),this.pageTray.mask=o,this.container.addChild(this.pageTray)},h.prototype.initTouchInterface=function(){var e=0;this.closeButton&&(e=this.closeButton.height),this.lastDeltaX=0,this.startX=0;var i=new t.Rectangle(0,e,this.options.width,this.options.height-e-this.nextpageButton.height);this.touchContainer=new t.DisplayObjectContainer,this.touchContainer.interactive=!0,this.touchContainer.hitArea=i,this.touchContainer.addChild(this.pageTray),this.touchContainer.touchstart=this.handleDragStart.bind(this),this.touchContainer.touchmove=this.handleDrag.bind(this),this.touchContainer.touchend=this.touchContainer.touchendoutside=this.handleDragEnd.bind(this),this.addChild(this.touchContainer)},h.prototype.initNonTouchInterface=function(){this.nextpageButton=new i(t.Texture.fromFrame(this.options.pageButtonImage),t.Texture.fromFrame(this.options.pageButtonImage),function(){this.currentPage<this.pages.length-1&&this.scrollToPage(this.currentPage+1)}.bind(this),!1);var e=this.height-this.nextpageButton.height*this.options.buttonScale-this.options.interfacePadding.arrows.y;this.nextpageButton.scale.x=-1*this.options.buttonScale,this.nextpageButton.scale.y=this.options.buttonScale,this.nextpageButton.position.x=this.width-this.options.interfacePadding.arrows.x,this.nextpageButton.position.y=e,this.nextpageButton.setActive(!1),this.container.addChild(this.nextpageButton),this.prevpageButton=new i(t.Texture.fromFrame(this.options.pageButtonImage),t.Texture.fromFrame(this.options.pageButtonImage),function(){this.currentPage>0&&this.scrollToPage(this.currentPage-1)}.bind(this),!1),this.prevpageButton.position.y=e,this.prevpageButton.scale.x=this.prevpageButton.scale.y=this.options.buttonScale,this.prevpageButton.position.x=this.options.interfacePadding.arrows.x,this.prevpageButton.setActive(!1),this.container.addChild(this.prevpageButton)},h.prototype.initPagePips=function(){this.pages.length>1&&(this.pips=new r(this.pages.length,0,{clickCallback:this.scrollToPage.bind(this)}),this.pips.position.x=(this.width-this.pips.width)/2,this.pips.position.y=this.height-this.pips.height-this.options.interfacePadding.pips,this.container.addChild(this.pips))},h.prototype.enableButtons=function(t){var e,i;for(e=0,i=this.pages.length;i>e;e++)this.pages[e].enableButtons(t)},h.prototype.handleDragStart=function(t){this.dragging=!0,this.lastDeltaX=0,this.startX=t.getLocalPosition(this.parent).x,console.log("startx ",this.startX),this.enableButtons(!1)},h.prototype.handleDrag=function(t){var e=t.getLocalPosition(this.parent),i=e.x-this.startX;this.pageTray.x+=(i-this.lastDeltaX)*n.devicePixelRatio*.7,this.lastDeltaX=i},h.prototype.handleDragEnd=function(t){if(this.lastDeltaX=0,"undefined"!=typeof this.parent){var e=this.currentPage,i=t.getLocalPosition(this.parent),n=i.x-this.startX;n<=-this.kPanThreshold?e+=1:n>=this.kPanThreshold&&(e-=1),0>e?e=0:e>this.pages.length-1&&(e=this.pages.length-1),this.scrollToPage(e)}},h.prototype.scrollToPage=function(t){this.pips&&this.pips.setPageIndex(t);var e=-(t*this.pages[t].width)+this.centerOffset,i=this;new TWEEN.Tween({x:this.pageTray.position.x}).to({x:e},200).easing(TWEEN.Easing.Quadratic.InOut).onUpdate(function(){i.pageTray.position.x=this.x}).onComplete(function(){i.enableButtons(!0),i.setCurrentPage(t)}).start()},h.prototype.setCurrentPage=function(t){this.currentPage=t,this.nextpageButton.setActive(t!==this.pages.length-1),this.prevpageButton.setActive(0!==t),this.options.pageChangedCallback(t)},h.prototype.enableButtons=function(t){var e,i;for(e=0,i=this.pages.length;i>e;e++)this.pages[e].interactive=t},h.prototype.handleOrientationChange=function(t){e.prototype.handleOrientationChange.call(this,t),this.reset(!0,this.currentPage)},h}),define("absolute/multipagegenerator",["pixi","absolute/coords","lodash"],function(t,e,i){var n=function(t){var n={width:0,height:0,cardScale:.83,padding:{x:e.x(50),y:e.y(50)},itemWidth:0,itemHeight:0};this.initMultiPageGenerator(i.extend(n,t))};return n.prototype.initMultiPageGenerator=function(t){this.settings=t,this.width=this.settings.width,this.height=this.settings.height},n.prototype.getPages=function(t){this.items=t,this.pages=[],this.cellWidth=this.settings.itemWidth*this.settings.cardScale+this.settings.padding.x,this.cellHeight=this.settings.itemHeight*this.settings.cardScale+this.settings.padding.y,this.colsPerPage=Math.floor(this.width/this.cellWidth),this.rowsPerPage=Math.floor(this.height/this.cellHeight);for(var e=this.items.length/this.colsPerPage,i=Math.ceil(e/this.rowsPerPage),n=0;i>n;n+=1){var o=this.rowsPerPage*this.colsPerPage*n,r=this.rowsPerPage*this.colsPerPage*(n+1);r>this.items.length&&(r=this.items.length),this.pages.push(this.makePage(this.items.slice(o,r)))}return this.pages},n.prototype.makePage=function(e){for(var i=new t.DisplayObjectContainer,n=0,o=0;o<this.rowsPerPage;o+=1)for(var r=0;r<this.colsPerPage&&n<e.length;r++){var s=e[n];s.x=r*(s.width*this.settings.cardScale+this.settings.padding.x),s.y=o*(s.height*this.settings.cardScale+this.settings.padding.y),s.scale.x=s.scale.y=this.settings.cardScale,i.addChild(s),n++}return i.width=(s.width+this.settings.padding.x)*Math.min(this.colsPerPage,e.length)-this.settings.padding.x,i},n}),define("absolute/graphserializer",["pixi","absolute/button"],function(t,e){var i={serialize:function(i){var n,o,r={position:{x:i.position.x,y:i.position.y}};if(i instanceof e)r.type="button",r.asset=this.lookupTexture(i),r.id=r.asset.substring(0,r.asset.indexOf(".png"));else if(i instanceof t.Sprite)for(o=i.children.length,r.type="sprite",r.asset=this.lookupTexture(i),r.id=r.asset.substring(0,r.asset.indexOf(".png")),r.children=[],n=0;o>n;n+=1)r.children.push(this.serialize(i.getChildAt(n)));else if(i instanceof t.DisplayObjectContainer)for(o=i.children.length,r.type="container",r.children=[],n=0;o>n;n+=1)r.children.push(this.serialize(i.getChildAt(n)));return r},lookupTexture:function(e){var i;for(i in t.TextureCache)if(t.TextureCache.hasOwnProperty(i)&&t.TextureCache[i]===e.texture)return i;return""}};return i}),define("absolute/scrollarea",["pixi","absolute/platform"],function(t,e){var i=function(t,e,i,n,o){this._initScrollArea(t,e,i,n,o)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype._initScrollArea=function(i,n,o,r,s){t.DisplayObjectContainer.call(this),o&&(o.x?(this.constrainX=!0,this.constrainXType=o.x):o.y?(this.constrainY=!0,this.constrainYType=o.y):this.constrainX=this.constrainY=!1),r&&(this.scrollArrow=new t.Sprite(r),this.scrollArrow.anchor.x=this.scrollArrow.anchor.y=.5),this.moveCompleteCallback=s,this.moving=!1,this.contents=new t.DisplayObjectContainer,this.contents.setInteractive(!0),e.supportsTouch()?(this.contents.touchstart=this.onMoveStart.bind(this),this.contents.touchmove=this.onMove.bind(this),this.contents.touchend=this.onMoveEnd.bind(this)):(this.contents.mousedown=this.onMoveStart.bind(this),this.contents.mousemove=this.onMove.bind(this),this.contents.mouseup=this.onMoveEnd.bind(this),this.contents.mouseupoutside=this.onMoveEnd.bind(this)),this.addChild(this.contents),this.resize(i,n)},i.prototype.resize=function(e,i){this.width=e,this.height=i,this.mask&&this.removeChild(this.mask);var n=new t.Graphics;n.beginFill(16777215,1),n.drawRect(0,0,this.width,this.height),n.endFill(),this.mask=n,this.addChild(this.mask),this.updateContentBounds()},i.prototype.addItem=function(t){this.contents.addChild(t),this.updateContentBounds()},i.prototype.scrollXAbsolute=function(t){this.constrainX||0>=t&&t>=this.width-this.contents.width&&(this.contents.position.x=Math.round(t))},i.prototype.scrollYAbsolute=function(t){this.constrainY||0>=t&&t>=this.height-this.contents.height&&(this.contents.position.y=Math.round(t))},i.prototype.scrollX=function(t){if(!this.constrainX){var e=this.contents.position.x+t;0>=e&&e>=this.width-this.contents.width&&(this.contents.position.x=Math.round(e))}},i.prototype.scrollY=function(t){if(!this.constrainY){var e=this.contents.position.y+t;0>=e&&e>=this.height-this.contents.height&&(this.contents.position.y=Math.round(e))}},i.prototype.scrollTop=function(){this.constrainY||(this.contents.position.y=0)},i.prototype.scrollBottom=function(){this.constrainY||(this.contents.position.y=this.height-this.contents.height)},i.prototype.scrollLeft=function(){this.constrainX||(this.contents.position.x=0)},i.prototype.scrollRight=function(){this.constrainX||(this.contents.position.x=this.width-this.contents.width)},i.prototype.updateContentBounds=function(){var e;if(e=this.computeAABB(this.contents),this.contents.width=e.width,this.contents.height=e.height,this.contents.hitArea=new t.Rectangle(0,0,e.width,e.height),this.constrainX)switch(this.constrainXType){case"left":this.contents.position.x=0;break;case"right":this.contents.position.x=this.width-this.contents.width;break;case"center":this.contents.position.x=(this.width-this.contents.width)/2}if(this.constrainY)switch(this.constrainYType){case"top":this.contents.position.y=0;break;case"bottom":this.contents.position.y=this.height-this.contents.height;break;case"center":this.contents.position.y=(this.height-this.contents.height)/2}},i.prototype.computeAABB=function(e){if(e instanceof t.Sprite)return new t.Rectangle(e.position.x,e.position.y,e.width,e.height);if(e instanceof t.DisplayObjectContainer){if(e.width&&e.height)return new t.Rectangle(e.position.x,e.position.y,e.width,e.height);if(e.children.length>0){for(var i=Number.MAX_VALUE,n=Number.MIN_VALUE,o=Number.MAX_VALUE,r=Number.MIN_VALUE,s=0;s<e.children.length;s+=1){var a=this.computeAABB(e.children[s]);a.x<i&&(i=a.x),a.y<o&&(o=a.y),a.x+a.width>n&&(n=a.x+a.width),a.y+a.height>r&&(r=a.y+a.height)}return i*=e.scale.x,n*=e.scale.x,o*=e.scale.y,r*=e.scale.y,new t.Rectangle(e.position.x+i,e.position.y+o,n-i,r-o)}return new t.Rectangle(e.position.x,e.position.y,0,0)}},i.prototype.onMoveStart=function(t){this.moving=!0,t.originalEvent.preventDefault();var e=t.getLocalPosition(this.parent);this.lastX=e.x,this.lastY=e.y,this.startX=e.x,this.startY=e.y,this.scrollArrow&&(this.addChild(this.scrollArrow),this.scrollArrow.position.x=e.x,this.scrollArrow.position.y=e.y,this.scrollArrow.anchor.x=this.scrollArrow.anchor.y=.5,this.scrollArrow.visible=!1)},i.prototype.onMove=function(t){if(this.moving){var e=t.getLocalPosition(this.parent),i=e.x,n=e.y,o=i-this.lastX,r=n-this.lastY;this.lastX=i,this.lastY=n,this.scrollY(r),this.scrollX(o),this.scrollArrow&&(this.scrollArrow.visible||(this.scrollArrow.visible=!0),this.constrainX||(this.scrollArrow.position.x=e.x),this.constrainY||(this.scrollArrow.position.y=e.y))}},i.prototype.onMoveEnd=function(t){this.moving=!1;{var e=t.getLocalPosition(this.parent),i=e.x,n=e.y;i-this.startX,n-this.startY}this.scrollArrow&&this.removeChild(this.scrollArrow),this.moveCompleteCallback&&this.moveCompleteCallback()},i.prototype.isChildVisible=function(e){this.contents.updateTransform();var i=new t.Rectangle(e.worldTransform.tx,e.worldTransform.ty,e.width,e.height),n=new t.Rectangle(this.worldTransform.tx,this.worldTransform.ty,this.width,this.height),o=n.contains(i.x+i.width/2,i.y+i.height/2),r=n.contains(i.x,i.y),s=n.contains(i.x+i.width,i.y),a=n.contains(i.x+i.width,i.y+i.height),h=n.contains(i.x+i.width,i.y+i.height);return o||r||s||a||h},i}),define("absolute/messagedialog",["pixi","absolute/dialog","lodash","absolute/button","absolute/coords","absolute/screenmetrics"],function(t,e,i,n,o,r){var s=function(t,e,n){var s={okFunc:function(){},displayOkButton:!0,okButtonText:"OK",okButtonImage:"dlg_btn_blank.png",okButtonTextStyle:{font:Math.floor(90*r.getResScale())+"px Ganache",align:"center",wordWrap:!0,wordWrapWidth:this.width-o.x(200)},textStyle:{font:Math.floor(80*r.getResScale())+"px Ganache",align:"center",wordWrap:!0,wordWrapWidth:this.width-o.x(200)},textImage:null};this.initMessageDialog(t,e,i.extend(s,n))};return s.prototype=Object.create(e.prototype),s.prototype.initMessageDialog=function(i,r,s){if(e.call(this,i,s),this.ui=i,this.message=r,this.content=this.initContent(),this._setContent(this.content),this.options.displayOkButton){this.okButton=new n(t.Texture.fromFrame(this.options.okButtonImage),t.Texture.fromFrame(this.options.okButtonImage),function(){"function"==typeof this.options.okFunc&&this.options.okFunc()}.bind(this)),this.okButton.position.x=(this.width-this.okButton.width)/2,this.okButton.position.y=this.height-this.okButton.height,this.addChild(this.okButton);var a=new t.BitmapText(this.options.okButtonText,this.options.okButtonTextStyle);a.position.x=(this.okButton.width-a.textWidth)/2,a.position.y=o.y(-20),this.okButton.addChild(a)}},s.prototype.initContent=function(){var e=new t.DisplayObjectContainer;return e.width=this.width,e.height=this.height,null==this.options.textImage?(this.text=new t.BitmapText(this.message,this.options.textStyle),this.text.position.y=o.y(120)):(this.text=this.options.textImage,this.text.setText(this.message)),this.text.position.x=(e.width-this.text.textWidth)/2,e.addChild(this.text),e},s.prototype.setPosition=function(t,e,i){t.position.x=o.x(e),t.position.y=o.y(i)},s.prototype.setMessage=function(t){this.text.setText(t),setTimeout(function(){this.text.position.x=(this.width-this.text.textWidth)/2}.bind(this),10)},s.prototype.setMessageY=function(t){this.text.position.y=t},s}),define("absolute/integration",["absolute/debug","absolute/gameconfig"],function(t,e){var i={spil:{gameBreak:function(e,i){function n(){r||(e.call(this),r=!0),window.clearTimeout(o)}if(window.SpilGameAPIInstance&&!window.SpilGameAPIInstance.IS_STANDALONE&&window.SpilGameAPIInstance.GameBreak){var o,r=!1;
window.SpilGameAPIInstance.GameBreak.request(i.bind(this),n.bind(this)),window.setTimeout(function(){t.log("ahg: Spil api failure: gamebreak"),n.call(this)}.bind(this),1e4)}else e.call(this)}},iwin:{ready:function(e){window.iConsole?window.iConsole.game.ready().result(function(){e.call(this)}):t.log("ahg: iWin api not available game ready failed.")},loadProgress:function(e){window.iConsole?window.iConsole.game.loadProgress({progress:e,file:"ahg: file name not available."}):t.log("ahg: iWin api not available loadProgress failed.")},loaded:function(e,i){window.iConsole?window.iConsole.game.loaded({success:e}):(t.log("ahg: iWin api not available loaded failed."),i.call(this))},levelStarted:function(t,e){window.iConsole?window.iConsole.game.levelStarted({level:t}).result(function(t){e.call(this,t)}.bind(this)):e.call(this)},levelFinished:function(t,e,i,n,o,r){window.iConsole?window.iConsole.game.levelFinished({level:e,score:i,time:n,won:o,data:r||{}}).result(function(){t.call(this)}):t.call(this)},getGameData:function(t,i){window.iConsole?window.iConsole.game.getGameData().result(function(e){var i={};if("undefined"!=typeof e&&null!==e&&""!==e)try{i=JSON.parse(e)}catch(n){}else i.data={};t.call(this,i.data)}.bind(this)):t.call(this,e.getVal(i))},setGameData:function(t,i){window.iConsole?window.iConsole.game.setGameData({data:t}):e.setVal(i,t)}}};return i}),define("absolute/lazyloadedsprite",["pixi","absolute/loader"],function(t,e){var i=function(t,e,i){this._initLazyLoadedSprite(t,e,i)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype._initLazyLoadedSprite=function(e,i,n){t.DisplayObjectContainer.call(this),this.atlasName=e,this.assetName=i,this.placeholder=n,this.isLoaded=!1,this.isLoading=!1,this.addChild(this.placeholder)},i.prototype.load=function(i){if(t.TextureCache[this.assetName])this._replaceAsset();else{var n=new e;this.isLoading=!0,n.loadArt([{name:this.atlasName}],function(){},function(){this._replaceAsset(),this.isLoaded=!0,"function"==typeof i&&i(this)}.bind(this))}},i.prototype._replaceAsset=function(){this.asset=t.Sprite.fromFrame(this.assetName),this.placeholder.addChild(this.asset)},Object.defineProperty(i.prototype,"loaded",{get:function(){return this.isLoaded}}),Object.defineProperty(i.prototype,"loading",{get:function(){return this.isLoading}}),Object.defineProperty(i.prototype,"width",{get:function(){return this.placeholder.width*this.placeholder.scale.x}}),Object.defineProperty(i.prototype,"height",{get:function(){return this.placeholder.height*this.placeholder.scale.y}}),i}),define("absolute/utils",[],function(){var t={makeGUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)})},makeUniqueId:function(){return"yxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)})}};return t}),define("absolute",["require","absolute/asyncqueue","absolute/audiomanager","absolute/button","absolute/snapshot","absolute/coords","absolute/platform","absolute/screenmetrics","absolute/digitlabel","absolute/debug","absolute/digitsprite","absolute/eventbus","absolute/gameconfig","absolute/storagemanager","absolute/spriteutils","absolute/game","absolute/gameui","absolute/textutils","absolute/togglebutton","absolute/musicmanager","absolute/progressbar","absolute/progressdial","absolute/tweenutils","absolute/screen","absolute/simplemessagebox","absolute/spritemessagebox","absolute/loader","absolute/layouthelper","absolute/draggable","absolute/analytics","absolute/dialog","absolute/shims","absolute/sprite","absolute/texture","absolute/mathutils","absolute/randomutils","absolute/pageindicator","absolute/multipagedialog","absolute/multipagegenerator","absolute/graphserializer","absolute/scrollarea","absolute/textbutton","absolute/nineslice","absolute/messagedialog","absolute/integration","absolute/assetmap","absolute/uibuilder","absolute/stringmanager","absolute/animatedbutton","absolute/animatedtextbutton","absolute/lazyloadedsprite","absolute/utils"],function(t){"use strict";return{version:"1.0",AsyncQueue:t("absolute/asyncqueue"),AudioManager:t("absolute/audiomanager"),Button:t("absolute/button"),Snapshot:t("absolute/snapshot"),Coords:t("absolute/coords"),Platform:t("absolute/platform"),ScreenMetrics:t("absolute/screenmetrics"),DigitLabel:t("absolute/digitlabel"),Debug:t("absolute/debug"),DigitSprite:t("absolute/digitsprite"),EventBus:t("absolute/eventbus"),GameConfig:t("absolute/gameconfig"),StorageManager:t("absolute/storagemanager"),SpriteUtils:t("absolute/spriteutils"),Game:t("absolute/game"),GameUI:t("absolute/gameui"),TextUtils:t("absolute/textutils"),ToggleButton:t("absolute/togglebutton"),MusicManager:t("absolute/musicmanager"),ProgressBar:t("absolute/progressbar"),ProgressDial:t("absolute/progressdial"),TweenUtils:t("absolute/tweenutils"),Screen:t("absolute/screen"),SimpleMessageBox:t("absolute/simplemessagebox"),SpriteMessageBox:t("absolute/spritemessagebox"),Loader:t("absolute/loader"),LayoutHelper:t("absolute/layouthelper"),Draggable:t("absolute/draggable"),Analytics:t("absolute/analytics"),Dialog:t("absolute/dialog"),Shims:t("absolute/shims"),Sprite:t("absolute/sprite"),Texture:t("absolute/texture"),MathUtils:t("absolute/mathutils"),RandomUtils:t("absolute/randomutils"),PageIndicator:t("absolute/pageindicator"),MultiPageDialog:t("absolute/multipagedialog"),MultiPageGenerator:t("absolute/multipagegenerator"),GraphSerializer:t("absolute/graphserializer"),ScrollArea:t("absolute/scrollarea"),TextButton:t("absolute/textbutton"),NineSlice:t("absolute/nineslice"),MessageDialog:t("absolute/messagedialog"),Integration:t("absolute/integration"),AssetMap:t("absolute/assetmap"),UIBuilder:t("absolute/uibuilder"),StringManager:t("absolute/stringmanager"),AnimatedButton:t("absolute/animatedbutton"),AnimatedTextButton:t("absolute/animatedtextbutton"),LazyLoadedSprite:t("absolute/lazyloadedsprite"),Utils:t("absolute/utils")}}),define("text!audiosprites.json",[],function(){return'[\n    {\n        "id": "mainscreen_music",\n        "url": "mainscreen",\n        "loop": true,\n        "volume": 50,\n        "start": 45,\n        "end": 77.01886621315194\n    },\n    {\n        "id": "music_1",\n        "url": "music_1",\n        "loop": true,\n        "volume": 50,\n        "start": 109,\n        "end": 155.11337868480726\n    },\n    {\n        "id": "music_2",\n        "url": "music_2",\n        "loop": true,\n        "volume": 50,\n        "start": 157,\n        "end": 201.18612244897957\n    },\n    {\n        "id": "music_3",\n        "url": "music_3",\n        "loop": true,\n        "volume": 50,\n        "start": 203,\n        "end": 251.0174149659864\n    },\n    {\n        "id": "casing",\n        "url": "casing",\n        "loop": false,\n        "volume": 50,\n        "start": 8,\n        "end": 8.253968253968253\n    },\n    {\n        "id": "turret_firing1",\n        "url": "turret_firing",\n        "loop": false,\n        "volume": 50,\n        "start": 336,\n        "end": 336.53260770975055\n    },\n    {\n        "id": "turret_firing2",\n        "url": "turret_firing2",\n        "loop": false,\n        "volume": 50,\n        "start": 338,\n        "end": 338.62548752834465\n    },\n    {\n        "id": "turret_firing3",\n        "url": "turret_firing3",\n        "loop": false,\n        "volume": 50,\n        "start": 340,\n        "end": 341.0434467120181\n    },\n    {\n        "id": "spikes_hit",\n        "url": "spikes_hit",\n        "loop": false,\n        "volume": 50,\n        "start": 277,\n        "end": 277.25396825396825\n    },\n    {\n        "id": "spikes_out1",\n        "url": "spikes_out",\n        "loop": false,\n        "volume": 50,\n        "start": 279,\n        "end": 279.53260770975055\n    },\n    {\n        "id": "spikes_out2",\n        "url": "spikes_out2",\n        "loop": false,\n        "volume": 50,\n        "start": 281,\n        "end": 281.69514739229027\n    },\n    {\n        "id": "spikes_out3",\n        "url": "spikes_out3",\n        "loop": false,\n        "volume": 50,\n        "start": 283,\n        "end": 283.7415873015873\n    },\n    {\n        "id": "mine1",\n        "url": "missile_explosion2",\n        "loop": false,\n        "volume": 50,\n        "start": 99,\n        "end": 100.22920634920635\n    },\n    {\n        "id": "mine2",\n        "url": "mine2",\n        "loop": false,\n        "volume": 50,\n        "start": 85,\n        "end": 86.8097052154195\n    },\n    {\n        "id": "mine3",\n        "url": "mine3",\n        "loop": false,\n        "volume": 50,\n        "start": 88,\n        "end": 89.76326530612245\n    },\n    {\n        "id": "mine4",\n        "url": "mine4",\n        "loop": false,\n        "volume": 50,\n        "start": 91,\n        "end": 93.94748299319728\n    },\n    {\n        "id": "blood",\n        "url": "blood",\n        "loop": false,\n        "volume": 50,\n        "start": 2,\n        "end": 2.904126984126984\n    },\n    {\n        "id": "bouncer_in",\n        "url": "springtool_in",\n        "loop": false,\n        "volume": 50,\n        "start": 285,\n        "end": 285.43972789115645\n    },\n    {\n        "id": "bouncer_out",\n        "url": "springtool_out",\n        "loop": false,\n        "volume": 50,\n        "start": 287,\n        "end": 287.5790476190476\n    },\n    {\n        "id": "menu_close",\n        "url": "menu_close",\n        "loop": false,\n        "volume": 50,\n        "start": 79,\n        "end": 79.62548752834468\n    },\n    {\n        "id": "menu_open",\n        "url": "menu_open",\n        "loop": false,\n        "volume": 50,\n        "start": 81,\n        "end": 81.69514739229025\n    },\n    {\n        "id": "failed",\n        "url": "failed",\n        "loop": false,\n        "volume": 50,\n        "start": 37,\n        "end": 39.506303854875284\n    },\n    {\n        "id": "complete",\n        "url": "complete",\n        "loop": false,\n        "volume": 50,\n        "start": 17,\n        "end": 20.71374149659864\n    },\n    {\n        "id": "cleaner_robots",\n        "url": "cleaner_robots",\n        "loop": false,\n        "volume": 50,\n        "start": 14,\n        "end": 15.902585034013605\n    },\n    {\n        "id": "duck_appears",\n        "url": "duck_appears",\n        "loop": false,\n        "volume": 50,\n        "start": 28,\n        "end": 29.87936507936508\n    },\n    {\n        "id": "button_click",\n        "url": "buttons_hit",\n        "loop": false,\n        "volume": 50,\n        "start": 4,\n        "end": 4.370068027210884\n    }\n]'}),define("audiosprites",["text!audiosprites.json"],function(t){return JSON.parse(t)}),define("text!artassets.json",[],function(){return'[\n    {\n        "name": "loading",\n        "format": "png"\n    },\n    {\n        "name": "gamescreen",\n        "format": "png"\n    },\n    {\n        "name": "damage",\n        "format": "png"\n    },\n    {\n        "name": "gamebackground",\n        "format": "jpg"\n    },\n    {\n        "name": "menubackground",\n        "format": "jpg"\n    },\n    {\n        "name": "dialogs",\n        "format": "png"\n    }\n]'}),define("artassets",["text!artassets.json"],function(t){return JSON.parse(t)}),define("gameconfig",["text!gameconfig.json"],function(t){return JSON.parse(t)}),function(t){var e={VERSION:"2.2.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(t,i){var n="string"==typeof t.initial?{state:t.initial}:t.initial,o=t.terminal||t["final"],r=i||t.target||{},s=t.events||[],a=t.callbacks||{},h={},l=function(t){var i=t.from instanceof Array?t.from:t.from?[t.from]:[e.WILDCARD];h[t.name]=h[t.name]||{};for(var n=0;n<i.length;n++)h[t.name][i[n]]=t.to||i[n]};n&&(n.event=n.event||"startup",l({name:n.event,from:"none",to:n.state}));for(var u=0;u<s.length;u++)l(s[u]);for(var c in h)h.hasOwnProperty(c)&&(r[c]=e.buildEvent(c,h[c]));for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c]);return r.current="none",r.is=function(t){return t instanceof Array?t.indexOf(this.current)>=0:this.current===t},r.can=function(t){return!this.transition&&(h[t].hasOwnProperty(this.current)||h[t].hasOwnProperty(e.WILDCARD))},r.cannot=function(t){return!this.can(t)},r.error=t.error||function(t,e,i,n,o,r,s){throw s||r},r.isFinished=function(){return this.is(o)},n&&!n.defer&&r[n.event](),r},doCallback:function(t,i,n,o,r,s){if(i)try{return i.apply(t,[n,o,r].concat(s))}catch(a){return t.error(n,o,r,s,e.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",a)}},beforeAnyEvent:function(t,i,n,o,r){return e.doCallback(t,t.onbeforeevent,i,n,o,r)},afterAnyEvent:function(t,i,n,o,r){return e.doCallback(t,t.onafterevent||t.onevent,i,n,o,r)},leaveAnyState:function(t,i,n,o,r){return e.doCallback(t,t.onleavestate,i,n,o,r)},enterAnyState:function(t,i,n,o,r){return e.doCallback(t,t.onenterstate||t.onstate,i,n,o,r)},changeState:function(t,i,n,o,r){return e.doCallback(t,t.onchangestate,i,n,o,r)},beforeThisEvent:function(t,i,n,o,r){return e.doCallback(t,t["onbefore"+i],i,n,o,r)},afterThisEvent:function(t,i,n,o,r){return e.doCallback(t,t["onafter"+i]||t["on"+i],i,n,o,r)},leaveThisState:function(t,i,n,o,r){return e.doCallback(t,t["onleave"+n],i,n,o,r)},enterThisState:function(t,i,n,o,r){return e.doCallback(t,t["onenter"+o]||t["on"+o],i,n,o,r)},beforeEvent:function(t,i,n,o,r){return!1===e.beforeThisEvent(t,i,n,o,r)||!1===e.beforeAnyEvent(t,i,n,o,r)?!1:void 0},afterEvent:function(t,i,n,o,r){e.afterThisEvent(t,i,n,o,r),e.afterAnyEvent(t,i,n,o,r)},leaveState:function(t,i,n,o,r){var s=e.leaveThisState(t,i,n,o,r),a=e.leaveAnyState(t,i,n,o,r);return!1===s||!1===a?!1:e.ASYNC===s||e.ASYNC===a?e.ASYNC:void 0},enterState:function(t,i,n,o,r){e.enterThisState(t,i,n,o,r),e.enterAnyState(t,i,n,o,r)},buildEvent:function(t,i){return function(){var n=this.current,o=i[n]||i[e.WILDCARD]||n,r=Array.prototype.slice.call(arguments);if(this.transition)return this.error(t,n,o,r,e.Error.PENDING_TRANSITION,"event "+t+" inappropriate because previous transition did not complete");if(this.cannot(t))return this.error(t,n,o,r,e.Error.INVALID_TRANSITION,"event "+t+" inappropriate in current state "+this.current);if(!1===e.beforeEvent(this,t,n,o,r))return e.Result.CANCELLED;if(n===o)return e.afterEvent(this,t,n,o,r),e.Result.NOTRANSITION;var s=this;this.transition=function(){return s.transition=null,s.current=o,e.enterState(s,t,n,o,r),e.changeState(s,t,n,o,r),e.afterEvent(s,t,n,o,r),e.Result.SUCCEEDED},this.transition.cancel=function(){s.transition=null,e.afterEvent(s,t,n,o,r)};var a=e.leaveState(this,t,n,o,r);return!1===a?(this.transition=null,e.Result.CANCELLED):e.ASYNC===a?e.Result.PENDING:this.transition?this.transition():void 0}}};"function"==typeof define?define("state-machine",["require"],function(){return e}):t.StateMachine=e}(this),define("damagemeter",["pixi","absolute","lodash"],function(t,e,i){var n=function(t){var n={frameImage:"meter_damage.png",fillImage1:"meter_orange.png",fillImage2:"meter_red.png",targetImage:"target.png",targetReachedImage:"target_check.png",awardMask:{image:"award_meter_star_empty.png",position:{x:0,y:0}},targetReachedSound:"",frameBorderWidth:e.Coords.x(49),frameBorderHeight:e.Coords.x(10),meterWidth:e.Coords.x(313),totalHealth:1400,target:200};this._initAchievementProgressBar(i.extend(n,t))};return n.prototype=Object.create(t.DisplayObjectContainer.prototype),n.prototype._initAchievementProgressBar=function(i){t.DisplayObjectContainer.call(this),this.settings=i,this.targetPassed=!1,this.targetPercentage=this.settings.target/this.settings.totalHealth,this.frame=new t.Sprite.fromFrame(this.settings.frameImage),this.fill1=e.Sprite.fromFrame(this.settings.fillImage1),this.fill1Mask=new t.Graphics,this.fill2=e.Sprite.fromFrame(this.settings.fillImage2),this.fill2Mask=new t.Graphics,this.fill1Mask.beginFill(16777215),this.fill1Mask.drawRect(0,0,this.fill1.width,this.fill1.height),this.fill1Mask.endFill(),this.fill2Mask.beginFill(16777215),this.fill2Mask.drawRect(0,0,this.fill1.width,this.fill1.height),this.fill1Mask.endFill(),this.fill1.x=this.settings.frameBorderWidth,this.fill1.y=this.settings.frameBorderHeight,this.fill1.addChild(this.fill1Mask),this.fill1.mask=this.fill1Mask,this.fill1.mask.x=-this.fill1.width,this.fill2.x=this.settings.frameBorderWidth,this.fill2.y=this.settings.frameBorderHeight,this.fill2.addChild(this.fill2Mask),this.fill2.mask=this.fill2Mask,this.fill2.mask.x=-this.fill2.width,this.addChild(this.frame),this.addChild(this.fill2),this.addChild(this.fill1),null!==this.settings.target&&(this.addTargetMarker(),this.addText()),this.width=this.frame.width,this.height=this.frame.height,this.totalDamage=0},n.prototype.reset=function(t){this.percent=0,this.fill1Mask.x=-this.fill1.width,this.fill2Mask.x=-this.fill2.width,this.stringCurrentDamage.setText("Damage: 0"),this.markerComplete.visible=!1,this.targetPassed=!1,t&&(i.extend(this.settings,t),this.removeChild(this.marker),this.targetPercentage=this.settings.target/this.settings.totalHealth,this.addTargetMarker(),this.stringTargetValue.setText(this.settings.target))},n.prototype.setProgress=function(t){this.percent=t/this.settings.totalHealth,this.percent>1&&(this.percent=1),this.totalDamage=Math.round(t),this.stringCurrentDamage.setText("Damage: "+Math.round(t).toString());var e=this.percent*this.fill1.width-this.fill1.width,i=this;new TWEEN.Tween({x:this.fill1.mask.x}).easing(TWEEN.Easing.Cubic.Out).to({x:e},1500*this.percent).onUpdate(function(){i.fill1Mask.x=this.x}).onComplete(function(){i.updateTarget()}).start()},n.prototype.setProgressByPercent=function(t){this.percent=t,this.fill1Mask.x=this.percent*this.fill1.width-this.fill1.width},n.prototype.updateTarget=function(){this.percent>=this.targetPercentage&&(this.markerComplete.visible=!0,this.targetPassed=!0)},n.prototype.isTargetReached=function(){return this.targetPassed},n.prototype.addTargetMarker=function(){this.marker=new t.Sprite.fromFrame(this.settings.targetImage),this.marker.anchor.x=.5,this.marker.y=e.Coords.y(10),this.marker.x=this.settings.frameBorderWidth+this.targetPercentage*this.settings.meterWidth,this.markerComplete=new t.Sprite.fromFrame(this.settings.targetReachedImage),this.markerComplete.x=-e.Coords.x(25),this.markerComplete.y=e.Coords.y(35),this.markerComplete.visible=!1,this.marker.addChild(this.markerComplete),this.addChild(this.marker)},n.prototype.addText=function(){var i={font:"bold "+Math.floor(40*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#000000",strokeThickness:e.Coords.x(3)};this.stringTarget=new t.Text("Target:",i),this.stringTargetValue=new t.Text(this.settings.target,i),this.stringTarget.x=-this.stringTarget.width-e.Coords.x(10),this.stringTarget.y=-e.Coords.y(20),this.stringTargetValue.anchor.x=.5,this.stringTargetValue.x=this.stringTarget.width/2,this.stringTargetValue.y=this.stringTarget.height,this.stringTarget.addChild(this.stringTargetValue),this.addChild(this.stringTarget),this.stringCurrentDamage=new t.Text("Damage: 0",i),this.stringCurrentDamage.anchor.x=.5,this.stringCurrentDamage.x=this.frame.width/2,this.stringCurrentDamage.y=-e.Coords.y(45),this.addChild(this.stringCurrentDamage)},n.prototype.toggleText=function(t){this.stringCurrentDamage.visible=t,this.stringTarget.visible=t,this.stringTargetValue.visible=t},n.prototype.getTotalDamage=function(){return this.totalDamage},n}),define("loadingscreen",["pixi","absolute","absolute/stringmanager","absolute/uibuilder","damagemeter"],function(t,e,i,n,o){var r=function(t,e){this.initLoadingScreen(t,e)};return r.prototype=Object.create(e.Screen.prototype),r.prototype.initLoadingScreen=function(t,i){e.Screen.call(this),this.ui=t,this.game=i,this.width=parseInt(this.ui.width),this.height=this.ui.height,this.contents=n.buildLayout("LoadingScreen",this),this.progressBar=new o({target:null,frameImage:"meter_loading.png",fillImage1:"meter_loading_fill.png",fillImage2:"meter_loading_fill.png"}),this.progressBar.x=(this.ui.width-this.progressBar.width)/2,this.progressBar.y=(this.ui.height-this.progressBar.height)/2,this.contents.widgets.loadingText.y=this.progressBar.y-1.5*this.contents.widgets.loadingText.height,this.contents.addChild(this.progressBar),this.addChild(this.contents)},r.prototype.updateLoadingProgress=function(t){this.progressBar&&this.progressBar.setProgressByPercent(t)},r.prototype.onShow=function(){e.Screen.prototype.onShow.call(this)},r.prototype.onHide=function(){e.Screen.prototype.onHide.call(this)},r}),define("levelitem",["pixi","absolute","lodash"],function(t,e,i){var n=function(t,e){var n={cardImage:"level-card.png",itemImage:"",id:1,profit:0,width:0,height:0};this.initLevelItem(i.extend(n,t),e)};return n.prototype=Object.create(e.Button.prototype),n.prototype.initLevelItem=function(i,n){this.settings=i,this.callback=n,this.settings.locked&&(this.settings.cardImage="level-card-locked.png"),this.nameLetterStyle={font:"bold "+Math.floor(70*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#704700",strokeThickness:e.Coords.x(10)},this.profitLetterStyle={font:"bold "+Math.floor(60*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#155876",strokeThickness:e.Coords.x(10)},e.Button.call(this,t.Texture.fromFrame(this.settings.cardImage),t.Texture.fromFrame(this.settings.cardImage),this.handleSelect.bind(this),!0,!0),this.settings.locked?this.interactive=!1:(this._addItemImage(),this._addProfitLabel(),this._addNameLabel())},n.prototype.unlock=function(){return this.settings.locked?(this.settings.locked=!1,this.settings.cardImage="level-card.png",this.setTexture(new t.Texture.fromFrame(this.settings.cardImage)),this.updateHover(new t.Texture.fromFrame(this.settings.cardImage)),this.interactive=!0,this._addItemImage(),this._addProfitLabel(),void this._addNameLabel()):!1},n.prototype._addItemImage=function(){var i=e.StorageManager.fetch(this.settings.id+"_grab");if(i){var n=new Image;n.src=i;var o=new t.BaseTexture(n),r=new t.Texture(o),s=new t.Sprite(r);s.width=e.Coords.x(348),s.height=e.Coords.y(232),s.x=e.Coords.x(18),s.y=e.Coords.y(104),this.addChild(s),n.onload=function(){var e=new t.BaseTexture(n,t.scaleModes.LINEAR);s.texture=new t.Texture(e)}}},n.prototype._addProfitLabel=function(){this.settings.profit<0&&(this.profitLetterStyle.fill="#ff2300");var i=new t.Text("$"+this.settings.profit.toString(),this.profitLetterStyle);i.position.x=(this.width-i.width)/2,i.position.y=e.Coords.y(345),this.addChild(i)},n.prototype._addNameLabel=function(){var i=this.settings.id.toString();10==this.settings.id&&(i="8");var n=new t.Text(i,this.nameLetterStyle);n.x=(this.width-n.width)/2,n.y=e.Coords.y(10),10==this.settings.id&&(n.rotation=Math.PI/2,n.x=e.Coords.x(235),n.y=e.Coords.y(25)),this.addChild(n)},n.prototype.handleSelect=function(){this.callback(this)},n}),define("tutorials",["absolute"],function(t){return{getConfig:function(){return{help:[{dialog:{width:t.Coords.x(1600),type:"text",headline:"Who is Flakboy?",content:"This is subject no. 451, codename: Flakboy. This guy can take a lot of damage, so he's going to be your, er, volunteer for the day as we test out some new weaponry."},arrows:[]},{dialog:{width:t.Coords.x(1600),type:"text",headline:"How to Play",content:"Purchase weapons from the weapon store, and place them on the walls, floor and ceiling. Your goal is to reach the damage target for each level while staying profitable. So watch your budget!"},arrows:[]}],tortureChamber:[{dialog:{width:t.Coords.x(1800),y:t.Coords.y(50),type:"text",headline:"How to Play",content:"This is subject no. 451, codename: Flakboy. This guy can take a lot of damage, so he's going to be your, er, volunteer for the day as we test out some new weaponry."},arrows:[]},{dialog:{width:t.Coords.x(1500),type:"text",headline:"Weapons Shop",content:"Click this button to shop. Here you'll find all the tools you need to inflict copious amounts of damage on Flakboy."},arrows:[{x:t.Coords.x(800),y:t.Coords.y(1150),rotation:Math.PI}]}],weaponsShop1:[{dialog:{width:t.Coords.x(1100),x:t.Coords.x(900),type:"text",content:"Click on the mine to buy it, then drag it on to the ground near Flakboy."},arrows:[]}],weaponsShop2:[{dialog:{width:t.Coords.x(1500),type:"text",content:"Now buy a turret and place it on one of the walls."},arrows:[{x:t.Coords.x(800),y:t.Coords.y(900),rotation:Math.PI}]}],duck:[{dialog:{width:t.Coords.x(1100),type:"text",content:"Finally, click the duck button and place the ducky next to Flakboy... these things repulse him."},arrows:[{x:t.Coords.x(1425),y:t.Coords.y(1050),rotation:Math.PI}]}],duckGo:[{dialog:{width:t.Coords.x(1100),type:"text",content:"Now click GO and let the fun begin! Press STOP when you think Flakboy has had enough."},arrows:[{x:t.Coords.x(1425),y:t.Coords.y(1050),rotation:Math.PI}]}],fail:[{dialog:{width:t.Coords.x(1100),type:"text",headline:"How to Play",content:"You haven't reached your damage target, but that's okay. Play around a bit with the weaponry you have available in your budget and you'll get there."},arrows:[]}]}}}}),define("tutorial",["pixi","absolute","lodash"],function(t,e,i){var n=function(t,n){n=n||{};var o={queue:[],textStyle:{font:Math.floor(80*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"white",align:"center",wordWrap:!0,padding:e.Coords.y(60)},pageIndicators:{empty:"btn_main_pagepip_empty.png",full:"btn_main_pagepip_full.png"},closeCallback:function(){}};this.initTutorial(t,i.extend(o,n))};return n.prototype=Object.create(t.DisplayObjectContainer.prototype),n.prototype.initTutorial=function(e,i){t.DisplayObjectContainer.call(this),this.ui=e,this.options=i,this.queue=[],this.localStorageKey="tutorial"},n.prototype.hasBeenShown=function(t){t=t||this.options.name;var n=e.GameConfig.getVal(this.localStorageKey)||{},o=!1;return i.has(n,t)?o=n[t]:(n[t]=!0,e.GameConfig.setVal(this.localStorageKey,n)),o},n.prototype.getState=function(){return e.GameConfig.getVal(this.localStorageKey)||{}},n.prototype.setState=function(t,i){var n=this.getState();n[i||this.options.name]=t,e.GameConfig.setVal(this.localStorageKey,n)},n.prototype.start=function(t){return t&&this.setState(!1),this.hasBeenShown()?(this.stop(),!1):(this.queue=i.clone(this.options.queue),void this._next())},n.prototype.stop=function(t){this.queue=[],this.setState(!0),t&&this.dialog&&this.dialog.close(),this.dialog=null},n.prototype._next=function(){if(this.currentPage=this.queue.shift(),"undefined"==typeof this.currentPage)return void this.stop(!0);var t=this._getContent(this.currentPage),i={content:t,width:this.currentPage.dialog.width,height:t.height,x:this.currentPage.dialog.x||(this.ui.width-this.currentPage.dialog.width)/2,y:this.currentPage.dialog.y||(this.ui.height-t.height)/2,callbacks:{onClose:this.stop.bind(this)},images:{topLeft:e.AssetMap("dialogNineSlice.topLeft"),topCenter:e.AssetMap("dialogNineSlice.topCenter"),topRight:e.AssetMap("dialogNineSlice.topRight"),middleLeft:e.AssetMap("dialogNineSlice.middleLeft"),middleCenter:e.AssetMap("dialogNineSlice.middleCenter"),middleRight:e.AssetMap("dialogNineSlice.middleRight"),bottomLeft:e.AssetMap("dialogNineSlice.bottomLeft"),bottomCenter:e.AssetMap("dialogNineSlice.bottomCenter"),bottomRight:e.AssetMap("dialogNineSlice.bottomRight"),close:e.AssetMap("dialogNineSlice.close")}};this.dialog?this.dialog.updateDialog(i):(this.dialog=new e.Dialog(this.ui,i),this.dialog.open())},n.prototype._getContent=function(i){var n,o,r=new t.DisplayObjectContainer;switch(i.dialog.type){case"text":this.options.textStyle.wordWrapWidth=this.currentPage.dialog.width-2*this.options.textStyle.padding,o=new t.Text(i.dialog.content,this.options.textStyle),i.dialog.headline&&(n=new t.Text(i.dialog.headline,this.options.textStyle));break;case"image":o=t.Sprite.fromFrame(i.dialog.content)}o.position.x=o.position.y=this.options.textStyle.padding,n&&(n.x=(this.currentPage.dialog.width-n.width)/2,n.y=this.options.textStyle.padding,o.y=o.y+this.options.textStyle.padding+n.height,r.addChild(n)),r.addChild(o);for(var s=0;s<i.arrows.length;s++){var a=t.Sprite.fromFrame("tutorial_arrow.png");a.position.x=i.arrows[s].x,a.position.y=i.arrows[s].y,a.rotation=i.arrows[s].rotation,r.addChild(a)}r.width=e.Coords.x(100),r.height=e.Coords.y(100),this.layout=e.UIBuilder.buildLayout("tutorial",r,this),this.layout.widgets.ok.position.x=(i.dialog.width-this.layout.widgets.ok.width)/2,this.layout.widgets.ok.position.y=o.position.y+o.height+this.options.textStyle.padding,r.addChild(this.layout);var h=0;if(this.options.queue.length>1){var l=new e.PageIndicator(this.options.queue.length,this.options.queue.length-this.queue.length-1);l.position.y=this.layout.widgets.ok.position.y+this.layout.widgets.ok.height+this.options.textStyle.padding,l.position.x=(i.dialog.width-l.width)/2,h=l.height,r.addChild(l)}return r.height=this.options.textStyle.padding+o.height+this.options.textStyle.padding+this.layout.widgets.ok.height+this.options.textStyle.padding,n&&(r.height+=n.height+this.options.textStyle.padding),h>0&&(r.height+=h+this.options.textStyle.padding),r},n.prototype.handleOkButton=function(){this.layout.widgets.ok.interactive=!1,this._next()},n}),define("optionsmenu",["pixi","absolute","absoluteaudio","lodash","tutorials","tutorial"],function(t,e,i,n,o,r){var s=function(t,i,o){var r=e.AssetMap,s={name:"optionsMenu",width:e.Coords.x(1200),height:e.Coords.x(950),images:{topLeft:r("dialogNineSlice.topLeft"),topCenter:r("dialogNineSlice.topCenter"),topRight:r("dialogNineSlice.topRight"),middleLeft:r("dialogNineSlice.middleLeft"),middleCenter:r("dialogNineSlice.middleCenter"),middleRight:r("dialogNineSlice.middleRight"),bottomLeft:r("dialogNineSlice.bottomLeft"),bottomCenter:r("dialogNineSlice.bottomCenter"),bottomRight:r("dialogNineSlice.bottomRight"),close:r("dialogNineSlice.close")},tween:{type:"awesome",onClose:!0}};this.initOptionsScreen(t,i,n.extend(s,o))};return s.prototype=Object.create(e.Dialog.prototype),s.prototype.initOptionsScreen=function(t,i,n){this.ui=t,this.game=i,this.options=n,n.content=this._buildButtons(),e.Dialog.call(this,t,n),this.originalHeight=this.options.height||0},s.prototype._buildButtons=function(){var i=new t.DisplayObjectContainer,n=e.Coords.x(350),o=e.Coords.x(850),r=e.Coords.y(155),s=e.Coords.y(475);return i.width=this.options.width,i.height=this.options.height,this.buttonLayout=e.UIBuilder.buildLayout("OptionsMenu",i,this),this.buttonLayout.widgets.music.x=n-this.buttonLayout.widgets.music.width/2,this.buttonLayout.widgets.help.x=n-this.buttonLayout.widgets.help.width/2,this.buttonLayout.widgets.sfx.x=o-this.buttonLayout.widgets.sfx.width/2,this.buttonLayout.widgets.main.x=o-this.buttonLayout.widgets.main.width/2,this.buttonLayout.widgets.music.y=this.buttonLayout.widgets.sfx.y=r,this.buttonLayout.widgets.help.y=this.buttonLayout.widgets.main.y=s,this.options.hideMenuButton&&(this.buttonLayout.widgets.main.visible=!1,this.buttonLayout.widgets.help.x=(this.options.width-this.buttonLayout.widgets.help.width)/2),this.buttonLayout.widgets.music.setEnabled(!e.MusicManager.isMuted()),this.buttonLayout.widgets.sfx.setEnabled(e.AudioManager.isSfxEnabled()),i.addChild(this.buttonLayout),"undefined"!=typeof window.SpilGameAPIInstance&&window.AH_show_branding?this.moreGames=window.SpilGameAPIInstance.Branding.getLink("more_games"):this.buttonLayout.widgets.moregames.visible=!1,i},s.prototype.handleMoreGames=function(){this.moreGames&&this.moreGames.action()},s.prototype.handleMusicToggle=function(){e.MusicManager.setMuted(!e.MusicManager.isMuted())},s.prototype.handleSfxToggle=function(){e.AudioManager.setSfxEnabled(!e.AudioManager.isSfxEnabled())},s.prototype.handleHelpButton=function(){var t=new r(this.ui,{name:"help",queue:o.getConfig().help});t.start(!0)},s.prototype.handleMainButton=function(){this.close(!0)
},s.prototype.open=function(){e.AudioManager.playSound("menu_open"),e.Dialog.prototype.open.call(this)},s.prototype.close=function(t){t=!!t,e.AudioManager.playSound("menu_close"),e.Dialog.prototype.close.call(this,function(){this.buttonLayout.widgets.help.destroy(!0),this.buttonLayout.widgets.main.destroy(!0),this.options.closeCallback&&this.options.closeCallback(t)}.bind(this))},s}),define("menuscreen",["pixi","absolute","lodash","gameconfig","levelitem","optionsmenu"],function(t,e,i,n,o,r){var s=function(t,e){this.initMenuScreen(t,e)};return s.prototype=Object.create(e.Screen.prototype),s.prototype.initMenuScreen=function(i,n){e.Screen.call(this),this.ui=i,this.game=n,this.originalWidth=this.ui.width,this.backgroundImage=new t.Sprite.fromFrame("BK_Flakboy_mainmenu.jpg"),this.backgroundImage.scale.x=this.backgroundImage.scale.y=this.backgroundImage.width>this.ui.width?this.ui.width/this.backgroundImage.width:this.ui.height/this.backgroundImage.height,this.background.addChild(this.backgroundImage),this.contents=new t.DisplayObjectContainer,this.contents.width=this.ui.width,this.contents.height=this.ui.height,this.layout=e.UIBuilder.buildLayout("MenuScreen",this.contents,this),this.layout.widgets.playButton.x=this.layout.widgets.playButton.x-e.Coords.x(140),this.layout.widgets.playButton.y=this.layout.widgets.playButton.y-this.layout.widgets.playButton.height-e.Coords.x(240),this.layout.widgets.optionsButton.x=this.layout.widgets.playButton.x,this.layout.widgets.optionsButton.y=this.layout.widgets.playButton.y+this.layout.widgets.playButton.height+e.Coords.y(10),this.layout.widgets.moregames.x=this.layout.widgets.playButton.x,this.layout.widgets.moregames.y=this.layout.widgets.optionsButton.y+this.layout.widgets.optionsButton.height+e.Coords.y(10),this.contents.addChild(this.layout),this.load3rdPartyButton(),this.addChild(this.contents)},s.prototype.buildLevelSelect=function(){var r=new t.Texture.fromFrame("level-card.png"),s=r.width,a=r.height,h=Math.round(this.ui.width),l=Math.round(this.backgroundImage.height-e.Coords.y(180)),u={width:h,height:l,cardScale:1*this.backgroundImage.scale.x,padding:{x:e.Coords.x(5),y:e.Coords.y(50)},itemWidth:s,itemHeight:a},c=new e.MultiPageGenerator(u),d=e.AssetMap,p={name:"levelmenu",content:"",width:h,height:l,y:e.Coords.y(0),displayCloseButton:!1,images:{topLeft:d("dialogNineSlice.topLeft"),topCenter:d("dialogNineSlice.topCenter"),topRight:d("dialogNineSlice.topRight"),middleLeft:d("dialogNineSlice.middleLeft"),middleCenter:d("dialogNineSlice.middleCenter"),middleRight:d("dialogNineSlice.middleRight"),bottomLeft:d("dialogNineSlice.bottomLeft"),bottomCenter:d("dialogNineSlice.bottomCenter"),bottomRight:d("dialogNineSlice.bottomRight"),close:d("dialogNineSlice.close")},backgroundAlpha:0};this.levels=[];var f=i.clone(n.levels,!0);i.each(f,function(t){i.extend(t,e.GameConfig.getVal("level_"+t.id)),this.levels.push(new o(t,this.handleLevelSelect.bind(this)))},this);var g=c.getPages(this.levels)[0];g.x=(h-g.width)/2,g.y=e.Coords.y(240),p.content=g,this.levelSelectDialog=new e.Dialog(this.ui,p);var m={font:"bold "+Math.floor(90*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#155876",strokeThickness:e.Coords.x(10)},y=new t.Text(e.StringManager("buttons.selectLevel"),m);y.anchor.x=.5,y.x=h/2,y.y=e.Coords.y(50);var b=new t.Texture.fromFrame("arrow.png"),v=new e.Button(b,b,this.handleBackButton.bind(this)),x=new t.Text(e.StringManager("buttons.back"),m);x.x=v.width+e.Coords.x(10),v.addChild(x),v.x=e.Coords.x(40),v.y=l+e.Coords.x(40);var w=this.getTotalProfit(),C=new t.Text(e.StringManager("headlines.totalProfit")+": $"+w.toString(),m);C.y=v.y-e.Coords.y(10),C.x=h-C.width-e.Coords.x(40),this.dialogBackground=new t.Graphics,this.dialogBackground.beginFill(6316387),this.dialogBackground.drawRect(0,0,this.ui.width,this.ui.height),this.dialogBackground.endFill(),this.levelSelectDialog.addChild(v),this.levelSelectDialog.addChild(y),this.levelSelectDialog.addChild(C)},s.prototype.getTotalProfit=function(){var t=0;return i.times(n.levels.length,function(i){var n=e.GameConfig.getVal("level_"+(i+1));n&&n.profit&&(t+=n.profit)},this),t},s.prototype.handleLevelSelect=function(t){this.removeChild(this.dialogBackground),this.levelSelectDialog.close(),e.SpriteUtils.destroyAllChildren(this.levelSelectDialog),this.levelSelectDialog=null,this.game.play(t)},s.prototype.handleBackButton=function(){this.removeChild(this.dialogBackground),this.levelSelectDialog.close()},s.prototype.onPlay=function(){e.MusicManager.stopMusic(),e.MusicManager.playMusic("mainscreen_music",!0),this.addChild(this.dialogBackground),this.levelSelectDialog.open()},s.prototype.onOptions=function(){this.optionsMenu=new r(this.ui,this.game,{hideMenuButton:!0,closeCallback:function(){this.optionsMenu=null}.bind(this)}),this.optionsMenu.open()},s.prototype.onShow=function(){this.buildLevelSelect(),e.Screen.prototype.onShow.call(this),this.ui.refreshBackground=!0},s.prototype.onHide=function(){e.Screen.prototype.onHide.call(this)},s.prototype.handlePause=function(){},s.prototype.handleResume=function(){},s.prototype.handleOrientationChange=function(t){this.contents.scale.x=this.contents.scale.y=this.ui.width/this.originalWidth,e.Screen.prototype.handleOrientationChange.call(this,t)},s.prototype.load3rdPartyButton=function(){var i,n=new t.DisplayObjectContainer;if("undefined"!=typeof window.SpilGameAPIInstance&&window.AH_show_branding){var o=window.SpilGameAPIInstance.Branding.getLogo(),r=e.Coords.x(40);if(o.image){var s=new t.ImageLoader(o.image);s.addEventListener("loaded",function(){function s(){o.action()}i=t.Sprite.fromFrame(o.image),i.scale.x=i.scale.y=e.Coords.x(404)/i.width,i.click=s,i.touchstart=s,i.x=r,i.y=this.backgroundImage.height-i.height-r,i.buttonMode=!0,i.setInteractive(!0),n.addChild(i)}.bind(this)),s.load()}}"undefined"!=typeof window.SpilGameAPIInstance&&window.AH_show_branding?this.moreGames=window.SpilGameAPIInstance.Branding.getLink("more_games"):this.layout.widgets.moregames.visible=!1,this.contents.addChild(n)},s.prototype.handleMoreGames=function(){this.moreGames&&this.moreGames.action()},s}),define("absolute/physics",["box2d","absolute/screenmetrics","lodash"],function(t,e,i){var n={world:null,pixelsPerMeter:0,ZERO:null,debugRenderer:null,initialized:!1,groundBodies:{},init:function(i,n,o,r,s){this.gravityX=n,this.gravityY=o,this.ZERO=new t.b2Vec2(0,0),this.pixelsPerMeter=s*e.getResScale(),this.renderContext=i.renderer[0].context,this.renderCanvas=i.renderer[0].view,this.debugRenderer=this.getCanvasDebugDraw(),this.debugRenderer.SetFlags(this.e_shapeBit|this.e_jointBit),null!=this.world&&t.destroy(this.world),this.createWorld(),this.setWorldXOffset(r.x),this.setWorldYOffset(r.y);this.myQueryCallback=new t.b2QueryCallback,t.customizeVTable(this.myQueryCallback,[{original:t.b2QueryCallback.prototype.ReportFixture,replacement:function(e,i){var n=t.wrapPointer(e,t.b2QueryCallback),o=t.wrapPointer(i,t.b2Fixture);return o.GetBody().GetType()!=t.b2_dynamicBody?!0:o.TestPoint(n.m_point)?(n.m_fixture=o,!1):!0}}]),this.mouseJointGroundBody=this.world.CreateBody(new t.b2BodyDef),this.initialized=!0},setPixelsPerMeter:function(t){this.pixelsPerMeter=t*e.getResScale()},buildGround:function(e,n,o,r){o=o||"Ground",r=r||o+"_"+(1e3*Math.random()).toString();var s=new t.b2BodyDef,a=this.world.CreateBody(s),h=new t.b2EdgeShape,l=new t.b2FixtureDef;h.Set(new t.b2Vec2(e.x,e.y),new t.b2Vec2(n.x,n.y)),l.set_shape(h),l.set_density(1),l.set_friction(1),l.set_restitution(0);var u=l.get_filter();return u.set_categoryBits(16),l.set_filter(u),a.CreateFixture(l),i.isString(o)?a.userData={type:o,name:r}:(a.userData=o,a.userData.name=r),this.groundBodies[r]=a,a},resetWorld:function(){i.each(this.groundBodies,function(t){this.world.DestroyBody(t)},this),this.groundBodies={},t.destroy(this.world),this.createWorld()},createWorld:function(){this.world=new t.b2World(new t.b2Vec2(this.gravityX,this.gravityY)),this.world.SetDebugDraw(this.debugRenderer),this.world.SetContinuousPhysics(!0),this.mouseJointGroundBody=this.world.CreateBody(new t.b2BodyDef)},startMouseJoint:function(e){if(null==this.mouseJoint){var i=new t.b2AABB,n=.001;if(i.set_lowerBound(new t.b2Vec2(e.x-n,e.y-n)),i.set_upperBound(new t.b2Vec2(e.x+n,e.y+n)),this.myQueryCallback.m_fixture=null,this.myQueryCallback.m_point=new t.b2Vec2(e.x,e.y),this.world.QueryAABB(this.myQueryCallback,i),this.myQueryCallback.m_fixture){var o=this.myQueryCallback.m_fixture.GetBody(),r=new t.b2MouseJointDef;r.set_bodyA(this.mouseJointGroundBody),r.set_bodyB(o),r.set_target(new t.b2Vec2(e.x,e.y)),r.set_maxForce(5e3*o.GetMass()),r.set_collideConnected(!0),this.mouseJoint=t.castObject(this.world.CreateJoint(r),t.b2MouseJoint),o.SetAwake(!0)}}},stopMouseJoint:function(){null!=this.mouseJoint&&(this.world.DestroyJoint(this.mouseJoint),this.mouseJoint=null)},moveMouseJoint:function(e){this.mouseJoint&&this.mouseJoint.SetTarget(new t.b2Vec2(e.x,e.y))},step:function(){this.world.Step(1/60,8,3)},worldToScreenX:function(t){return t*this.pixelsPerMeter+this.getWorldXOffset()},worldToScreenY:function(t){return t*-this.pixelsPerMeter+this.getWorldYOffset()},screenToWorldX:function(t){return(t-this.getWorldXOffset())/this.pixelsPerMeter},screenToWorldY:function(t){return(t-this.getWorldYOffset())/-this.pixelsPerMeter},setWorldXOffset:function(t){this.worldXOffset=t},setWorldYOffset:function(t){this.worldYOffset=t},getWorldXOffset:function(){return this.worldXOffset},getWorldYOffset:function(){return this.worldYOffset},debugDraw:function(){this.renderContext.save(),this.renderContext.resetTransform(),this.renderContext.translate(this.worldXOffset,this.worldYOffset),this.renderContext.scale(1,-1),this.renderContext.scale(this.pixelsPerMeter,this.pixelsPerMeter),this.renderContext.lineWidth/=this.pixelsPerMeter,this.drawAxes(this.renderContext),this.renderContext.fillStyle="rgb(255,255,0)",this.world.DrawDebugData(),this.renderContext.restore()},e_shapeBit:1,e_jointBit:2,e_aabbBit:4,e_pairBit:8,e_centerOfMassBit:16,copyVec2:function(e){return new t.b2Vec2(e.get_x(),e.get_y())},scaleVec2:function(t,e){t.set_x(e*t.get_x()),t.set_y(e*t.get_y())},scaledVec2:function(e,i){return new t.b2Vec2(i*e.get_x(),i*e.get_y())},drawAxes:function(t){t.strokeStyle="rgb(192,0,0)",t.beginPath(),t.moveTo(0,0),t.lineTo(1,0),t.stroke(),t.strokeStyle="rgb(0,192,0)",t.beginPath(),t.moveTo(0,0),t.lineTo(0,1),t.stroke()},setColorFromDebugDrawCallback:function(e){var i=t.wrapPointer(e,t.b2Color),n=255*i.get_r()|0,o=255*i.get_g()|0,r=255*i.get_b()|0,s=n+","+o+","+r;this.renderContext.fillStyle="rgba("+s+",0.5)",this.renderContext.strokeStyle="rgb("+s+")"},drawSegment:function(e,i){var n=t.wrapPointer(e,t.b2Vec2),o=t.wrapPointer(i,t.b2Vec2);this.renderContext.beginPath(),this.renderContext.moveTo(n.get_x(),n.get_y()),this.renderContext.lineTo(o.get_x(),o.get_y()),this.renderContext.stroke()},drawPolygon:function(e,i,n){for(this.renderContext.beginPath(),tmpI=0;i>tmpI;tmpI++){var o=t.wrapPointer(e+8*tmpI,t.b2Vec2);0==tmpI?this.renderContext.moveTo(o.get_x(),o.get_y()):this.renderContext.lineTo(o.get_x(),o.get_y())}this.renderContext.closePath(),n&&this.renderContext.fill(),this.renderContext.stroke()},drawCircle:function(e,i,n,o){var r=t.wrapPointer(e,t.b2Vec2),s=t.wrapPointer(n,t.b2Vec2);if(this.renderContext.beginPath(),this.renderContext.arc(r.get_x(),r.get_y(),i,0,2*Math.PI,!1),o&&this.renderContext.fill(),this.renderContext.stroke(),o){var a=this.copyVec2(r);a.op_add(this.scaledVec2(s,i)),this.renderContext.beginPath(),this.renderContext.moveTo(r.get_x(),r.get_y()),this.renderContext.lineTo(a.get_x(),a.get_y()),this.renderContext.stroke()}},drawTransform:function(e){var i=t.wrapPointer(e,t.b2Transform),n=i.get_p(),o=i.get_q();this.renderContext.save(),this.renderContext.translate(n.get_x(),n.get_y()),this.renderContext.scale(.5,.5),this.renderContext.rotate(o.GetAngle()),this.renderContext.lineWidth*=2,this.drawAxes(this.renderContext),this.renderContext.restore()},getCanvasDebugDraw:function(){var e=new t.b2Draw;return t.customizeVTable(e,[{original:t.b2Draw.prototype.DrawSegment,replacement:function(t,e,i,n){this.setColorFromDebugDrawCallback(n),this.drawSegment(e,i)}.bind(this)}]),t.customizeVTable(e,[{original:t.b2Draw.prototype.DrawPolygon,replacement:function(t,e,i,n){this.setColorFromDebugDrawCallback(n),this.drawPolygon(e,i,!1)}.bind(this)}]),t.customizeVTable(e,[{original:t.b2Draw.prototype.DrawSolidPolygon,replacement:function(t,e,i,n){this.setColorFromDebugDrawCallback(n),this.drawPolygon(e,i,!0)}.bind(this)}]),t.customizeVTable(e,[{original:t.b2Draw.prototype.DrawCircle,replacement:function(e,i,n,o){this.setColorFromDebugDrawCallback(o);var r=t.b2Vec2(0,0);this.drawCircle(i,n,r,!1)}.bind(this)}]),t.customizeVTable(e,[{original:t.b2Draw.prototype.DrawSolidCircle,replacement:function(t,e,i,n,o){this.setColorFromDebugDrawCallback(o),this.drawCircle(e,i,n,!0)}.bind(this)}]),t.customizeVTable(e,[{original:t.b2Draw.prototype.DrawTransform,replacement:function(t,e){this.drawTransform(e)}.bind(this)}]),e}};return n}),define("absolute/physicsshape",["pixi","box2d","absolute/physics","absolute/screenmetrics","absolute/platform","absolute/debug"],function(t,e,i,n,o,r){var s=function(t,e,i){this._initPhysicsShape(t,e,i)};return s.constructor=s,s.prototype=Object.create(t.Sprite.prototype),s.prototype._initPhysicsShape=function(e,i,n){this.id=e;var s=e+".png";t.Sprite.call(this,t.Texture.fromFrame(s)),this.config=i,this.anchor.x=.5,this.anchor.y=.5,this.parentScale=n||1,this.collided=!1,this.interactive=!0,this.buttonMode=!0,this.dragging=!1,o.supportsTouch()&&r.enabled?(this.touchstart=this._onGrab,this.touchend=this.touchendoutside=this._onDrop,this.touchmove=this._onMove):r.enabled&&(this.mousedown=this._onGrab,this.mouseup=this.mouseupoutside=this._onDrop,this.mousemove=this._onMove),this.attachments=[]},s.prototype._onGrab=function(e){e.originalEvent.preventDefault(),this.dragging=!0,this.body||this.letsGetPhysical(),i.startMouseJoint(new t.Point(i.screenToWorldX(e.global.x),i.screenToWorldY(e.global.y)))},s.prototype._onMove=function(e){this.dragging&&(e.originalEvent.preventDefault(),i.moveMouseJoint(new t.Point(i.screenToWorldX(e.global.x),i.screenToWorldY(e.global.y))))},s.prototype._onDrop=function(t){this.dragging&&(t.originalEvent.preventDefault(),i.stopMouseJoint())},s.prototype.addAttachment=function(t){this.attachments.push(t)},s.prototype.isAttached=function(t){return-1!==this.attachments.indexOf(t)},s.prototype.letsGetPhysical=function(t,n,o,r){if(!this.body){var s=new e.b2BodyDef;if(s.set_type(n||o?e.b2_kinematicBody:e.b2_dynamicBody),s.set_position(new e.b2Vec2(0,0)),this.body=i.world.CreateBody(s),t){var a=new e.b2FixtureDef;if(r=r||{density:2,friction:.25,bounce:0},a.set_density(r.density),a.set_friction(r.friction),a.set_restitution(r.bounce),a.set_shape(this.config),n&&a.set_isSensor(n),"undefined"!=typeof r.category){var h=a.get_filter();h.set_categoryBits(r.category),a.set_filter(h)}if("undefined"!=typeof r.maskBits){var h=a.get_filter();h.set_maskBits(r.maskBits),a.set_filter(h)}this.body.CreateFixture(a)}else for(var l=0;l<this.config.length;l+=1){var a=new e.b2FixtureDef;if(a.set_shape(this.buildShapeFromVertices(this.config[l].shape,this.parentScale)),a.set_density(this.config[l].density),a.set_friction(this.config[l].friction),a.set_restitution(this.config[l].bounce),r&&"undefined"!=typeof r.category){var h=a.get_filter();h.set_categoryBits(r.category),a.set_filter(h)}this.body.CreateFixture(a)}var u=new e.b2Vec2(0,0);u.Set(i.screenToWorldX(this.position.x*this.parentScale),i.screenToWorldY(this.position.y*this.parentScale)),this.body.SetTransform(u,-this.rotation),this.body.SetAwake(1),this.body.userData=this}},s.prototype.setActive=function(t){return this.body?this.body.SetActive(t?1:0):!1},s.prototype.isActive=function(){return this.body?this.body.IsActive():!1},s.prototype.buildShapeFromVertices=function(t){for(var o=new e.b2PolygonShape,r=e.allocate(4*t.length,"float",e.ALLOC_STACK),s=0,a=0;a<t.length;a+=2)e.setValue(r+s,(n.getResScale()*this.parentScale*t[a]-this.width*this.parentScale/2)/i.pixelsPerMeter,"float"),e.setValue(r+(s+4),(n.getResScale()*this.parentScale*t[a+1]-this.height*this.parentScale/2)/i.pixelsPerMeter,"float"),s+=8;var h=e.wrapPointer(r,e.b2Vec2);return o.Set(h,t.length/2),o},s.prototype.update=function(){if(this.body){var t=this.body.GetPosition(),e=this.body.GetAngle();this.position.x=i.worldToScreenX(t.get_x())/this.parentScale,this.position.y=i.worldToScreenY(t.get_y())/this.parentScale,this.rotation=-e}},s.prototype.setX=function(t){this.body&&this.body.GetPosition().set_x(i.screenToWorldX(t*this.parentScale)),this.position.x=t},s.prototype.setY=function(t){this.body&&this.body.GetPosition().set_y(i.screenToWorldX(t*this.parentScale)),this.position.y=t},s.prototype.setRotation=function(t){if(this.body){var e=this.body.GetTransform();this.body.SetTransform(e.get_p(),-t)}this.rotation=t},s.prototype.getTop=function(){return this.body.GetFixtureList().GetAABB().get_upperBound().get_y()},s.prototype.getBottom=function(){return this.body.GetFixtureList().GetAABB().get_lowerBound().get_y()},s.prototype.hasCollided=function(){return this.collided||(this.collided=0!==this.body.GetContactList().a),this.collided},s}),define("text!flakboyshapes.json",[],function(){return'	{ \n		\n		"head_base_001": [\n			\n				{\n					"density": 0.2, "friction": 1, "bounce": 0.5, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   150, 33  ,  151, 160  ,  129, 188  ,  86, 196  ,  43, 186  ,  22, 162  ,  30, 31  ,  91, -1  ]\n				}  \n		]\n		\n		, \n		"LeftLowerArm_001": [\n			\n				{\n					"density": 5, "friction": 1, "bounce": 0, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   10, -1  ,  37, 36  ,  28, 43  ,  -1, 8  ,  2, 1  ]\n				}  \n		]\n		\n		, \n		"LeftLowerLeg_001": [\n			\n				{\n					"density": 5, "friction": 1, "bounce": 0, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   21, 6  ,  18, 50  ,  12, 53  ,  5, 51  ,  1, 6  ,  11, 0  ]\n				}  \n		]\n		\n		, \n		"LeftUpperArm_001": [\n			\n				{\n					"density": 5, "friction": 1, "bounce": 0, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   26, 32  ,  0, 9  ,  3, 0  ,  35, 23  ,  33, 32  ]\n				}  \n		]\n		\n		, \n		"LeftUpperLeg_001": [\n			\n				{\n					"density": 5, "friction": 1, "bounce": 0, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   8, 38  ,  0, 9  ,  3, 0  ,  12, 0  ,  24, 34  ,  21, 43  ]\n				}  \n		]\n		\n		, \n		"RightLowerArm_001": [\n			\n				{\n					"density": 5, "friction": 1, "bounce": 0, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   35, 10  ,  9, 41  ,  0, 38  ,  20, 0  ,  35, 1  ]\n				}  \n		]\n		\n		, \n		"RightLowerLeg_001": [\n			\n				{\n					"density": 5, "friction": 1, "bounce": 0, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   0, 24  ,  0, 6  ,  5, 0  ,  18, 1  ,  22, 7  ,  15, 52  ,  2, 49  ]\n				}  \n		]\n		\n		, \n		"RightUpperArm_001": [\n			\n				{\n					"density": 5, "friction": 1, "bounce": 0, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   34, 11  ,  9, 32  ,  2, 32  ,  1, 22  ,  6, 17  ,  26, 0  ,  35, 3  ]\n				}  \n		]\n		\n		, \n		"RightUpperLeg_001": [\n			\n				{\n					"density": 5, "friction": 1, "bounce": 0, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   23, 13  ,  12, 43  ,  0, 40  ,  12, 0  ,  21, 0  ]\n				}  \n		]\n		\n		, \n		"body_001": [\n			\n				{\n					"density": 0.5, "friction": 1, "bounce": 0, \n					"filter": { "categoryBits": 1, "maskBits": 65535 },\n					"shape": [   27, 99  ,  6, 57  ,  0, 24  ,  19, 5  ,  84, 0  ,  97, 27  ,  87, 60  ,  63, 105  ]\n				}  \n		]\n		\n	}'}),define("text!flakboyjoints.json",[],function(){return'[\n    {\n        "bodyA":"head_base_001",\n        "bodyB":"body_001",\n        "lowerAngle": -45,\n        "upperAngle": 45,\n        "motor": {\n            "torque": 1,\n            "speed": 0\n        }\n    },\n    {\n        "bodyA": "body_001",\n        "bodyB": "LeftUpperLeg_001",\n        "lowerAngle": -45,\n        "upperAngle": 45,\n        "motor": {\n            "torque": 1,\n            "speed": 0\n        }\n    },\n    {\n        "bodyA": "LeftUpperLeg_001",\n        "bodyB": "LeftLowerLeg_001",\n        "lowerAngle": -5,\n        "upperAngle": 5,\n        "motor": {\n            "torque": 200,\n            "speed": 0\n        }\n    },\n    {\n        "bodyA": "body_001",\n        "bodyB": "RightUpperLeg_001",\n        "lowerAngle": 45,\n        "upperAngle": -45,\n        "motor": {\n            "torque": 1,\n            "speed": 0\n        }\n    },\n    {\n        "bodyA": "RightUpperLeg_001",\n        "bodyB": "RightLowerLeg_001",\n        "lowerAngle": 5,\n        "upperAngle": -5,\n        "motor": {\n            "torque": 200,\n            "speed": 0\n        }\n    },\n    {\n        "bodyA": "body_001",\n        "bodyB": "LeftUpperArm_001",\n        "lowerAngle": -70,\n        "upperAngle": 70,\n        "motor": {\n            "torque": 1,\n            "speed": 1\n        }\n    },\n    {\n        "bodyA": "LeftUpperArm_001",\n        "bodyB": "LeftLowerArm_001",\n        "lowerAngle": -70,\n        "upperAngle": 70,\n        "motor": {\n            "torque": 1,\n            "speed": 1\n        }\n    },\n    {\n        "bodyA": "body_001",\n        "bodyB": "RightUpperArm_001",\n        "lowerAngle": -35,\n        "upperAngle": 35,\n        "motor": {\n            "torque": 4,\n            "speed": 1\n        }\n\n    },\n    {\n        "bodyA": "RightUpperArm_001",\n        "bodyB": "RightLowerArm_001",\n        "lowerAngle": -35,\n        "upperAngle": 35,\n        "motor": {\n            "torque": 4,\n            "speed": 1\n        }\n    }\n]'}),define("objectpool",["pixi","absolute","lodash"],function(t,e,i){var n=function(t,e){this.initObjectPool(t,e)};return n.prototype.initObjectPool=function(t,e,n){this.create=t,this.debugName=n||"unkown",this.pool=[],this.used=[],this.itemsCreated=0,i.times(e,function(){this.pool.push(this.create())},this)},n.prototype.get=function(){if(this.pool.length>0){var t=this.pool.shift();return t.poolIndex=this.itemsCreated,this.used.push(t),this.itemsCreated=this.itemsCreated+1,t}var i=this.create();return i.poolIndex=this.itemsCreated,this.used.push(i),this.itemsCreated=this.itemsCreated+1,e.Debug.log("WARNING: ran out of pooled objects. of type ",this.debugName),i},n.prototype.release=function(t){this.pool.push(this.used[t]),this.used[t]=null},n}),define("flaksplat",["pixi","absolute","lodash"],function(t,e){var i=function(t){this.initFlakSplat(t)};return i.prototype=Object.create(t.Sprite.prototype),i.prototype.initFlakSplat=function(i){t.Sprite.call(this,this.getBaseTexture()),this.onComplete=i,this.alpha=e.RandomUtils.getRandomIntFromRange(25,100)/100,this.scale.x=this.scale.y=e.RandomUtils.getRandomIntFromRange(100,200)/100,this.anchor.x=.5,this.anchor.y=1,this.visible=!1},i.prototype.getBaseTexture=function(){return t.Texture.fromFrame("flak"+e.RandomUtils.getRandomIntFromRange(1,6)+".png")},i.prototype.play=function(){this.visible=!0,this.onComplete(this)},i}),define("bodypart",["pixi","absolute","absolute/physics","absolute/physicsshape","objectpool","lodash","flaksplat"],function(t,e,i,n,o,r,s){var a=function(t,e,i,n,o,r,s){this.initBodyPart(t,e,i,n,o,r,s)};return a.prototype=Object.create(n.prototype),a.prototype.initBodyPart=function(e,i,o,r,s,a,h){n.call(this,e,i,s),this.partType=a,this.ragdoll=h,this.joints=[],this.setX(o),this.setY(r),this.type="Ragdoll",this.letsGetPhysical(!1,!1,!1,{category:2}),this.setActive(!0),this.name=e,this.health=140,this.detached=!1,this.bloodContainer=new t.DisplayObjectContainer,this.burnContainer=new t.DisplayObjectContainer,this.maxBurn=.25,this.makeMask(this.bloodContainer),this.makeMask(this.burnContainer),this.preLoadDamageObjects(),this.addChild(this.bloodContainer),this.addChild(this.burnContainer)},a.prototype.preLoadDamageObjects=function(){function i(){var i="boyblood",n=e.RandomUtils.getRandomIntFromRange(1,21),o=i+n+".png",r=new t.Sprite.fromFrame(o),s=e.RandomUtils.getRandomIntFromRange(10,50)/100,a=e.RandomUtils.getRandomIntFromRange(1,1.5),h=e.RandomUtils.getRandomIntFromRange(-this.width/4,this.width/4),l=e.RandomUtils.getRandomIntFromRange(-this.height/4,this.height/4);return r.x=h-r.width/2,r.y=l-r.height/2,r.scale.x=r.scale.y=a,r.alpha=s,r}function n(){var t=new s(function(){});return t.x=e.RandomUtils.getRandomIntFromRange(-this.width/3,this.width/3),t.y=e.RandomUtils.getRandomIntFromRange(-this.height/2,this.height/2),t.scale.x=t.scale.y=t.scale.x/4,t.tint=0,t.play(),t}this.bloodSpritePool=new o(i.bind(this),20,"bodyPartBlood"),this.flakSpritePool=new o(n.bind(this),20,"bodyPartFlak"),this.burnOverlay=new t.Sprite.fromFrame("burnoverlay.png"),this.burnOverlay.width=1.05*this.width,this.burnOverlay.height=this.height,this.burnOverlay.x=-this.width/2,this.burnOverlay.y=-this.height/2,this.burnContainer.addChild(this.burnOverlay),this.burnContainer.alpha=0},a.prototype.bleed=function(t,e,i,n,o,r,s){if(!s){var a=this.bloodSpritePool.get();this.bloodContainer.cacheAsBitmap=!1,this.bloodContainer.addChild(a),this.bloodContainer.cacheAsBitmap=!0,this.bloodSpritePool.release(a.poolIndex)}if(null!==n&&this.body.ApplyLinearImpulse(n,this.body.GetWorldCenter()),this.health=this.health-i<0?0:this.health-i,this.ragdoll.updateOverallHealth(i),o&&this.body.ApplyTorque(o),r){var h=this.flakSpritePool.get();this.bloodContainer.cacheAsBitmap=!1,this.bloodContainer.addChild(h),this.burnContainer.alpha<this.maxBurn&&(this.burnContainer.alpha=this.burnContainer.alpha+.05),this.bloodContainer.cacheAsBitmap=!0,this.flakSpritePool.release(h.poolIndex)}this.health<=0&&("limb-upper"===this.partType||"limb-lower"===this.partType)&&(this.destroyJoints=!0)},a.prototype.addJointReference=function(t){this.joints.push(t)},a.prototype.makeMask=function(i){var n=this.config[0].shape,o=new t.Graphics;o.beginFill(65280);for(var r=0;r<n.length;r+=2){var s=e.ScreenMetrics.getResScale()*n[r],a=e.ScreenMetrics.getResScale()*n[r+1];0==r?o.moveTo(s,a):o.lineTo(s,a)}o.scale.y=-1,o.x=-this.width/2,o.y=this.height/2,o.endFill(),i.addChild(o),i.mask=o},a.prototype.update=function(){n.prototype.update.call(this),this.destroyJoints&&!this.detached&&this.destroyAllJoints()},a.prototype.destroyAllJoints=function(){return this.detached?!1:(this.detached=!0,void r.times(this.joints.length,function(){var t=this.joints.pop();"limb-upper"===this.partType&&(this.ragdoll.updateOverallHealth(this.childBody.health),this.childBody.health=0,this.childBody.destroyJoints=!0),i.world.DestroyJoint(t)},this))},a.prototype.handleWallContact=function(t){t.isCeiling?this.ragdoll.tortureChamber.bleedWall(this.x,t.y,"Ceiling"):this.ragdoll.tortureChamber.bleedWall(t.x,this.y,"Wall"),this.ragdoll.updateOverallHealth(10)},a}),define("ragdoll",["pixi","absolute","absolute/physics","absolute/physicsshape","text!flakboyshapes.json","text!flakboyjoints.json","lodash","bodypart"],function(t,e,i,n,o,r,s,a){e.Physics=i,e.PhysicsShape=n;var h=function(t,e){this.initRagdoll(t,e)};return h.prototype=Object.create(t.DisplayObjectContainer.prototype),h.prototype.initRagdoll=function(e,i){t.DisplayObjectContainer.call(this),this.ui=e,this.tortureChamber=i,this.shapes=JSON.parse(o),this.joints=JSON.parse(r),this.health=0,this.startingHealth=1400,this.totalDamage=0,this.destroyBodies=!1,this.bodies={},this.loadAnimations()},h.prototype.beforeRender=function(){this.bodies&&s.each(this.bodies,function(t){t.update()})},h.prototype.loadAnimations=function(){var i=new e.Loader;i.loadArt(["flakboy_skeleton_1"],function(){},function(){this.animation=new t.Spine(e.Platform.artPathPrefix+"/"+e.ScreenMetrics.getResClass()+"/flakboy_skeleton_1.json"),this.animationLoaded()}.bind(this))},h.prototype.animationLoaded=function(){this.animation.x=this.tortureChamber.physicsArea.x+this.tortureChamber.physicsArea.width/2,this.animation.y=this.tortureChamber.physicsArea.y+this.tortureChamber.physicsArea.height-e.Coords.y(125),this.addChild(this.animation)},h.prototype.attachBodies=function(t){this.animation.updateTransform();for(var e=this.animation.skeleton.slots,i=0;i<e.length;i+=1){{e[i].data.name}try{var n,o=e[i].currentSpriteName,r=e[i].currentSprite,s="not_limb";"undefined"!=typeof o&&"undefined"!=typeof this.shapes[o]&&(o.toLowerCase().indexOf("lower")>-1?s="limb-lower":o.toLowerCase().indexOf("upper")>-1&&(s="limb-upper"),n=new a(o,this.shapes[o],r.worldTransform.tx,r.worldTransform.ty,this.tortureChamber.scale.x,s,this),this.health+=140,n.body.SetLinearVelocity(t),this.bodies[o]=n,this.addChild(n))}catch(h){}}},h.prototype.attachJoints=function(){s.each(this.joints,function(t){var i,n=this.bodies[t.bodyA].body,o=this.bodies[t.bodyB].body,r=this.tortureChamber.sx(this.bodies[t.bodyB].width/3),s=o.GetPosition().get_x(),a=o.GetPosition().get_y()+this.tortureChamber.sx(this.bodies[t.bodyB].height/2),h=new Box2D.b2RevoluteJointDef;t.bodyB.toLowerCase().indexOf("left")>-1?s+=r:t.bodyB.toLowerCase().indexOf("right")>-1&&(s-=r),i=new Box2D.b2Vec2(s,a),h.set_enableLimit(!0),h.set_lowerAngle(t.lowerAngle/(180/Math.PI)),h.set_upperAngle(t.upperAngle/(180/Math.PI)),t.motor&&(h.set_maxMotorTorque(t.motor.torque),h.set_motorSpeed(t.motor.speed),h.set_enableMotor(!0)),h.set_collideConnected(!1),h.Initialize(n,o,i,i);var l=e.Physics.world.CreateJoint(h);this.bodies[t.bodyB].addJointReference(l),t.bodyA.toLowerCase().indexOf("upper")>-1&&(this.bodies[t.bodyA].childBody=this.bodies[t.bodyB])},this)},h.prototype.attachFaceSprites=function(){var i=new t.Sprite.fromFrame("mouth.png"),n=new t.Sprite.fromFrame("left_eye_001.png"),o=new t.Sprite.fromFrame("right_eye_001.png"),r=new t.Sprite.fromFrame("left_eyelet_001.png"),s=new t.Sprite.fromFrame("right_eyelet_001.png"),a=this.bodies.head_base_001;i.x=-i.width/2,i.y=e.Coords.y(75),n.x=-e.Coords.x(55),n.y=e.Coords.y(45),o.x=e.Coords.x(55)-o.width,o.y=e.Coords.y(45),r.x=-e.Coords.x(85),r.y=e.Coords.y(50),s.x=e.Coords.x(85)-s.width,s.y=e.Coords.y(48),a.addChild(i),a.addChild(n),a.addChild(o),a.addChild(r),a.addChild(s)},h.prototype.updateOverallHealth=function(t){this.health=this.health-t,this.totalDamage=this.totalDamage+t,this.tortureChamber.levelManager.damageMeter.setProgress(this.totalDamage)},h.prototype.activate=function(t){0==s.size(this.bodies)?(this.attachBodies(t),this.attachJoints(),this.attachFaceSprites(),this.animation.visible=!1,this.visible=!0):s.each(this.bodies,function(){},this)},h.prototype.removeBodies=function(){s.each(this.bodies,function(t){this.removeChild(t),t.body.userData=null,i.world.DestroyBody(t.body)},this),this.bodies={},this.health=this.startingHealth,this.totalDamage=0},h.prototype.setX=function(t){this.animation.visible=!0,this.animation.x=Math.round(t)},h.prototype.setY=function(t){this.animation.y=t},h.prototype.getSnapShot=function(){var e=new t.DisplayObjectContainer;return s.each(this.bodies,function(i){if(!i.detached){var n=i.generateTexture(),o=new t.Sprite(n);o.anchor.x=o.anchor.y=.5,o.x=i.x,o.y=i.y,o.rotation=i.rotation,e.addChild(o)}},this),e.generateTexture()},h.prototype.debugGetHeadPos=function(){return s.size(this.bodies)<=0?-1:this.bodies.head_base_001.position},h.prototype.debugPrintAllPos=function(){console.log("----------------------------"),s.each(this.bodies,function(t){console.log(t.name," ",t.rotation)})},h}),define("tool",["pixi","absolute","absolute/physics","absolute/physicsshape","lodash"],function(t,e,i,n,o){var r=function(t,i){var n={ammo:5,damage:4,range:18,rateOfFire:1,name:"tool",align:"left",x:e.Coords.x(60),y:e.Coords.y(600)};this._initTool(o.extend(n,t),i)};return r.prototype=Object.create(e.Draggable.prototype),r.prototype._initTool=function(i,n){this.settings=i,this.tortureChamber=n,this.ammo=this.settings.ammo,this.lastShot=Date.now(),this.range=this.settings.range*this.tortureChamber.scale.x*(this.tortureChamber.originalGridPixels/this.tortureChamber.gridPixels),this.bulletPower=this.settings.bulletPower*this.tortureChamber.scale.x*(this.tortureChamber.originalGridPixels/this.tortureChamber.gridPixels),this.contactCount=0,this.targets=[],this.targetPointers=[],this.target={},this.targetPointer=0,this.currentOrientation="bottom",this.currentSnapArea="",this.setToolOrigin();
var o=new t.Rectangle(this.tortureChamber.physicsArea.x-e.Coords.y(10),this.tortureChamber.physicsArea.y-e.Coords.y(20),this.tortureChamber.physicsArea.width+e.Coords.x(10),this.tortureChamber.physicsArea.height+e.Coords.y(100));if(e.Draggable.call(this,this.container,o,null,null,this.onDrop,!0),this.container.updateTransform(),this.buildValidDropArea(),this.makeOrientationSensors(),this.buildGraphics(),!this.settings.boundingSprite)throw"Error: you must set a boundingSprite in the settings object.";this.setBoundingBox(this.settings.boundingSprite.width,this.settings.boundingSprite.height)},r.prototype.buildGraphics=function(){throw"Error: tools must override the buildGraphics function."},r.prototype.setToolOrigin=function(){this.container=new t.DisplayObjectContainer,this.container.x=this.settings.x,this.container.y=this.settings.y},r.prototype._onGrab=function(t){return"building"!==this.tortureChamber.state?!1:(this.removeBodies(!0),this.dropAreaGraphics.visible=!0,e.Platform.supportsTouch&&(this.collisionIndicator.visible=!0),void e.Draggable.prototype._onGrab.call(this,t,1))},r.prototype._onMove=function(t){return this.dragging?(this.orientTool(),this.snap()?(e.Draggable.prototype._onMove.call(this,t),null!==this.snapY&&(this.container.y=this.snapY),null!==this.snapX&&(this.container.x=this.snapX),this.tortureChamber.isToolOverlapping(this)?(this.settings.boundingSprite.tint=16711680,this.collisionIndicator.tint=16711680):(this.settings.boundingSprite.tint=16777215,this.collisionIndicator.tint=16777215)):(this.settings.boundingSprite.tint=16711680,this.collisionIndicator.tint=16711680,e.Draggable.prototype._onMove.call(this,t)),this.boundingBox.x=this.container.x-this.boundingBox.width/2,this.boundingBox.y=this.container.y-this.boundingBox.height/2,void(e.Debug.enabled&&this.drawDebugRect(this.boundingBox.x,this.boundingBox.y,this.boundingBox.width,this.boundingBox.height))):!1},r.prototype._onDrop=function(t){return"building"!==this.tortureChamber.state?!1:(this.dropAreaGraphics.visible=!1,this.collisionIndicator.visible=!1,null===this.getDropArea()||this.tortureChamber.isToolOverlapping(this)?this.dragging&&this.tortureChamber.removeTool(this):(this.buildPhysics(),"function"==typeof this.settings.readyCallback&&this.settings.readyCallback(this)),void("undefined"!=typeof t&&e.Draggable.prototype._onDrop.call(this,t)))},r.prototype.snap=function(){function t(t){var i=e.Coords.x("ducky"==this.settings.name?100:200),n=this.data.getLocalPosition(this.parent),o=Math.abs(n.x-t.x),r=Math.abs(n.y-t.y),s=i>o&&i>r;return s}if(this.snapping=!1,t.call(this,this.container)){var i=this.getDropArea();if(null!==i)switch(this.snapping=!0,i.name){case"bottom":case"top":this.snapY=i.y+i.height/2,this.snapX=null;break;case"left":case"right":this.snapY=null,this.snapX=i.x+i.width/2;break;case"ducky-left":case"ducky-right":this.snapY=i.y+i.height/2,this.snapX=i.x+i.width/2}}return this.snapping},r.prototype.getDropArea=function(){for(var t=0;t<this.validDropAreas.length;t++){var i=this.validDropAreas[t],n=e.Coords.x(0);if("left"===i.name||"right"===i.name||i.name.indexOf("ducky")>-1){if(i.contains(this.container.x,this.container.y))return this.currentSnapArea=i.name,i}else if(i.contains(this.boundingBox.x+this.boundingBox.width-n,this.container.y)&&i.contains(this.boundingBox.x+n,this.container.y))return this.currentSnapArea=i.name,i}return this.currentSnapArea="",null},r.prototype.isInRange=function(t){if("undefined"==typeof t||null===t)return!1;var e=t.body.GetContactList(),i=e;do{var n=i.get_contact().GetFixtureA().GetBody().userData,o=i.get_contact().GetFixtureB().GetBody().userData,r=i.get_contact();if(("undefined"!=typeof n&&"ContactSensor"==n.type||"undefined"!=typeof o&&"ContactSensor"==o.type)&&r.IsTouching())return!0;i=i.get_next()}while(0!=Box2D.getPointer(i));return!1},r.prototype.buildValidDropArea=function(){this.dropAreaGraphics=new t.Graphics,this.dropAreaGraphics.beginFill(1958205,.6),this.validDropAreas=[],o.each(this.settings.validDropAreas,function(i){var n,o,r,s,a,h,l,u,c=e.Coords.y(75),d=e.Coords.x(20),p=e.Coords.x(114),f=e.Coords.y(134);switch(i){case"top":n=d,o=d,r=this.tortureChamber.physicsArea.width,s=c;break;case"bottom":n=d,o=this.tortureChamber.physicsArea.y+this.tortureChamber.physicsArea.height-e.Coords.y(45),r=this.tortureChamber.physicsArea.width/2-e.Coords.x(210),s=c,a=this.tortureChamber.physicsArea.width/2+e.Coords.x(210),h=o,l=r,u=s;break;case"left":n=d,o=d,r=c,s=this.tortureChamber.physicsArea.height;break;case"right":n=d+this.tortureChamber.physicsArea.width-e.Coords.y(50),o=d,r=c,s=this.tortureChamber.physicsArea.height;break;case"wall":break;case"ducky-left":n=this.tortureChamber.width/2-e.Coords.x(220),o=this.tortureChamber.physicsArea.height-e.Coords.y(100),r=p,s=f;break;case"ducky-right":n=this.tortureChamber.width/2+e.Coords.x(200)-p,o=this.tortureChamber.physicsArea.height-e.Coords.y(100),r=p,s=f}var g=new t.Rectangle(n,o,r,s);g.name=i,this.validDropAreas.push(g),a&&(g=new t.Rectangle(a,h,l,u),g.name=i,this.validDropAreas.push(g),this.dropAreaGraphics.drawRect(a,h,l,u)),this.dropAreaGraphics.drawRect(n,o,r,s)},this),this.dropAreaGraphics.endFill(),this.dropAreaGraphics.visible=!1,this.addChildAt(this.dropAreaGraphics,0)},r.prototype.makeOrientationSensors=function(){var e,i,n,o,r=this.tortureChamber.physicsArea.x-this.tortureChamber.physicsPadding,s=this.tortureChamber.physicsArea.y-this.tortureChamber.physicsPadding,a=this.tortureChamber.physicsArea.width+2*this.tortureChamber.physicsPadding,h=this.tortureChamber.physicsArea.height+2*this.tortureChamber.physicsPadding;this.orientationSensors=[],n=new t.Polygon(r,s,a,s,a/2,h/2),n.name="top",i=new t.Polygon(a,s,a,h,a/2,h/2),i.name="right",o=new t.Polygon(r,h,a/2,h/2,a,h),o.name="bottom",e=new t.Polygon(r,s,a/2,h/2,r,h,r,s),e.name="left",this.orientationSensors.push(n),this.orientationSensors.push(i),this.orientationSensors.push(o),this.orientationSensors.push(e)},r.prototype.drawDebugTriangle=function(e,i,n,o,r,s){var a=new t.Graphics;a.beginFill(16711680,.5),a.moveTo(e,i),a.lineTo(n,o),a.lineTo(r,s),a.endFill(),this.addChild(a)},r.prototype.drawDebugRect=function(e,i,n,o){this.debugRect?this.debugRect.clear():(this.debugRect=new t.Graphics,this.addChild(this.debugRect)),this.debugRect.beginFill(16776192,.5),this.debugRect.drawRect(e,i,n,o),this.debugRect.endFill()},r.prototype.orientTool=function(){for(var t=0;t<this.orientationSensors.length;t++){var e=this.orientationSensors[t];if(e.contains(this.container.x,this.container.y)&&this.currentOrientation!==e.name&&this.settings.validDropAreas.indexOf(e.name)>-1){switch(e.name){case"bottom":this.container.rotation=0,this.setBoundingBox(this.settings.boundingSprite.width,this.settings.boundingSprite.height);break;case"left":this.container.rotation=Math.PI/2,this.setBoundingBox(this.settings.boundingSprite.height,this.settings.boundingSprite.width);break;case"right":this.container.rotation=-Math.PI/2,this.setBoundingBox(this.settings.boundingSprite.height,this.settings.boundingSprite.width);break;case"top":this.container.rotation=Math.PI,this.setBoundingBox(this.settings.boundingSprite.width,this.settings.boundingSprite.height)}this.currentOrientation=e.name;break}}},r.prototype.setBoundingBox=function(i,n){this.boundingBox=new t.Rectangle(this.container.x-i/2,this.container.y-n/2,i,n),e.Debug.enabled&&this.drawDebugRect(this.container.x-i/2,this.container.y-n/2,i,n),this.collisionIndicator||(this.collisionIndicator=new t.Graphics,this.collisionIndicator.beginFill(1958205,.6),this.collisionIndicator.drawCircle(0,0,e.Coords.x(300)),this.collisionIndicator.endFill(1958205,.3),this.collisionIndicator=new t.Sprite(this.collisionIndicator.generateTexture()),this.collisionIndicator.anchor.x=this.collisionIndicator.anchor.y=.5,this.collisionIndicator.visible=!1,this.container.addChildAt(this.collisionIndicator,0))},r.prototype.getBoundingBox=function(){return this.boundingBox},r.prototype.makeSensorBox=function(t,e,n,o,r,s,a){var h,l,u=new Box2D.b2BodyDef,c=new Box2D.b2FixtureDef;n=n||.5,o=o||.5,r=r||0,a="undefined"==typeof a?!0:a,s?(h=new Box2D.b2CircleShape,h.set_m_p(0,0),h.set_m_radius(n)):(h=new Box2D.b2PolygonShape,h.SetAsBox(n,o)),u.set_type(Box2D.b2_kinematicBody),u.set_position(new Box2D.b2Vec2(0,0)),l=i.world.CreateBody(u),c.set_density(2),c.set_friction(1),c.set_restitution(0),c.set_shape(h),c.set_isSensor(a),l.CreateFixture(c);var d=new Box2D.b2Vec2(i.screenToWorldX(t),i.screenToWorldY(e));return l.SetTransform(d,r),l.SetAwake(1),l.SetActive(1),"undefined"==typeof window.shapeCount&&(window.shapeCount=0),window.shapeCount++,l},r}),define("turret",["pixi","absolute","absolute/physics","absolute/physicsshape","lodash","tool"],function(t,e,i,n,o,r){var s=function(t,e){this._initTurret(t,e)};return s.prototype=Object.create(r.prototype),s.prototype._initTurret=function(t,e){r.call(this,t,e),this.casings=[],this.casingImpulse=new Box2D.b2Vec2(0,0),this.target=null,this.rateOfFire=this.settings.rateOfFire,this.ticks=0,this.barrelUpdates=0},s.prototype.buildGraphics=function(){this.base=new t.Sprite.fromFrame(this.settings.name+"_base.png"),this.barrel=new t.Sprite.fromFrame(this.settings.name+"_barrel.png"),this.cover=new t.Sprite.fromFrame(this.settings.name+"_cover.png"),this.ammoIndicators=[],this.barrel.anchor.x=this.cover.anchor.x=this.cover.anchor.y=this.base.anchor.x=this.base.anchor.y=.5,this.barrel.anchor.y=1,this.settings.boundingSprite=this.base,this.barrel.y=e.Coords.y(20),this.cover.y=e.Coords.x(10);for(var i=0;i<this.ammo+1;i++){var n=10>i+1?"000"+(i+1):"00"+(i+1),r=new t.Sprite.fromFrame(this.settings.name+"_ammocounter"+n+".png");r.anchor.x=r.anchor.y=.5,r.y=-e.Coords.y(this.settings.indicatorOffset),this.ammoIndicators.push(r)}this.currentAmmoIdicator=this.ammoIndicators[0];var s=[],n=7;o.times(n,function(e){var i=new t.Texture.fromFrame("turret_barrelfire"+e+".png");s.push(i)},this),this.fireAnimation=new t.MovieClip(s),this.fireAnimation.loop=!1,this.fireAnimation.x=-this.fireAnimation.width/2,this.fireAnimation.y=-this.barrel.height-this.fireAnimation.height,this.fireAnimation.visible=!1,this.fireLine=new t.Graphics,this.container.addChild(this.base),this.container.addChild(this.barrel),this.container.addChild(this.cover),this.container.addChild(this.currentAmmoIdicator),this.barrel.addChild(this.fireAnimation),this.barrel.addChild(this.fireLine),this.container.width=this.base.width,this.container.height=this.base.height},s.prototype.buildPhysics=function(){this.forceV=new Box2D.b2Vec2(0,0),this.rangeSensor=this.makeSensorBox(this.container.x*this.tortureChamber.scale.x,this.container.y*this.tortureChamber.scale.y,this.range,this.range,0,!0),this.rangeSensor.userData={type:"ToolSensor",handleContact:this.handleContact.bind(this),x:this.container.x,startAdjust:i.worldToScreenX(this.range)/this.tortureChamber.scale.x*.3};var t=10;this.sensorBoxSize=this.range/2/t,this.sensorBoxes=[];for(var e=0;t>e;e++){var n=this.getSensorPositionX(e),r=this.getSensorPositionY(e),s=this.makeSensorBox(n,r,this.sensorBoxSize,this.sensorBoxSize,0);s.userData={type:"ContactSensor",handleContact:this.handleContact.bind(this),id:this.settings.id+"_sb-"+e},this.sensorBoxes.push(s)}o.times(this.settings.ammo,function(){this.makeCasing()},this)},s.prototype.getBarrelRotation=function(){var t=0;switch(this.currentOrientation){case"top":t=Math.PI/2;break;case"right":t=-Math.PI;break;case"bottom":t=-Math.PI/2;break;case"left":t=0}return this.barrel.rotation+t},s.prototype.removeBodies=function(){this.rangeSensor&&(this.rangeSensor.userData=null,i.world.DestroyBody(this.rangeSensor),this.rangeSensor=null),o.each(this.sensorBoxes,function(t){i.world.DestroyBody(t),t.userData=null}),this.sensorBoxes&&(this.sensorBoxes.length=0),o.times(this.casings.length,function(){var t=this.casings.pop(),e=t.body;t.dead||(e.userData=null,i.world.DestroyBody(e))},this),this.casings.length=0,this.forceV&&(Box2D.destroy(this.forceV),this.forceV=null)},s.prototype.getSensorPositionX=function(t){return this.container.x*this.tortureChamber.scale.x+Math.cos(this.getBarrelRotation())*this.tortureChamber.py(this.range-2*t*this.sensorBoxSize)},s.prototype.getSensorPositionY=function(t){return this.container.y*this.tortureChamber.scale.y+Math.sin(this.getBarrelRotation())*this.tortureChamber.py(this.range-2*t*this.sensorBoxSize)},s.prototype.handleContact=function(t,e,i){var n=Box2D.getPointer(e.body),r=o.indexOf(this.targetPointers,n);if(!("undefined"==typeof e.name||e.detached&&t||r>=0&&t)){if("head_base_001"!==e.name)return!1;t&&"ToolSensor"===i.type?(this.contactCount++,this.targets.push(e),this.targetPointers.push(Box2D.getPointer(e.body)),("undefined"==typeof this.target||null===this.target)&&(this.target=this.targets.pop(),this.targetPointer=this.targetPointers.pop())):t||"ToolSensor"!==i.type||this.removeTarget(r,n),this.openFire=this.contactCount>0}},s.prototype.removeTarget=function(t,e){this.contactCount>0&&this.contactCount--,t>-1&&(this.targets.splice(t,1),this.targetPointers.splice(t,1)),this.contactCount>0&&this.targetPointer==e&&this.targets.length>0?(this.target=this.targets.pop(),this.targetPointer=this.targetPointers.pop()):this.contactCount<=0&&(this.target=null),this.openFire=this.contactCount>0},s.prototype.fire=function(){if(!this.tortureChamber.screen.simulate)return!1;{var t=[this.barrel.x-Math.cos(this.getBarrelRotation())*e.Coords.x(20),this.barrel.x],n=[this.barrel.y-Math.sin(this.getBarrelRotation())*e.Coords.y(20),this.barrel.y],r=this,s=e.MathUtils.distance(this.container.worldTransform.tx,this.container.worldTransform.ty,this.target.worldTransform.tx,this.target.worldTransform.ty),a=(this.tortureChamber.ragdoll.bodies,this.tortureChamber.ragdoll.bodies.head_base_001),h=Math.round(a.x)*this.tortureChamber.scale.x,l=Math.round(a.y)*this.tortureChamber.scale.y,u=Math.round(this.container.x)*this.tortureChamber.scale.x,c=Math.round(this.container.y)*this.tortureChamber.scale.y,d=Math.atan2(l-c,h-u),p=Math.round(u+Math.cos(d)*this.bulletPower),f=Math.round(c+Math.sin(d)*this.bulletPower);Math.round(u+Math.cos(this.getBarrelRotation())*this.bulletPower),Math.round(c+Math.sin(this.getBarrelRotation())*this.bulletPower)}this.forceV.set_x(i.screenToWorldX(p)),this.forceV.set_y(i.screenToWorldY(f));var g=o.sample(this.tortureChamber.ragdoll.bodies,1)[0];a.bleed(this.container.x,this.container.y,this.settings.damage,this.forceV,null,!0),"head_base_001"!==g.name&&g.bleed(0,0,0,null,null,!0),this.dropCasing=!0,("left"==this.currentOrientation||"right"==this.currentOrientation)&&(t=[this.barrel.x-Math.sin(this.getBarrelRotation())*e.Coords.x(20),this.barrel.x],n=[this.barrel.y-Math.cos(this.getBarrelRotation())*e.Coords.y(20),this.barrel.y]),this.fireLine.lineStyle(2,16711680),this.fireLine.moveTo(0,-this.barrel.height),this.fireLine.lineTo(0,-s),window.setTimeout(function(){this.fireLine.clear()}.bind(this),10),this.fireAnimation.visible=!0,this.fireAnimation.gotoAndPlay(0),this.fireAnimation.onComplete=function(){this.fireAnimation.visible=!1}.bind(this),e.AudioManager.playSound(this.settings.fireSound),new TWEEN.Tween({x:this.barrel.x,y:this.barrel.y}).easing(TWEEN.Easing.Bounce.Out).to({x:t,y:n},500).onUpdate(function(){r.barrel.x=this.x,r.barrel.y=this.y}).start(),this.currentAmmoIdicator&&(this.container.removeChild(this.currentAmmoIdicator),this.currentAmmoIdicator=this.ammoIndicators[this.ammoIndicators.length-this.ammo],this.container.addChild(this.currentAmmoIdicator)),this.tortureChamber.bleedWall(this.target.x,this.target.y,"Basic")},s.prototype.makeCasing=function(){var t,i=new Box2D.b2PolygonShape,o=this.container.x,r=this.container.y;switch(this.currentOrientation){case"top":r+=e.Coords.y(20);break;case"right":o-=e.Coords.x(20);break;case"bottom":r-=e.Coords.y(20);break;case"left":o+=e.Coords.x(20)}i.SetAsBox(.5,.25),t=new n("turret_bulletcasing",i,this.tortureChamber.scale.x),t.type="Casing",t.setX(o),t.setY(r),t.letsGetPhysical(!0,!1,!1,{density:1,friction:.2,bounce:.5,category:1,maskBits:17}),t.setActive(!1),t.visible=!1,this.casings.push(t),this.tortureChamber.tempDamageLayer.addChild(t)},s.prototype.trackTarget=function(){if("undefined"==typeof this.target||null===this.target||this.target.detached){if(this.target.detached){var t=Box2D.getPointer(this.target.body),e=o.indexOf(this.targetPointers,t);this.removeTarget(e,t)}return!1}var n=this.tortureChamber.ragdoll.bodies.head_base_001,r=Math.round(n.x)*this.tortureChamber.scale.x,s=Math.round(n.y)*this.tortureChamber.scale.y,a=Math.round(this.container.x)*this.tortureChamber.scale.x,h=Math.round(this.container.y)*this.tortureChamber.scale.y,l=Math.atan2(s-h,r-a),u=l-this.getBarrelRotation();u<-Math.PI?u+=2*Math.PI:u>Math.PI&&(u-=2*Math.PI),this.barrel.rotation+=u*this.settings.aimingSpeed,o.times(this.sensorBoxes.length,function(t){var e=this.sensorBoxes[t],n=i.screenToWorldX(this.getSensorPositionX(t)),o=i.screenToWorldY(this.getSensorPositionY(t)),r=e.GetPosition();r.Set(n,o),e.SetTransform(r,0)},this)},s.prototype.beforeRender=function(){if(this.dropCasing){var t=e.RandomUtils.getRandomIntFromRange(-10,10),i=e.RandomUtils.getRandomIntFromRange(-10,10),n=e.RandomUtils.getRandomIntFromRange(-5,5);this.casingImpulse.Set(t,i),this.dropCasing=!1,this.casings[this.ammo].visible=!0,this.casings[this.ammo].setActive(!0),this.casings[this.ammo].body.ApplyLinearImpulse(this.casingImpulse,this.casings[this.ammo].body.GetWorldCenter()),this.casings[this.ammo].body.ApplyAngularImpulse(n),this.casings[this.ammo].dropped=!0}return o.each(this.casings,function(t){if(t.dead||t.body.IsAwake()){var e=t.body.GetFixtureList(),i=e.GetRestitution();e.SetRestitution(i-.05*i),t.body.ResetMassData(),t.update()}else t.dead=!0,t.body.SetActive(!1)},this),this.ammo<=0||!this.tortureChamber.screen.simulate?!1:(this.rangeSensor&&this.openFire&&(this.ticks>this.rateOfFire&&this.isInRange(this.tortureChamber.ragdoll.bodies.head_base_001)&&(this.fire(),this.ammo=this.ammo-1,this.ticks=0),this.trackTarget()),void this.ticks++)},s}),define("turret3",["pixi","absolute","absolute/physics","absolute/physicsshape","turret","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:16,aimingSpeed:.07,bulletPower:5e4,damage:20,rateOfFire:60,range:14,name:"turret3",validDropAreas:["top","right","bottom","left"],indicatorOffset:5,fireSound:"turret_firing3"};this._initTurret3(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initTurret3=function(t,e){o.call(this,t,e)},s}),define("turret2",["pixi","absolute","absolute/physics","absolute/physicsshape","turret","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:10,aimingSpeed:.04,bulletPower:45e3,damage:15,rateOfFire:70,range:11,name:"turret2",validDropAreas:["top","right","left"],indicatorOffset:15,fireSound:"turret_firing2"};this._initTurret2(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initTurret2=function(t,e){o.call(this,t,e)},s}),define("turret1",["pixi","absolute","absolute/physics","absolute/physicsshape","turret","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:6,aimingSpeed:.01,bulletPower:4e4,damage:10,rateOfFire:80,range:8,name:"turret1",validDropAreas:["right","left"],indicatorOffset:20,fireSound:"turret_firing1"};this._initTurret1(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initTurret1=function(t,e){o.call(this,t,e)},s}),define("bloodsplat",["pixi","absolute","lodash"],function(t,e,i){var n=function(t,e){this.initBloodSplat(t,e)};return n.prototype=Object.create(t.Sprite.prototype),n.prototype.initBloodSplat=function(e,i){this.type=e,this.drips=[],this.dripCompleteCount=0,this.onCompleteCallback=i,t.Sprite.call(this,this.getBaseTexture()),this.generateDripClipTextures(),this.generateSprites()},n.prototype.getBaseTexture=function(){var i,n,o="wallblood";switch(this.type){case"Basic":i=10,n=12;break;case"Wall":i=6,n=8;break;case"Ceiling":i=9,n=12}return t.Texture.fromFrame(o+e.RandomUtils.getRandomIntFromRange(i,n)+".png")},n.prototype.generateDripClipTextures=function(){this.dripTextures=[],i.times(13,function(e){var i=new t.Texture.fromFrame("blood_drips/blood_drips_"+e+".png");this.dripTextures.push(i)},this)},n.prototype.generateSprites=function(){var n=e.RandomUtils.getRandomIntFromRange(75,150)/100,o=e.RandomUtils.getRandomIntFromRange(25,100)/100;this.dripCount=e.RandomUtils.getRandomIntFromRange(10,20),this.alpha=o,this.scale.x=this.scale.y=n,i.times(this.dripCount,function(){var i=new t.MovieClip(this.dripTextures);i.x=e.RandomUtils.getRandomIntFromRange(0,this.width),i.y=e.RandomUtils.getRandomIntFromRange(0,this.height/2),i.alpha=o,i.scale.x=e.RandomUtils.getRandomIntFromRange(25,50)/100,i.scale.y=e.RandomUtils.getRandomIntFromRange(50,150)/100,i.animationSpeed=e.RandomUtils.getRandomIntFromRange(20,100)/100,i.visible=!0,i.loop=!1,i.onComplete=this.dripComplete.bind(this),this.drips.push(i),this.addChild(i)},this)},n.prototype.dripComplete=function(){this.dripCompleteCount++,this.dripCompleteCount>=this.dripCount&&this.splatComplete()},n.prototype.splatComplete=function(){this.dripCompleteCount=0,window.setTimeout(function(){this.onCompleteCallback(this)}.bind(this),500)},n.prototype.play=function(){this.visible=!0,i.times(this.dripCount,function(t){this.drips[t].gotoAndPlay(0)},this)},n}),define("ducky",["pixi","absolute","tool","lodash"],function(t,e,i,n){var o=function(t,e){this.initDuck(t,e)};return o.prototype=Object.create(i.prototype),o.prototype.initDuck=function(t,e){t.validDropAreas=["ducky-left","ducky-right"],t.name="ducky",t.price=0,i.call(this,t,e),this.orientation=t.orientation},o.prototype.buildGraphics=function(){this.capsule=new t.Sprite.fromFrame("ducky_capsule.png"),this.ducky=new t.Sprite.fromFrame("ducky.png"),this.ducky.anchor.y=this.capsule.anchor.y=this.ducky.anchor.x=this.capsule.anchor.x=.5,this.ducky.visible=!1,this.settings.boundingSprite=this.capsule;var i=[];n.times(22,function(e){i.push(new t.Texture.fromFrame("Duck_Spawn_blast"+(e+1)+".png"))}),this.spawnBlast=new t.MovieClip(i),this.spawnBlast.loop=!1,this.spawnBlast.anchor.x=this.spawnBlast.anchor.y=.5,this.spawnBlast.visible=!1,this.spawnBlast.scale.x=this.spawnBlast.scale.y=3,this.spawnBlast.animationSpeed=.4,this.spawnBlast.x=-e.Coords.x(30),this.spawnBlast.y=-e.Coords.y(150),this.spawnBlast.onComplete=function(){this.spawnBlast.visible=!1,this.settings.duckyRevealedCallback()}.bind(this),this.container.addChild(this.ducky),this.container.addChild(this.capsule),this.container.addChild(this.spawnBlast)},o.prototype.setOrientation=function(t){this.orientation=t,this.container.scale.x=t},o.prototype.reveal=function(){return this.spawnBlast.visible=!0,this.spawnBlast.gotoAndPlay(0),e.AudioManager.playSound("duck_appears"),this.orientation},o.prototype.beforeRender=function(){this.spawnBlast.playing&&this.spawnBlast.currentFrame>11?(this.capsule.visible=!1,this.ducky.visible=!0):this.spawnBlast.playing&&this.spawnBlast.currentFrame>8&&(this.spawnBlast.scale.x=this.spawnBlast.scale.y=5,this.spawnBlast.y=-e.Coords.y(280),this.spawnBlast.x=-e.Coords.x(45))},o.prototype.reset=function(){this.ducky.visible=!1,this.capsule.visible=!0,this.spawnBlast.visible=!1,this.spawnBlast.gotoAndStop(0)},o.prototype.removeBodies=function(t){t||this.settings.removeCallback()},o.prototype.buildPhysics=function(){},o}),define("bouncer",["pixi","absolute","tool","lodash","absolute/physics","absolute/physicsshape"],function(t,e,i,n,o,r){var s=function(t,e){var i={};this.initBouncer(n.extend(i,t),e)};return s.prototype=Object.create(i.prototype),s.prototype.initBouncer=function(t,e){i.call(this,t,e),this.active=!0,this.skipWait=!1,this.contacts=[],this.ticks=0,this.TRIGGER_TICKS=80,this.LAUNCH_TICKS=40,this.RETRACTED_TICKS=30,this.state="RETRACTING"},s.prototype.buildGraphics=function(){this.dummyCover=new t.Sprite.fromFrame(this.settings.name+"_cover.png"),this.dummyCover.anchor.x=this.dummyCover.anchor.y=.5,this.dummyCover.y=0,this.settings.boundingSprite=this.dummyCover,this.poleContainer=new t.DisplayObjectContainer,this.pole=new t.Sprite.fromFrame(this.settings.name+"_pole.png"),this.pole.anchor.x=.5,this.poleMask=new t.Graphics,this.poleMask.beginFill(0),this.poleMask.drawRect(-this.pole.width/2,-this.pole.height,this.pole.width,this.pole.height),this.base=new t.Sprite.fromFrame(this.settings.name+"_hole.png"),this.base.anchor.y=this.base.anchor.x=.5,this.base.y=0,this.base.scale.x=this.base.scale.y=this.settings.baseScale,this.poleContainer.addChild(this.poleMask),this.poleContainer.addChild(this.pole),this.poleContainer.mask=this.poleMask,this.container.addChild(this.base),this.container.addChild(this.poleContainer),this.container.addChild(this.dummyCover),this.settings.showCoverLight&&(this.coverLight=new t.Sprite.fromFrame(this.settings.name+"_coverlight.png"),this.coverLight.anchor.x=.5,this.coverLight.anchor.y=.5,this.coverLight.visible=!1,this.container.addChild(this.coverLight))},s.prototype.buildPhysics=function(){this.forceV=new Box2D.b2Vec2(0,this.bulletPower),this.retractForceV=new Box2D.b2Vec2(0,-1e3*this.tortureChamber.scale.y);var t=4*this.tortureChamber.scale.x*(this.tortureChamber.originalGridPixels/this.tortureChamber.gridPixels),i=.15*this.tortureChamber.scale.y*(this.tortureChamber.originalGridPixels/this.tortureChamber.gridPixels),n=new Box2D.b2PolygonShape;n.SetAsBox(t,i),this.cover=new r(this.settings.name+"_cover",n,this.tortureChamber.scale.x),this.cover.setX(this.container.x),this.cover.setY(this.container.y-this.pole.height),this.cover.letsGetPhysical(!0),this.cover.type="Bouncer",this.cover.handleContact=this.handleContact.bind(this),this.cover.bouncer=this,this.cover.startAdjust=.05*this.cover.width;var s=this.cover.height/3,a=new Box2D.b2PrismaticJointDef;a.set_enableLimit(!0),a.set_lowerTranslation(this.tortureChamber.sx(s)),a.set_upperTranslation(this.tortureChamber.sx(this.pole.height*this.tortureChamber.scale.y)),a.Initialize(this.cover.body,o.groundBodies.groundBottom,this.cover.body.GetPosition(),new Box2D.b2Vec2(0,1)),this.bouncerJoint=e.Physics.world.CreateJoint(a),this.cover.visible=!1,this.pole.visible=!1,this.addChild(this.cover),this.pole.y=s-this.pole.height},s.prototype.removeCover=function(){this.cover.visible=!0,this.pole.visible=!0,this.dummyCover.visible=!1},s.prototype.removeBodies=function(){this.bouncerJoint&&(this.bouncerJoint.userData=null,o.world.DestroyJoint(this.bouncerJoint),this.bouncerJoint=null),this.cover&&this.cover.body&&(this.cover.body.userData=null,o.world.DestroyBody(this.cover.body),this.removeChild(this.cover),this.cover=null),this.forceV&&(Box2D.destroy(this.forceV),this.forceV=null,Box2D.destroy(this.retractForceV),this.retractForceV=null),this.pole.visible=!1,this.dummyCover.visible=!0},s.prototype._onGrab=function(t){this.dummyCover.visible=!0,i.prototype._onGrab.call(this,t)},s.prototype.handleContact=function(t,e){if("undefined"==typeof t.name||this.active!==!0||t.detached)return!1;if(e)this.contacts.push(t),this.fire();else{var i=n.indexOf(this.contacts,t);this.contacts.splice(i,1)}},s.prototype.fire=function(){return this.ammo<=0||"WAITING"!==this.state||!this.tortureChamber.screen.simulate?!1:(this.state="TRIGGERED",void(this.ticks=0))},Object.defineProperty(s.prototype,"state",{get:function(){return this.currentState},set:function(t){this.currentState=t}}),s.prototype.beforeRender=function(){if(!this.active||!this.tortureChamber.screen.simulate)return!1;if("DEPLETED"==this.state)return this.active=!1,this.dummyCover.y=this.container.y-this.cover.y,this.dummyCover.visible=!0,this.settings.showCoverLight&&(this.coverLight.visible=!0),this.removeBodies(),!1;if(this.cover&&this.pole&&(this.currentCoverY=this.cover.y,this.cover.update(),this.pole.y+=this.cover.y-this.currentCoverY),"TRIGGERED"===this.state){var t=this.ticks>=this.TRIGGER_TICKS||this.skipWait;t&&(this.skipWait=!1,this.contacts.length>0?(this.ticks=0,this.state="LAUNCHING",this.ammo--):this.state="WAITING")}if("LAUNCHING"===this.state){var i=this.ticks==this.LAUNCH_TICKS;i?(this.ticks=0,this.disableCollisions(this.cover.body),this.state="RETRACTING"):(this.cover.body.ApplyForceToCenter(this.forceV),this.ticks==this.LAUNCH_TICKS/2&&e.AudioManager.playSound("bouncer_out"))}if("RETRACTING"===this.state){var n=this.ticks==this.RETRACTED_TICKS;n?(this.ticks=0,this.ammo!=this.settings.ammo&&e.AudioManager.playSound("bouncer_in"),this.ammo<=0?this.state="DEPLETED":(this.removeCover(),this.enableCollisions(this.cover.body),this.state="WAITING")):this.cover.body.ApplyForceToCenter(this.retractForceV)}this.ticks++},s.prototype.disableCollisions=function(t){this.setFilterBits(t,8)},s.prototype.enableCollisions=function(t){this.setFilterBits(t,65535)},s.prototype.setFilterBits=function(t,e){var i=t.GetFixtureList(),n=i;do{var o=n.GetFilterData();o.set_maskBits(e),n.SetFilterData(o),n=n.GetNext()}while(0!=Box2D.getPointer(n))},s}),define("bouncer1",["pixi","absolute","absolute/physics","absolute/physicsshape","bouncer","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:5,bulletPower:14e3,name:"bouncer1",validDropAreas:["bottom"],showCoverLight:!0,baseScale:2};this._initBouncer1(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initBouncer1=function(t,e){o.call(this,t,e)},s}),define("bouncer2",["pixi","absolute","absolute/physics","absolute/physicsshape","bouncer","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:7,bulletPower:19e3,name:"bouncer2",validDropAreas:["bottom"],showCoverLight:!0,baseScale:1};this._initBouncer2(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initBouncer2=function(t,e){o.call(this,t,e)},s}),define("bouncer3",["pixi","absolute","absolute/physics","absolute/physicsshape","bouncer","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:10,bulletPower:23e3,name:"bouncer3",validDropAreas:["bottom"],showCoverLight:!1,baseScale:1};this._initBouncer3(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initBouncer3=function(t,e){o.call(this,t,e)},s}),define("mine",["pixi","absolute","tool","lodash","absolute/physics"],function(t,e,i,n,o){var r=function(t,e){var i={};this.initMine(n.extend(i,t),e)};return r.prototype=Object.create(i.prototype),r.prototype.initMine=function(t,e){i.call(this,t,e),this.active=!0,this.contacts=[]},r.prototype.buildGraphics=function(){this.mineSprite=new t.Sprite.fromFrame(this.settings.name+".png"),this.mineSprite.anchor.x=this.mineSprite.anchor.y=.5,this.settings.boundingSprite=this.mineSprite;var i=[];n.times(this.settings.blastFrames,function(e){var n=new t.Texture.fromFrame("mine_blasts/"+this.settings.animName+"_blast00"+(e+1>=10?e+1:"0"+(e+1))+".png");i.push(n)},this),this.boom=new t.MovieClip(i),this.boom.scale.x=this.boom.scale.y=8,this.boom.x=-this.boom.width/2,this.boom.y=e.Coords.y(20)-this.boom.height,this.boom.alpha=.8,this.boom.loop=!1,this.boom.visible=!1,this.boom.animationSpeed=.25,this.boom.onComplete=function(){this.visible=!1},this.container.addChild(this.boom),this.container.addChild(this.mineSprite)},r.prototype.buildPhysics=function(){this.forceV=new Box2D.b2Vec2(0,0),this.mineSensor=this.makeSensorBox(this.container.x*this.tortureChamber.scale.x,this.container.y*this.tortureChamber.scale.y,this.range,this.range,0,!1),this.mineSensor.userData={type:"ToolSensor",handleContact:this.handleContact.bind(this),x:this.container.x,startAdjust:o.worldToScreenX(this.range)/this.tortureChamber.scale.x*.05}},r.prototype.removeBodies=function(){this.mineSensor&&(o.world.DestroyBody(this.mineSensor),this.mineSensor=null),this.forceV&&(Box2D.destroy(this.forceV),this.forceV=null)},r.prototype.handleContact=function(t,e){if("undefined"==typeof e.name||this.active!==!0||e.detached)return!1;if(t)this.contacts.push(e);else{var i=n.indexOf(this.contacts,e);this.contacts.splice(i,1)}this.openFire=this.contacts.length>0},r.prototype.fire=function(){if(!this.tortureChamber.screen.simulate||!this.active)return!1;
this.mineSprite.visible=!1,this.container.removeChild(this.mineSprite),this.boom.visible=!0,this.boom.gotoAndPlay(0);var t=this.tortureChamber.ragdoll.bodies;n.each(t,function(t){if(!t.detached){var e=Math.round(t.x)*this.tortureChamber.scale.x,i=Math.round(t.y)*this.tortureChamber.scale.y,n=Math.round(this.container.x)*this.tortureChamber.scale.x,r=Math.round(this.container.y)*this.tortureChamber.scale.y,s=Math.atan2(i-r,e-n),a=Math.round(n+Math.cos(s)*this.bulletPower),h=Math.round(r+Math.sin(s)*this.bulletPower);this.forceV.set_x(o.screenToWorldX(a)),this.forceV.set_y(o.screenToWorldY(h)),t.bleed(this.container.x,this.container.y,this.settings.damage,this.forceV,null,!0)}},this),e.AudioManager.playSound(this.settings.name),this.tortureChamber.burnWall(this.container.x,this.container.y),this.active=!1},r.prototype.beforeRender=function(){!this.active&&this.mineSensor?(this.removeBodies(),this.boundingBox=null):this.openFire&&this.fire(this.contacts)},r}),define("mine1",["pixi","absolute","absolute/physics","absolute/physicsshape","mine","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:1,bulletPower:1e5,damage:6,rateOfFire:1,range:1,name:"mine1",animName:"mine1",validDropAreas:["bottom"],blastFrames:10};this._initMine1(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initMine1=function(t,e){o.call(this,t,e)},s}),define("mine2",["pixi","absolute","absolute/physics","absolute/physicsshape","mine","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:1,bulletPower:15e4,damage:10,rateOfFire:1,range:1,name:"mine2",animName:"mine4",validDropAreas:["bottom"],blastFrames:10};this._initMine2(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initMine2=function(t,e){o.call(this,t,e)},s}),define("mine3",["pixi","absolute","absolute/physics","absolute/physicsshape","mine","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:1,bulletPower:2e5,damage:15,rateOfFire:1,range:1,name:"mine3",animName:"mine2",validDropAreas:["top","bottom"],blastFrames:16};this._initMine3(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initMine3=function(t,e){o.call(this,t,e)},s}),define("mine4",["pixi","absolute","absolute/physics","absolute/physicsshape","mine","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:1,bulletPower:25e4,damage:20,rateOfFire:1,range:1,name:"mine4",animName:"mine3",validDropAreas:["top","right","bottom","left"],blastFrames:15};this._initMine4(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initMine4=function(t,e){o.call(this,t,e)},s}),define("spikes",["pixi","absolute","tool","lodash","absolute/physics","absolute/physicsshape"],function(t,e,i,n,o){var r=function(t,e){var i={};this.initSpikes(n.extend(i,t),e)};return r.prototype=Object.create(i.prototype),r.prototype.initSpikes=function(t,e){i.call(this,t,e),this.active=!0,this.ticks=0,this.SPIKE_TICKS=this.settings.spikeTime,this.RETRACT_TICKS=80,this.state="WAITING"},r.prototype.buildGraphics=function(){this.spikeContainer=new t.DisplayObjectContainer,this.spike=new t.Sprite.fromFrame(this.settings.name+"_spikes.png"),this.spike.anchor.x=.5,this.spikesMask=new t.Graphics,this.spikesMask.beginFill(0,.5),this.spikesMask.drawRect(-this.spike.width/2,0,this.spike.width,-this.spike.height),this.base=new t.Sprite.fromFrame(this.settings.name+"_base.png"),this.base.anchor.y=this.base.anchor.x=.5,this.base.y=0,this.settings.boundingSprite=this.base,this.spikeContainer.addChild(this.spikesMask),this.spikeContainer.addChild(this.spike),this.spikeContainer.mask=this.spikesMask,this.container.addChild(this.spikeContainer),this.container.addChild(this.base)},r.prototype.buildPhysics=function(){this.forceV=new Box2D.b2Vec2(0,0);var t,e,i,n;switch(this.currentOrientation){case"right":i=this.spike.height*this.tortureChamber.scale.x/2,n=this.spike.width*this.tortureChamber.scale.y/2,t=this.container.x*this.tortureChamber.scale.x-n,e=this.container.y*this.tortureChamber.scale.y;break;case"left":i=this.spike.height*this.tortureChamber.scale.x/2,n=this.spike.width*this.tortureChamber.scale.y/2,t=this.container.x*this.tortureChamber.scale.x+n,e=this.container.y*this.tortureChamber.scale.y;break;case"top":i=this.spike.width*this.tortureChamber.scale.x/2,n=this.spike.height*this.tortureChamber.scale.y/2,t=this.container.x*this.tortureChamber.scale.x,e=this.container.y*this.tortureChamber.scale.y+n}this.spikeSensor=this.makeSensorBox(t,e,this.tortureChamber.sx(i),this.tortureChamber.sx(n)),this.spikeSensor.userData={type:"ToolSensor",handleContact:this.handleContact.bind(this),x:t/this.tortureChamber.scale.x,startAdjust:o.worldToScreenX(this.range)/this.tortureChamber.scale.x*.05}},r.prototype.removeBodies=function(){this.spikeSensor&&(this.spikeSensor.userData=null,o.world.DestroyBody(this.spikeSensor),this.spikeSensor=null),this.forceV&&(Box2D.destroy(this.forceV),this.forceV=null)},r.prototype.handleContact=function(t,e,i){var o=Box2D.getPointer(e.body),r=n.indexOf(this.targetPointers,o);"undefined"==typeof e.name||e.detached&&t||r>=0&&t||(t&&"ToolSensor"===i.type?(this.contactCount++,this.targets.push(e),this.targetPointers.push(Box2D.getPointer(e.body)),("undefined"==typeof this.target||null===this.target)&&(this.target=this.targets.pop(),this.targetPointer=this.targetPointers.pop())):t||"ToolSensor"!==i.type||this.removeTarget(r,o),this.openFire=this.contactCount>0)},r.prototype.removeTarget=function(t,e){this.contactCount>0&&this.contactCount--,this.target&&(this.target.hasBleed=!1),t>-1&&(this.targets.splice(t,1),this.targetPointers.splice(t,1)),this.contactCount>0&&this.targetPointer==e&&this.targets.length>0?(this.target=this.targets.pop(),this.targetPointer=this.targetPointers.pop()):this.contactCount<=0&&(this.target=null),this.openFire=this.contactCount>0},r.prototype.updateSpikeDamage=function(){n.each(this.targets,function(t){var e=t.body,i=e.GetLinearVelocity();i.set_x("top"===this.currentOrientation?0:.9*i.get_x()),i.set_y(.3*i.get_y()),e.SetLinearVelocity(i),this.forceV.set_y(.2*e.GetMass()),t.bleed(0,0,this.settings.damage,this.forceV,null,!1,t.hasBleed),t.hasBleed=!0,e.SetAngularVelocity(0)},this)},r.prototype.fire=function(){if(!this.tortureChamber.screen.simulate)return!1;if(this.ammo<=0)return this.state="DEPLETED",!1;if("WAITING"!==this.state)return!1;this.ammo--,this.state="SPIKED",this.ticks=0,e.AudioManager.playSound(this.settings.outSound);var t=this;new TWEEN.Tween({y:0}).to({y:-this.spike.height},100).onUpdate(function(){t.spike.y=this.y}).onComplete(function(){var i=+e.Coords.x(30),n="Ceiling";bloodX=e.RandomUtils.getRandomIntFromRange(t.boundingBox.x,t.boundingBox.x+t.boundingBox.width/2),bloodY=t.boundingBox.y-i,("left"===t.currentOrientation||"right"===t.currentOrientation)&&(bloodX=t.boundingBox.x-i,bloodY=e.RandomUtils.getRandomIntFromRange(t.boundingBox.y,t.boundingBox.y+t.boundingBox.width),n="Wall"),"right"===t.currentOrientation&&(bloodX=t.boundingBox.x+i),e.AudioManager.playSound("spikes_hit"),t.tortureChamber.bleedWall(bloodX,bloodY,n)}).start()},Object.defineProperty(r.prototype,"state",{get:function(){return this.currentState},set:function(t){this.currentState=t}}),r.prototype.beforeRender=function(){if(!this.active)return!1;if("DEPLETED"==this.state)return this.active=!1,this.removeBodies(),!1;if("WAITING"===this.state&&this.openFire&&this.fire(),"SPIKED"===this.state){var t=this.ticks>this.SPIKE_TICKS;if(t||!this.openFire){this.ticks=0;var e=this;new TWEEN.Tween({y:this.spike.y}).to({y:this.spike.height},200).onUpdate(function(){e.spike.y=this.y}).start(),this.state="RETRACTING"}else this.updateSpikeDamage()}if("RETRACTING"===this.state){var i=this.ticks>this.RETRACT_TICKS;i&&(this.ticks=0,this.state="WAITING")}this.ticks++},r}),define("spikes1",["pixi","absolute","absolute/physics","absolute/physicsshape","spikes","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:5,bulletPower:100,damage:.05,name:"spikes1",spikeTime:150,validDropAreas:["top","right","left"],outSound:"spikes_out1"};this._initSpikes1(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initSpikes1=function(t,e){o.call(this,t,e)},s}),define("spikes2",["pixi","absolute","absolute/physics","absolute/physicsshape","spikes","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:5,bulletPower:100,damage:.05,name:"spikes2",spikeTime:225,validDropAreas:["top","right","left"],outSound:"spikes_out2"};this._initSpikes2(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initSpikes2=function(t,e){o.call(this,t,e)},s}),define("spikes3",["pixi","absolute","absolute/physics","absolute/physicsshape","spikes","lodash"],function(t,e,i,n,o,r){var s=function(t,e){var i={ammo:5,bulletPower:100,damage:.05,name:"spikes3",spikeTime:300,validDropAreas:["top","right","left"],outSound:"spikes_out3"};this._initSpikes3(r.extend(i,t),e)};return s.prototype=Object.create(o.prototype),s.prototype._initSpikes3=function(t,e){o.call(this,t,e)},s}),define("wallet",["absolute","lodash"],function(t,e){var i=function(t){var i={maxBalance:9999,startingBalance:600,localStorageKey:"cash"};this.initWallet(e.extend(i,t))};return i.prototype.initWallet=function(t){this.settings=t,this.localStorageKey=this.settings.localStorageKey,this.updateWalletState()},i.prototype._save=function(){t.GameConfig.setVal(this.localStorageKey,this.walletState)},i.prototype._load=function(){return t.GameConfig.getVal(this.localStorageKey)},i.prototype.updateWalletState=function(){var t=this._load();"undefined"==typeof t?(this.walletState={balance:this.settings.startingBalance},this._save()):this.walletState=t},i.prototype.setBalance=function(t){this.walletState.balance=t,this._save()},i.prototype.getBalance=function(){return this.updateWalletState(),this.walletState.balance},i.prototype.deposit=function(t){var e=this.getBalance()+t;return e<=this.settings.maxBalance&&this.setBalance(e),e},i.prototype.withdraw=function(t){var e=this.getBalance()-t;return e>=0?(this.setBalance(this.getBalance()-t),!0):!1},i}),define("storeitem",["pixi","absolute","lodash"],function(t,e,i){var n=function(t,e){var n={cardImage:"",itemImage:"",price:0,width:0,height:0};this.initStoreItem(i.extend(n,t),e)};return n.prototype=Object.create(e.Button.prototype),n.prototype.initStoreItem=function(i,n){this.settings=i,this.callback=n,this.nameLetterStyle={font:"bold "+Math.floor(40*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#704700",strokeThickness:e.Coords.x(10)},this.priceLetterStyle={font:"bold "+Math.floor(70*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#704700",strokeThickness:e.Coords.x(10)},e.Button.call(this,t.Texture.fromFrame(this.settings.cardImage),t.Texture.fromFrame(this.settings.cardImage),this.handleBuy.bind(this),!0,!0),this._addItemImage(this.settings.locked),this.settings.locked?(this.disable(!0),this.interactive=!1):(this._addPriceLabel(),this._addNameLabel())},n.prototype._addItemImage=function(t){this.itemSprite=e.Sprite.fromFrame(this.settings.itemImage);var i=1,n=1,o=e.Coords.x(270),r=e.Coords.y(170),s=1.5;n=i=this.itemSprite.height>r||this.itemSprite.height>this.itemSprite.width?Math.min(r/this.itemSprite.height,s):Math.min(o/this.itemSprite.width,s),this.itemSprite.scale.x=this.itemSprite.scale.y=Math.min(i,n),this.itemSprite.position.x=(this.width-this.itemSprite.width)/2,this.itemSprite.position.y=(this.height-this.itemSprite.height)/2,t&&(this.itemSprite.tint=0,this.itemSprite.alpha=.3),this.addChild(this.itemSprite)},n.prototype._addPriceLabel=function(){this.priceLabel=new t.Text(this.settings.price.toString(),this.priceLetterStyle),this.priceLabel.position.x=(this.width-this.priceLabel.width)/2,this.priceLabel.position.y=e.Coords.y(380),this.addChild(this.priceLabel)},n.prototype._addNameLabel=function(){var i=e.StringManager(this.settings.name).split(" "),n=i[0],o=i[1];this.nameLabel1=new t.Text(n,this.nameLetterStyle),this.nameLabel2=new t.Text(o,this.nameLetterStyle),this.nameLabel1.x=(this.width-this.nameLabel1.width)/2,this.nameLabel2.x=(this.width-this.nameLabel2.width)/2,this.nameLabel1.y=e.Coords.y(15),this.nameLabel2.y=this.nameLabel1.y+this.nameLabel1.height,this.addChild(this.nameLabel1),this.addChild(this.nameLabel2)},n.prototype.disable=function(){this.settings.locked||(this.alpha=.5)},n.prototype.enable=function(){this.alpha=1},n.prototype.handleBuy=function(){this.callback(this)},n.prototype.destroy=function(){this.nameLabel1&&this.nameLabel2&&this.priceLabel&&(this.nameLabel1.destroy(!0),this.nameLabel2.destroy(!0),this.priceLabel.destroy(!0)),e.Button.prototype.destroy.call(this)},n}),define("levelcomplete",["pixi","absolute","lodash","storeitem","gameconfig"],function(t,e,i,n,o){var r=function(t,n,o,r,s){var a=e.AssetMap,h={name:"levelmenu",content:"",width:e.Coords.x(1915),height:e.Coords.y(1450),y:e.Coords.y(44),displayCloseButton:!1,images:{topLeft:a("dialogNineSlice.topLeft"),topCenter:a("dialogNineSlice.topCenter"),topRight:a("dialogNineSlice.topRight"),middleLeft:a("dialogNineSlice.middleLeft"),middleCenter:a("dialogNineSlice.middleCenter"),middleRight:a("dialogNineSlice.middleRight"),bottomLeft:a("dialogNineSlice.bottomLeft"),bottomCenter:a("dialogNineSlice.bottomCenter"),bottomRight:a("dialogNineSlice.bottomRight"),close:a("dialogNineSlice.close")},currentLevel:1,maxLevels:10,spent:0};this.initLevelComplete(t,i.extend(h,n),o,r,s)};return r.prototype=Object.create(e.Dialog.prototype),r.prototype.initLevelComplete=function(i,n,o,r,s){this.ui=i,this.options=n,this.levelManager=o,this.flakBoyTexture=r,this.mainMenuCallback=s,this.contentContainer=new t.DisplayObjectContainer,this.nextLevelData=this.getNextLevelData(),this.headlineLetterStyle={font:"bold "+Math.floor(90*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#155876",strokeThickness:e.Coords.x(10)},this.letterStyle={font:"bold "+Math.floor(60*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#032436",strokeThickness:e.Coords.x(10)},this.letterStyle2={font:"bold "+Math.floor(45*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#032436",strokeThickness:e.Coords.x(10),wordWrap:!0},this.calculateResults(),this.buildContent(),n.content=this.contentContainer,e.Dialog.call(this,i,n)},r.prototype.calculateResults=function(){this.earnings=3*this.levelManager.damageMeter.getTotalDamage(),this.profit=this.earnings-this.options.spent,this.levelManager.saveLevelData({profit:this.profit,earnings:this.earnings})},r.prototype.buildContent=function(){var i,n,o,r=e.AssetMap,s={images:{topLeft:r("dialogNineSlice2.topLeft"),topCenter:r("dialogNineSlice2.topCenter"),topRight:r("dialogNineSlice2.topRight"),middleLeft:r("dialogNineSlice2.middleLeft"),middleCenter:r("dialogNineSlice2.middleCenter"),middleRight:r("dialogNineSlice2.middleRight"),bottomLeft:r("dialogNineSlice2.bottomLeft"),bottomCenter:r("dialogNineSlice2.bottomCenter"),bottomRight:r("dialogNineSlice2.bottomRight"),close:r("dialogNineSlice2.close")}},a=new t.Text("Level "+this.options.currentLevel+" Complete",this.headlineLetterStyle);s.width=e.Coords.x(925),s.height=e.Coords.x(679),i=new e.NineSlice(s),i.x=e.Coords.x(137),i.y=e.Coords.x(218),s.width=e.Coords.x(596),s.height=e.Coords.x(679),n=new e.NineSlice(s),n.x=e.Coords.x(1180),n.y=e.Coords.x(218),s.width=e.Coords.x(1639),s.height=e.Coords.x(243),o=new e.NineSlice(s),o.x=e.Coords.x(137),o.y=e.Coords.x(960),a.anchor.x=.5,a.x=this.options.width/2,a.y=e.Coords.y(50),this.contentContainer.width=this.ui.width,this.contentContainer.height=this.ui.height,this.layout=e.UIBuilder.buildLayout("LevelComplete",this.contentContainer,this),null===this.nextLevelData?this.layout.widgets.nextLevel.visible=!1:this.layout.widgets.main.visible=!1,this.buildBox0(i),this.buildBox1(n),this.buildBox2(o),this.contentContainer.addChild(this.layout),this.contentContainer.addChild(a),this.contentContainer.addChild(i),this.contentContainer.addChild(n),this.contentContainer.addChild(o)},r.prototype.buildBox0=function(i){var n=new t.Sprite.fromFrame("damage_vignette.png"),o=e.Coords.x(632),r=new t.Text("Damage",this.letterStyle),s=new t.Text(this.levelManager.damageMeter.getTotalDamage(),this.headlineLetterStyle),a=new t.Sprite(this.flakBoyTexture);n.x=n.y=e.Coords.x(30),n.scale.x=n.scale.y=2,r.x=o-r.width/2,r.y=e.Coords.y(175),s.x=o-s.width/2,s.y=e.Coords.y(267),this.levelManager.damageMeter.x=o-this.levelManager.damageMeter.width/2,this.levelManager.damageMeter.y=e.Coords.y(505),this.levelManager.damageMeter.toggleText(!1),a.anchor.y=1,a.x=e.Coords.x(223)-a.width/2,a.y=e.Coords.y(623),i.addChild(n),i.addChild(r),i.addChild(s),i.addChild(this.levelManager.damageMeter),i.addChild(a),this.box0=i},r.prototype.buildBox1=function(i){if(null==this.nextLevelData){this.letterStyle2.wordWrapWidth=i.width-e.Coords.x(40);var o=new t.Text(e.StringManager("headlines.congrats"),this.letterStyle2);return o.x=(i.width-o.width)/2,o.y=e.Coords.x(40),i.addChild(o),!1}var r=e.Coords.x(298),s=new t.Text("Weapon Unlock",this.letterStyle),a=new n(this.getWeaponUnlockData());s.x=r-s.width/2,s.y=e.Coords.y(30),a.x=r-a.width/2,a.y=e.Coords.y(130),a.interactive=!1,i.addChild(s),i.addChild(a)},r.prototype.buildBox2=function(i){var n,o,r,s,a,h=e.Coords.y(100),l=e.Coords.y(145),u=e.Coords.y(188),c=e.Coords.x(261),d=new t.Text("Earned",this.letterStyle),p=e.Coords.x(727),f=new t.Text("Spent",this.letterStyle),g=e.Coords.x(1341),m=new t.Text("Profit",this.letterStyle);n=new t.Text(this.earnings,this.letterStyle),d.x=n.x=c,this.letterStyle.fill="#ff2300",o=new t.Text("-",this.letterStyle),r=new t.Text(this.options.spent,this.letterStyle),o.x=e.Coords.x(495),f.x=r.x=p,this.profit>=0&&(this.letterStyle.fill="#61ff55"),s=new t.Text("=",this.letterStyle),a=new t.Text(this.profit,this.letterStyle),s.x=e.Coords.x(989),m.x=a.x=g,d.y=f.y=m.y=h,n.y=r.y=a.y=u,o.y=s.y=l,d.anchor.x=n.anchor.x=o.anchor.x=f.anchor.x=r.anchor.x=s.anchor.x=m.anchor.x=a.anchor.x=.5,d.anchor.y=n.anchor.y=f.anchor.y=r.anchor.y=m.anchor.y=a.anchor.y=1,o.anchor.y=s.anchor.y=.5,i.addChild(d),i.addChild(n),i.addChild(o),i.addChild(f),i.addChild(r),i.addChild(s),i.addChild(m),i.addChild(a)},r.prototype.handleTryAgainButton=function(){function t(){this.box0.removeChild(this.levelManager.damageMeter),this.levelManager.resetAnddisableButtons(),this.levelManager.resetDamageMeterDisplay(),this.close(),window.setTimeout(function(){this.levelManager.resetLevel()}.bind(this),500)}e.Integration.spil.gameBreak.call(this,t,function(){})},r.prototype.handleNextLevelButton=function(){function t(){this.box0.removeChild(this.levelManager.damageMeter),this.close(),window.setTimeout(function(){this.levelManager.loadNewLevel(this.nextLevelData)}.bind(this),500)}e.Integration.spil.gameBreak.call(this,t,function(){})},r.prototype.handleMainButton=function(){function t(){this.close(),this.mainMenuCallback()}e.Integration.spil.gameBreak.call(this,t,function(){})},r.prototype.getNextLevelData=function(){var t=o.levels,n=null;if(this.options.currentLevel<t.length){n=t[this.options.currentLevel];var r=e.GameConfig.getVal("level_"+(this.options.currentLevel+1))||{};i.extend(r,{locked:!1}),e.GameConfig.setVal("level_"+(this.options.currentLevel+1),r)}return n},r.prototype.getWeaponUnlockData=function(){var t=o.tools[this.nextLevelData.unlockInfo.group][this.nextLevelData.unlockInfo.index];return t.cardImage="item-card.png",t.locked=!1,t},r.prototype.close=function(){e.SpriteUtils.destroyAllChildren(this.contentContainer),e.SpriteUtils.destroyAllChildren(this.layout),e.Dialog.prototype.close.call(this)},r}),define("messagebox",["pixi","absolute","lodash"],function(t,e,i){var n=function(t){var n=e.AssetMap,o={content:"Override me.",width:e.Coords.x(800),x:0,y:0,images:{topLeft:n("dialogNineSlice.topLeft"),topCenter:n("dialogNineSlice.topCenter"),topRight:n("dialogNineSlice.topRight"),middleLeft:n("dialogNineSlice.middleLeft"),middleCenter:n("dialogNineSlice.middleCenter"),middleRight:n("dialogNineSlice.middleRight"),bottomLeft:n("dialogNineSlice.bottomLeft"),bottomCenter:n("dialogNineSlice.bottomCenter"),bottomRight:n("dialogNineSlice.bottomRight"),close:n("dialogNineSlice.close")},textStyle:{font:"bold "+Math.floor(40*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#704700",strokeThickness:e.Coords.x(10),wordWrap:!0},padding:e.Coords.x(60)};this._initMessageBox(i.extend(o,t))};return n.constructor=n,n.prototype=Object.create(t.DisplayObjectContainer.prototype),n.prototype._initMessageBox=function(e){t.DisplayObjectContainer.call(this),this.options=e,this.options.textStyle.wordWrapWidth=this.options.width-this.options.padding,this.setText(this.options.content),this.buildBackground(),this.addChild(this.background),this.addChild(this.text)},n.prototype.buildBackground=function(){this.options.height||(this.options.height=this.text.height+2*this.options.padding),this.background=new e.NineSlice(this.options)},n.prototype.setText=function(e){this.text?this.text.setText(e):(this.text=new t.Text(e,this.options.textStyle),this.text.position.x=(this.options.width-this.text.width)/2,this.text.position.y=this.options.padding)},n}),define("storedialog",["absolute","pixi","lodash","gameconfig","storeitem"],function(t,e,i,n,o){var r=function(t,e,i,n,o){this.initStoreDialog(t,e,i,n,o)};return r.prototype.initStoreDialog=function(r,s,a,h,l){this.ui=r,this.tortureChamber=s,this.levelData=a,this.toolList=h,this.handleBuyItem=l,this.tabs=[];var u,c=this,d="item-card.png",p="item-card-locked.png",f=new e.Texture.fromFrame("item-card.png"),g=f.width,m=f.height,y=Math.round(this.tortureChamber.width*this.tortureChamber.scale.x*.9),b=Math.round(this.tortureChamber.height*this.tortureChamber.scale.y*.5),v={width:y,height:b,cardScale:1*this.tortureChamber.scale.x,padding:{x:t.Coords.x(30),y:t.Coords.y(30)},itemWidth:g,itemHeight:m},x=new t.MultiPageGenerator(v),w=t.AssetMap,C={name:"arsenalmenu",content:"",width:y,height:b,x:(this.tortureChamber.width*this.tortureChamber.scale.x-y)/2,y:t.Coords.y(340),images:{topLeft:w("dialogNineSlice.topLeft"),topCenter:w("dialogNineSlice.topCenter"),topRight:w("dialogNineSlice.topRight"),middleLeft:w("dialogNineSlice.middleLeft"),middleCenter:w("dialogNineSlice.middleCenter"),middleRight:w("dialogNineSlice.middleRight"),bottomLeft:w("dialogNineSlice.bottomLeft"),bottomCenter:w("dialogNineSlice.bottomCenter"),bottomRight:w("dialogNineSlice.bottomRight"),close:w("dialogNineSlice.close")}},S=!1,T=0,_=t.Coords.x(10),A=(e.Texture.fromFrame("shop_tab_off.png").width*this.tortureChamber.scale.x+_)*i.size(n.tools),k=(y-A)/2;i.each(this.toolList,function(n,r){var s=new t.Button(e.Texture.fromFrame("shop_tab_off.png"),e.Texture.fromFrame("shop_tab_off.png"),function(){i.each(c.tabs,function(t){t.tabOn.visible=!1,t.tabOn.selected=!1}),this.tabOn.visible=!0,this.selected=!0,u.resetContent(this.content)}),a=e.Sprite.fromFrame("shop_tab_on.png"),h=e.Sprite.fromFrame("icon_"+r+".png"),l=[];s.scale.x=s.scale.y=this.tortureChamber.scale.x,a.visible=!S,s.selected=!S,h.anchor.x=h.anchor.y=.5,s.tabOn=a,s.addChild(a),s.addChild(h),a.anchor.x=a.anchor.y=s.anchor.x=s.anchor.y=.5,s.x=k+s.width/2+(s.width+_)*T,s.y=t.Coords.y(3),i.each(n,function(t){var e=t.locked&&-1==this.levelData.unlock.indexOf(t.type),i={locked:e,cardImage:e?p:d,width:g,height:m,itemImage:t.itemImage,name:t.name,price:t.price,type:t.type};l.push(new o(i,this.handleBuyItem.bind(this)))},this);var f=x.getPages(l)[0];f.x=(y-f.width)/2,f.y=t.Coords.y(140),s.content=f,S||(C.content=f,u=new t.Dialog(this.ui,C),S=!0),u.addChild(s),this.tabs.push(s),T++},this),this.dialog=u},r.prototype.updateItemState=function(t){i.each(this.tabs,function(e){i.each(e.content.children,function(e){e.settings.price>t&&10!=this.levelData.id?e.disable():e.enable()},this)},this)},r.prototype.open=function(t){this.updateItemState(t),this.dialog.open()},r.prototype.close=function(){this.dialog.close()},r.prototype.destroy=function(){i.each(this.tabs,function(e){t.SpriteUtils.destroyAllChildren(e.content)}),t.SpriteUtils.destroyAllChildren(this.dialog),this.dialog.destroy(!0)},r}),define("levelmanager",["absolute","pixi","lodash","tool","absolute/physics","ducky","gameconfig","bouncer1","bouncer2","bouncer3","mine1","mine2","mine3","mine4","spikes1","spikes2","spikes3","turret1","turret2","turret3","damagemeter","wallet","levelcomplete","optionsmenu","tutorials","tutorial","messagebox","storedialog","absoluteaudio"],function(t,e,i,n,o,r,s,a,h,l,u,c,d,p,f,g,m,y,b,v,x,w,C,S,T,_,A,k){var M=function(t,e){this.initLevelManager(t,e)};return M.prototype=Object.create(e.DisplayObjectContainer.prototype),M.prototype.initLevelManager=function(t,n){e.DisplayObjectContainer.call(this),this.tortureChamber=t,this.ui=n,this.container=new e.DisplayObjectContainer,this.container.width=this.ui.width,this.container.height=this.ui.height,this.walking=!1,this.levelData=this.tortureChamber.screen.game.currentLevel.settings,this.wallet=new w({startingBalance:s.startingBalance}),this.cashSpent=0,this.toolList=i.clone(s.tools,!0),this.firstContact=null,this.buildGraphics(),this.addChild(this.container),this.buildStoreTabs(),this.loadLevelData(),this.startMusic(),this.initTutorial(),this.load3rdPartyButton()},M.prototype.initTutorial=function(){this.tutorial=new _(this.ui,{name:"tutorial1",queue:T.getConfig().tortureChamber}),window.setTimeout(function(){this.tutorial.start()}.bind(this),500)},M.prototype.startMusic=function(){var e=t.RandomUtils.getRandomIntFromRange(1,3);t.MusicManager.stopMusic(),t.MusicManager.playMusic("music_"+e)},M.prototype.loadNewLevel=function(e,i){this.startMusic(),this.levelData=e,this.levelLabel.setText("Level "+this.levelData.id+"/10"),this.levelLabel.updateText(),this.levelLabel.x=this.buttonLayout.widgets.goButton.x-this.levelLabel.width-t.Coords.x(10),this.tortureChamber.state="building",this.resetDamageMeterDisplay(),this.resetLevel({target:this.levelData.target},i),this.buildStoreTabs()},M.prototype.buildGraphics=function(){var n=[],o=[];i.times(35,function(t){n.push(new e.Texture.fromFrame("duck_walk_jump00"+(t+1>=10?t+1:"0"+(t+1))+".png"))}),i.times(20,function(t){o.push(new e.Texture.fromFrame("duck_walk_loop00"+(t+1>=10?t+1:"0"+(t+1))+".png"))}),this.duckJump=new e.MovieClip(n),this.duckWalk=new e.MovieClip(o),this.duckJump.anchor.x=.5,this.duckWalk.anchor.x=.5,this.duckJump.y=this.tortureChamber.physicsArea.y+this.tortureChamber.physicsArea.height-this.duckJump.height,this.duckJump.loop=!1,this.duckWalk.animationSpeed=this.duckJump.animationSpeed=.5,this.duckWalk.y=this.duckJump.y+t.Coords.y(55),this.duckWalk.visible=!1,this.duckJump.visible=!1,this.duckJump.onComplete=function(){this.tortureChamber.screen.simulate&&(this.duckJump.visible=!1,this.duckWalk.visible=!0,this.walking=!0,this.duckWalk.gotoAndPlay(0))}.bind(this),this.duckJump.x=this.tortureChamber.physicsArea.x+this.tortureChamber.physicsArea.width/2,this.duckWalk.x=this.duckJump.x,this.buttonLayout=t.UIBuilder.buildLayout("LevelManager",this.container,this),this.buttonLayout.widgets.goButton.visible=!1,this.buttonLayout.widgets.stopButton.visible=!1,this.duckyIcon=new e.Sprite.fromFrame("ducky.png"),this.duckyIcon.anchor.x=this.duckyIcon.anchor.y=.5,this.duckyIcon.x=this.buttonLayout.widgets.duckButton.width/2,this.duckyIcon.y=this.buttonLayout.widgets.duckButton.height/2,this.duckyIcon.scale.x=this.duckyIcon.scale.y=.75*this.buttonLayout.widgets.duckButton.height/this.duckyIcon.height,this.buttonLayout.widgets.duckButton.addChild(this.duckyIcon),this.buttonLayout.widgets.duckButton.x=this.buttonLayout.widgets.stopButton.x=this.buttonLayout.widgets.goButton.x=this.tortureChamber.width-this.buttonLayout.widgets.goButton.width-t.Coords.x(20),this.buttonLayout.y=this.tortureChamber.height-this.buttonLayout.widgets.goButton.height-t.Coords.y(5),this.buttonLayout.widgets.goButton.visible=!1,this.buttonLayout.widgets.goButton.disable(),this.buttonLayout.widgets.stopButton.visible=!1,this.buttonLayout.widgets.stopButton.disable(),this.shopIcon=new e.Sprite.fromFrame("shop.png"),this.shopIcon.anchor.x=this.shopIcon.anchor.y=.5,this.shopIcon.y=this.buttonLayout.widgets.shopButton.height/2,this.shopIcon.scale.x=this.shopIcon.scale.y=.75*this.buttonLayout.widgets.shopButton.height/this.shopIcon.height,this.buttonLayout.widgets.shopButton.addChild(this.shopIcon),this.buttonLayout.widgets.shopButton.anchor.x=.5,this.buttonLayout.widgets.shopButton.x=this.tortureChamber.width/2,this.optionsIcon=new e.Sprite.fromFrame("settings.png"),this.optionsIcon.anchor.x=this.optionsIcon.anchor.y=.5,this.optionsIcon.y=this.buttonLayout.widgets.optionsButton.height/2,this.optionsIcon.scale.x=this.optionsIcon.scale.y=.65*this.buttonLayout.widgets.optionsButton.height/this.optionsIcon.height,this.buttonLayout.widgets.optionsButton.addChild(this.optionsIcon),this.buttonLayout.widgets.optionsButton.anchor.x=.5,this.buttonLayout.widgets.optionsButton.x=t.Coords.x(20)+this.buttonLayout.widgets.optionsButton.width/2,this.damageMeter=new x({target:this.levelData.target}),this.damageMeter.visible=!1,this.damageMeter.x=t.Coords.x(800),this.damageMeter.y=this.buttonLayout.y+t.Coords.y(45);var r={font:"bold "+Math.floor(50*t.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#cdfffb",stroke:"#001f2d",strokeThickness:t.Coords.x(10)},s={font:"bold "+Math.floor(70*t.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#61ff55",stroke:"#001f2d",strokeThickness:t.Coords.x(10)};this.levelLabel=new e.Text("Level "+this.levelData.id+"/10",r);var a=10==this.levelData.id?"9999":this.wallet.getBalance().toString();this.budgetLabel=new e.Text("$"+a,s),this.levelLabel.y=this.buttonLayout.y,this.levelLabel.x=this.buttonLayout.widgets.goButton.x-this.levelLabel.width-t.Coords.x(10),this.budgetLabel.y=this.levelLabel.y+this.levelLabel.height,this.budgetLabel.x=this.buttonLayout.widgets.goButton.x-this.budgetLabel.width-t.Coords.x(10),this.entryContainer=new e.DisplayObjectContainer,this.tempFlakboy=new e.Sprite.fromFrame("temp_flakboy.png"),this.entryHatchShaft=new e.Sprite.fromFrame("entry_hatch_shaft.png"),this.entryHatchLid=new e.Sprite.fromFrame("entry_hatch_lid.png"),this.entryHatchShaft.anchor.x=this.entryHatchLid.anchor.x=this.entryHatchShaft.anchor.y=this.entryHatchLid.anchor.y=.5,this.entryHatchShaft.x=this.entryHatchLid.x=this.duckJump.x,this.entryHatchShaft.y=this.entryHatchLid.y=this.duckJump.y+this.duckJump.height,this.entryHatchMask=new e.Graphics,this.entryHatchMask.beginFill(0),this.entryHatchMask.drawRect(this.entryHatchShaft.x-this.entryHatchShaft.width/2,this.entryHatchShaft.y+this.entryHatchShaft.height/2-8*this.entryHatchShaft.height,this.entryHatchShaft.width,8*this.entryHatchShaft.height),this.entryHatchMask.endFill(0),this.tempFlakboy.anchor.x=.5,this.tempFlakboy.x=this.duckJump.x,this.tempFlakboy.visible=!1,this.entryContainer.addChild(this.entryHatchMask),this.entryContainer.addChild(this.entryHatchShaft),this.entryContainer.addChild(this.entryHatchLid),this.entryContainer.addChild(this.tempFlakboy),this.entryContainer.mask=this.entryHatchMask,this.container.addChild(this.entryContainer),this.container.addChild(this.duckJump),this.container.addChild(this.duckWalk),this.container.addChild(this.buttonLayout),this.container.addChild(this.damageMeter),this.container.addChild(this.levelLabel),this.container.addChild(this.budgetLabel)},M.prototype.startEntryAnimation=function(e){var i,n,o=this.entryHatchLid.y+this.entryHatchLid.height+this.tempFlakboy.height+t.Coords.y(50),r=this.duckJump.y,s=this,a=!1;this.tempFlakboy.y=this.duckJump.y+this.tempFlakboy.height+t.Coords.y(50),this.buttonLayout.widgets.goButton.active&&(this.buttonLayout.widgets.goButton.disable(),a=!0),i=new TWEEN.Tween({y:this.entryHatchLid.y}).to({y:o},1e3).onUpdate(function(){s.entryHatchLid.y=this.y}).start(),n=new TWEEN.Tween({flakboyY:this.tempFlakboy.y,lidY:o}).to({flakboyY:r,lidY:this.entryHatchLid.y},1250).onStart(function(){s.duckJump.visible=!1,s.duckWalk.visible=!1,s.tempFlakboy.visible=!0
}).onUpdate(function(){s.tempFlakboy.y=this.flakboyY,s.entryHatchLid.y=this.lidY}).onComplete(function(){s.duckJump.visible=!0,s.tempFlakboy.visible=!1,e(),a&&s.buttonLayout.widgets.goButton.enable()}),i.chain(n)},M.prototype.load3rdPartyButton=function(){var i,n=new e.DisplayObjectContainer;if("undefined"!=typeof window.SpilGameAPIInstance&&window.AH_show_branding){var o=window.SpilGameAPIInstance.Branding.getLogo(),r=t.Coords.x(40);if(o.image){var s=new e.ImageLoader(o.image);s.addEventListener("loaded",function(){function s(){o.action()}i=e.Sprite.fromFrame(o.image),i.scale.x=i.scale.y=t.Coords.x(404)/i.width,i.click=s,i.touchstart=s,i.x=r+this.buttonLayout.widgets.optionsButton.x+this.buttonLayout.widgets.optionsButton.width/2,i.y=r+this.buttonLayout.y,i.buttonMode=!0,i.setInteractive(!0),n.addChild(i)}.bind(this)),s.load()}}this.container.addChild(n)},M.prototype.resetDamageMeterDisplay=function(){this.damageMeter.x=t.Coords.x(800),this.damageMeter.y=this.buttonLayout.y+t.Coords.y(45),this.damageMeter.toggleText(!0),this.container.addChild(this.damageMeter)},M.prototype.handleOptionsButton=function(){this.optionsMenu=new S(this.ui,this.tortureChamber.screen.game,{closeCallback:function(t){t&&(this.duckJump.visible=!1,this.tortureChamber.removeAllToolsNoRobo(function(){}),this.tortureChamber.ragdoll.removeBodies(),this.tortureChamber.state="exit",this.tortureChamber.screen.game.quit())}.bind(this)}),this.tortureChamber.screen.simulate=!1,this.optionsMenu.open()},M.prototype.handleDuckButton=function(t,e){var i={orientation:1,readyCallback:this.levelReady.bind(this),removeCallback:this.resetDuckButton.bind(this),duckyRevealedCallback:this.duckyRevealed.bind(this)};"undefined"!=typeof t&&"undefined"!=typeof e&&(i.x=t,i.y=e),this.buttonLayout.widgets.duckButton.disable(),this.buttonLayout.widgets.goButton.visible=!1,this.buttonLayout.widgets.goButton.disable(!0),this.buttonLayout.widgets.stopButton.visible=!1,this.buttonLayout.widgets.stopButton.disable(),this.ducky=this.tortureChamber.dropTool(r,"duck",i),this.duckyIcon.tint=9079434},M.prototype.levelReady=function(t){this.ducky.setOrientation("ducky-left"===t.currentSnapArea?-1:1),this.buttonLayout.widgets.duckButton.visible=!1,this.buttonLayout.widgets.goButton.visible=!0,this.buttonLayout.widgets.goButton.enable(),this.buttonLayout.widgets.stopButton.visible=!1,this.buttonLayout.widgets.stopButton.disable(),this.toolReady(this.ducky)},M.prototype.resetDuckButton=function(){this.ducky=null,"building"==this.tortureChamber.state&&(this.buttonLayout.widgets.duckButton.enable(),this.buttonLayout.widgets.duckButton.visible=!0,this.buttonLayout.widgets.goButton.visible=!1,this.buttonLayout.widgets.goButton.disable(!0),this.buttonLayout.widgets.stopButton.visible=!1,this.buttonLayout.widgets.stopButton.disable(),this.duckyIcon.tint=16777215)},M.prototype.handleGoButton=function(){this.tortureChamber.removeUnpaidTools(function(){this.updateBudgetLabel(this.wallet.getBalance())}.bind(this)),this.startLevel(),t.MusicManager.stopMusic(),this.buttonLayout.widgets.goButton.visible=!1,this.buttonLayout.widgets.goButton.disable(!0),this.buttonLayout.widgets.stopButton.visible=!0,this.buttonLayout.widgets.stopButton.enable(),this.buttonLayout.widgets.shopButton.disable(!0),this.buttonLayout.widgets.shopButton.visible=!1,this.damageMeter.visible=!0,this.buildPhysics()},M.prototype.handleStopButton=function(){if(this.tortureChamber.screen.simulate=!1,this.walking=!1,this.damageMeter.isTargetReached()){t.MusicManager.stopMusic(),t.MusicManager.playMusic("complete"),t.Platform.isSilk()||(this.screenGrabRenderer||(this.screenGrabStage=new e.Stage(16777215),this.screenGrabRenderer=new e.CanvasRenderer(t.Coords.y(2008)/2,t.Coords.y(1359)/2,null,!1)),this.screenGrabStage.addChild(this.tortureChamber.getScreenGrab()),this.screenGrabRenderer.roundPixels=!0,this.screenGrabRenderer.render(this.screenGrabStage),t.StorageManager.store(this.levelData.id+"_grab",this.screenGrabRenderer.view.toDataURL("image/png")));var i={currentLevel:this.levelData.id,spent:this.cashSpent};this.levelComplete=new C(this.ui,i,this,this.tortureChamber.ragdoll.getSnapShot(),function(){this.tortureChamber.removeAllToolsNoRobo(function(){}),this.tortureChamber.state="exit",this.tortureChamber.screen.game.quit()}.bind(this)),this.levelComplete.open()}else t.MusicManager.stopMusic(),t.MusicManager.playMusic("failed"),this.resetLevel({},!1,!_.prototype.hasBeenShown("tutorial6")),this.showMessage("Not good enough.",this.container)},M.prototype.showMessage=function(i,n){var o=new e.DisplayObjectContainer,r=new e.Graphics,s=.3,a={font:"bold "+Math.floor(70*t.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"#ffffff",stroke:"#704700",strokeThickness:t.Coords.x(10)},h=new e.Text(i,a);h.x=(n.width-h.width)/2,h.y=(n.height-h.height)/2,r.beginFill(65793,.5),r.drawRect(h.position.x-h.width*(s/2),h.position.y-h.height*(s/2),h.width*(1+s),h.height*(1+s)),r.endFill(),o.addChild(r),o.addChild(h),n.addChild(o),t.TweenUtils.fadeOut([o],{duration:500,delay:2e3},function(){n.removeChild(o),h.destroy(!0)}.bind(this))},M.prototype.handleStoreButton=function(){if(this.tortureChamber.removeUnpaidTools(function(){this.updateBudgetLabel(this.wallet.getBalance())}.bind(this)),this.storeDialog.open(this.wallet.getBalance()),!this.shopTutorial1&&!_.prototype.hasBeenShown("weaponsShop1")){var i=new e.Sprite.fromFrame("tutorial_arrow.png");this.shopTutorial1=new A({content:T.getConfig().weaponsShop1[0].dialog.content}),this.shopTutorial1.x=t.Coords.x(550),this.shopTutorial1.y=t.Coords.y(250),i.rotation=-Math.PI/2,i.x=-t.Coords.x(200),i.anchor.x=.5,i.y=this.shopTutorial1.options.height/2,this.shopTutorial1.addChild(i),this.storeDialog.dialog.addChild(this.shopTutorial1),this.shopTutorial1.open=!0,_.prototype.setState(!0,"weaponsShop1")}},M.prototype.buildStoreTabs=function(){this.storeDialog&&this.storeDialog.destroy(),this.storeDialog=new k(this.ui,this.tortureChamber,this.levelData,this.toolList,this.handleBuyItem.bind(this))},M.prototype.handleBuyItem=function(t){var e=this.wallet.getBalance(),i=e>=t.settings.price||10==this.levelData.id,n=e-t.settings.price;i?(this.updateBudgetLabel(n),this.addTool(t.settings.type.toLowerCase(),{price:t.settings.price}),this.storeDialog.close()):this.showMessage("Sorry, not enough money to buy that.",this.storeDialog.dialog)},M.prototype.duckyRevealed=function(){this.tortureChamber.screen.simulate=!0},M.prototype.toolReady=function(t){t.settings.paidFor||(t.settings.paidFor=!0,10!=this.levelData.id&&this.wallet.withdraw(t.settings.price)),this.shopTutorial1&&this.shopTutorial1.open&&(this.storeDialog.dialog.removeChild(this.shopTutorial1),this.shopTutorial1.open=!1);var e=_.prototype.hasBeenShown;e("weaponsShop1")&&!e("weaponsShop2")?(this.shopTutorial2=new _(this.ui,{name:"tutorial3",queue:T.getConfig().weaponsShop2}),this.shopTutorial2.start()):e("weaponsShop2")&&!e("duck")&&"ducky"!==t.settings.name?(this.duckTutorial=new _(this.ui,{name:"tutorial4",queue:T.getConfig().duck}),this.duckTutorial.start()):e("duck")&&!e("duckGo")&&"ducky"===t.settings.name&&(this.duckGoTutorial=new _(this.ui,{name:"tutorial5",queue:T.getConfig().duckGo}),this.duckGoTutorial.start()),this.saveLevelData()},M.prototype.addTool=function(t,e){e=e||{};var i=null;switch(e.readyCallback=this.toolReady.bind(this),t){case"mine1":i=this.tortureChamber.dropTool(u,"mine1",e);break;case"mine2":i=this.tortureChamber.dropTool(c,"mine1",e);break;case"mine3":i=this.tortureChamber.dropTool(d,"mine1",e);break;case"mine4":i=this.tortureChamber.dropTool(p,"mine1",e);break;case"bouncer1":i=this.tortureChamber.dropTool(a,"bouncer1",e);break;case"bouncer2":i=this.tortureChamber.dropTool(h,"bouncer1",e);break;case"bouncer3":i=this.tortureChamber.dropTool(l,"bouncer1",e);break;case"spikes1":i=this.tortureChamber.dropTool(f,"spikes1",e);break;case"spikes2":i=this.tortureChamber.dropTool(g,"spikes1",e);break;case"spikes3":i=this.tortureChamber.dropTool(m,"spikes1",e);break;case"turret1":i=this.tortureChamber.dropTool(y,"turret1",e);break;case"turret2":i=this.tortureChamber.dropTool(b,"turret1",e);break;case"turret3":i=this.tortureChamber.dropTool(v,"turret1",e);break;case"ducky":this.ducky||(this.handleDuckButton(e.x,e.y),this.ducky.getDropArea(),this.ducky.orientTool(),this.levelReady(this.ducky))}null!==i&&(this.cashSpent+=i.settings.price,i.orientTool(),i._onDrop())},M.prototype.updateBudgetLabel=function(t){10==this.levelData.id&&(t=9999),this.budgetLabel.setText("$"+t),this.budgetLabel.updateText(),this.budgetLabel.x=this.buttonLayout.widgets.goButton.x-this.budgetLabel.width},M.prototype.toolRemoved=function(t){var e=this.wallet.getBalance();t.settings.paidFor&&(e=this.wallet.deposit(t.settings.price),this.cashSpent-=t.settings.price,t.paidFor=!1),this.updateBudgetLabel(e),this.storeDialog.updateItemState(this.wallet.getBalance()),this.saveLevelData()},M.prototype.buildPhysics=function(){var t=1.5*this.tortureChamber.scale.x*(this.tortureChamber.originalGridPixels/this.tortureChamber.gridPixels),e=4.5*this.tortureChamber.scale.x*(this.tortureChamber.originalGridPixels/this.tortureChamber.gridPixels),i=this.tortureChamber.width*this.tortureChamber.scale.x/2,n=this.tortureChamber.floor-this.tortureChamber.py(e);this.walkSensor=this.makeTempBody(i,n,t,e),this.walkSensor.userData={type:"WalkSensor",handleContact:this.handleContact.bind(this)}},M.prototype.removeBodies=function(t){if(t=!!t,this.walkSensor&&(o.world.DestroyBody(this.walkSensor),this.walkSensor=null),!t)try{this.container.removeChild(this.duckJump),this.container.removeChild(this.duckWalk)}catch(e){}},M.prototype.makeTempBody=function(t,e,i,n){var r,s=new Box2D.b2BodyDef,a=new Box2D.b2FixtureDef,h=new Box2D.b2PolygonShape;return h.SetAsBox(i,n),s.set_type(Box2D.b2_dynamicBody),s.set_position(new Box2D.b2Vec2(o.screenToWorldX(t),o.screenToWorldY(e))),r=o.world.CreateBody(s),a.set_density(1),a.set_friction(0),a.set_restitution(0),a.set_shape(h),r.CreateFixture(a),r.SetAwake(1),r.SetActive(1),r},M.prototype.startLevel=function(){this.tortureChamber.state="animating",this.duckJump.visible=!0,this.entryContainer.visible=!1,this.startDirection=-this.ducky.reveal(),this.duckJump.gotoAndPlay(0),this.duckWalk.scale.x=this.startDirection,this.duckJump.scale.x=-this.startDirection},M.prototype.saveLevelData=function(e){var n=[],o={},r=t.GameConfig.getVal("level_"+this.levelData.id);return e&&r&&r.profit&&r.profit>e.profit?!1:(i.each(this.tortureChamber.tools,function(e){if(e.settings.paidFor||"ducky"===e.settings.name){var i={type:e.settings.name,x:e.container.x/t.ScreenMetrics.getResScale(),y:e.container.y/t.ScreenMetrics.getResScale(),price:e.settings.price,paidFor:!0};n.push(i)}}),i.extend(o,r),o.tools=n,o.cashSpent=this.cashSpent,o.locked=!1,i.extend(o,e),void t.GameConfig.setVal("level_"+this.levelData.id,o))},M.prototype.loadLevelData=function(){var e=t.GameConfig.getVal("level_"+this.levelData.id);if(e){i.each(e.tools,function(e){e.x=e.x*t.ScreenMetrics.getResScale(),e.y=e.y*t.ScreenMetrics.getResScale(),this.addTool(e.type,e)},this);var n=this.calculateBalance();this.wallet.setBalance(n-this.cashSpent),this.updateBudgetLabel(n-this.cashSpent)}this.startEntryAnimation(function(){})},M.prototype.calculateBalance=function(){var e=s.startingBalance;return i.times(this.levelData.id-1,function(i){var n=t.GameConfig.getVal("level_"+(i+1));n&&n.profit&&(e+=n.profit)},this),e},M.prototype.beforeRender=function(){var t=Date.now();if(this.lastUpdate||(this.lastUpdate=t),this.beginSimulation){this.beginSimulation=!1,this.tortureChamber.state="simulating";var e=this.walkSensor.GetLinearVelocity(),i=this.startDirection<0&&this.duckWalk.x<this.firstContact.x||this.startDirection>0&&this.duckWalk.x>this.firstContact.x;this.firstContactIsBouncer||i?(e.set_x(0),e.set_y(0)):(e.set_x(9*this.startDirection*this.tortureChamber.scale.x),e.set_y(0)),this.removeBodies(),this.tortureChamber.screen.simulate=!1,this.tortureChamber.ragdoll.activate(e),this.tortureChamber.screen.simulate=!0}else if(this.prepForSim&&(this.duckWalk.x>this.firstContact.x&&this.duckWalk.x<=this.firstContact.x+this.firstContact.startAdjust||this.duckWalk.x<this.firstContact.x&&this.duckWalk.x>=this.firstContact.x-this.firstContact.startAdjust)){this.firstContactIsBouncer&&(this.firstContact.bouncer.skipWait=!0);var n=this.duckWalk.x;this.stopWalk(n),this.prepForSim=!1}else if(this.walking&&null!==this.walkSensor){var r=this.walkSensor.GetLinearVelocity(),s=6*this.startDirection*this.tortureChamber.scale.x*(this.tortureChamber.originalGridPixels/this.tortureChamber.gridPixels),a=o.worldToScreenX(this.walkSensor.GetPosition().get_x())/this.tortureChamber.scale.x;a>this.tortureChamber.physicsArea.x&&a<this.tortureChamber.physicsArea.x+this.tortureChamber.physicsArea.width&&(r.set_x(s),this.walkSensor.SetLinearVelocity(r),a=o.worldToScreenX(this.walkSensor.GetPosition().get_x())/this.tortureChamber.scale.x,this.duckWalk.x=a)}this.lastUpdate=t},M.prototype.stopWalk=function(t){this.walking=!1,this.duckJump.visible=!1,this.duckJump.gotoAndStop(0),this.duckWalk.visible=!1,this.tortureChamber.ragdoll.setX(t),this.beginSimulation=!0},M.prototype.handleContact=function(t,e){return null!==this.firstContact||this.startDirection>0&&this.duckWalk.x>=e.x+e.startAdjust||this.startDirection<0&&this.duckWalk.x<=e.x-e.startAdjust?!1:(this.prepForSim=!0,this.firstContactIsBouncer="Bouncer"===t,void(this.firstContact=e))},M.prototype.resetAnddisableButtons=function(){this.buttonLayout.widgets.duckButton.visible=!1,this.buttonLayout.widgets.duckButton.disable(),this.buttonLayout.widgets.goButton.visible=!0,this.buttonLayout.widgets.goButton.disable(!0),this.buttonLayout.widgets.stopButton.visible=!1,this.buttonLayout.widgets.shopButton.disable(!0)},M.prototype.resetLevel=function(e,i,n){function o(){this.buttonLayout.widgets.stopButton.visible=!1,this.buttonLayout.widgets.stopButton.disable(!0),this.buttonLayout.widgets.goButton.visible=!0,this.buttonLayout.widgets.goButton.enable(),this.buttonLayout.widgets.shopButton.enable(),this.startMusic(),this.ducky=null,this.duckJump.gotoAndStop(0),this.duckWalk.gotoAndStop(0),this.duckWalk.x=this.duckJump.x=this.tortureChamber.physicsArea.x+this.tortureChamber.physicsArea.width/2,this.container.addChild(this.duckJump),this.container.addChild(this.duckWalk),this.buttonLayout.widgets.shopButton.visible=!0,this.damageMeter.visible=!1,this.entryContainer.visible=!0,this.damageMeter.reset(e),this.cashSpent=0,this.tortureChamber.state="building",this.loadLevelData(),null==this.ducky&&this.resetDuckButton(),n&&(this.failTutorial=new _(this.ui,{name:"tutorial6",queue:T.getConfig().fail}),this.failTutorial.start())}i=!!i,n=!!n,self=this,this.walking=!1,this.beginSimulation=!1,this.prepForSim=!1,this.firstContact=null,this.resetAnddisableButtons(),this.removeBodies(!0),i?o.call(this):(t.Platform.isSilk()?this.tortureChamber.removeAllToolsNoRobo(function(){o.call(this)}.bind(this)):this.tortureChamber.removeAllTools(function(){o.call(this)}.bind(this)),this.duckWalk.visible=!1,this.duckJump.visible=!1)},M}),define("robot",["pixi","absolute","lodash"],function(t,e,i){var n=function(){this.initRobot()};return n.prototype=Object.create(t.DisplayObjectContainer.prototype),n.prototype.initRobot=function(){t.DisplayObjectContainer.call(this);var e=new t.Sprite.fromFrame("cleaner_bot.png"),n=new t.DisplayObjectContainer;i.times(5,function(e){var i=new t.Sprite.fromFrame("cleaner_bot_beam.png");i.y=-i.height*e,n.addChild(i)}),n.cacheAsBitmap=!0,this.addChild(e),this.addChild(n)},n}),define("torturechamber",["pixi","absolute","absolute/physics","ragdoll","turret3","turret2","turret1","lodash","objectpool","absolute/physicsshape","bloodsplat","flaksplat","levelmanager","wallet","gameconfig","text!flakboyshapes.json","box2d","robot"],function(t,e,i,n,o,r,s,a,h,l,u,c,d,p,f,g,m,y){e.Physics=i;var b=function(t,e){this.initTortureChamber(t,e)};return b.prototype=Object.create(t.DisplayObjectContainer.prototype),b.prototype.initTortureChamber=function(e,i){t.DisplayObjectContainer.call(this),this.ui=e,this.screen=i,this.originalGridPixels=40,this.gridPixels=40,this.tempDamageLayer=new t.DisplayObjectContainer,this.toolLayer=new t.DisplayObjectContainer,this.ragdollLayer=new t.DisplayObjectContainer,this.tools=[],this.cacheQueue=[],this.wallet=new p({startingBalance:f.startingBalance}),this.robotJanitor=new y,this.buildBackground(),this.buildDamageAssets(),this.addChild(this.tempDamageLayer),this.addChild(this.toolLayer),this.addChild(this.ragdollLayer),this.initPhysics(),this.addCharacter(),this.state="building",this.screen.simulate=!1,this.levelManager=new d(this,this.ui,this.screen.game.currentLevel),this.addChild(this.levelManager)},b.prototype.buildBackground=function(){if(this.backgroundImage)for(var e=this.backgroundImage.children.length-1;e>=0;e--)this.backgroundImage.removeChild(this.backgroundImage.children[e]);else this.backgroundTexture=new t.Texture.fromFrame("BK_flakboy_lab.png"),this.backgroundImage=new t.Sprite(this.backgroundTexture),this.scale.x=this.scale.y=this.backgroundImage.scale.x=this.backgroundImage.scale.y=this.backgroundImage.width>this.ui.width?this.ui.width/this.backgroundImage.width:this.ui.height/this.backgroundImage.height,this.width=this.backgroundImage.width,this.height=this.backgroundImage.height;this.screen.background.addChild(this.backgroundImage)},b.prototype.buildDamageAssets=function(){function t(){var t=new u("Basic",this.addToBackground.bind(this));return t.poolType="basicWallSplatPool",t}function e(){var t=new u("Wall",this.addToBackground.bind(this));return t.poolType="wallSplatPool",t}function i(){var t=new u("Ceiling",this.addToBackground.bind(this));return t.poolType="ceilingSplatPool",t}function n(){var t=new c(this.addToBackground.bind(this));return t.poolType="flakSplatPool",t}this.basicWallSplatPool=new h(t.bind(this),80,"basicWallSplatPool"),this.ceilingSplatPool=new h(i.bind(this),20,"ceilingSplatPool"),this.wallSplatPool=new h(e.bind(this),20,"wallSplatPool"),this.flakSplatPool=new h(n.bind(this),10,"flakSplatPool"),this.pools={basicWallSplatPool:this.basicWallSplatPool,ceilingSplatPool:this.ceilingSplatPool,wallSplatPool:this.wallSplatPool,flakSplatPool:this.flakSplatPool}},b.prototype.initPhysics=function(){this.floor=.86*this.height*this.scale.y,this.physicsPadding=e.Coords.x(30),this.physicsArea=new t.Rectangle(this.physicsPadding,this.physicsPadding,this.width-2*this.physicsPadding,.86*this.height-this.physicsPadding),e.Physics.initialized?e.Physics.resetWorld():(e.Physics.init(this.ui,0,-60,new t.Point(this.width*this.scale.x/2,this.floor),this.gridPixels),this.buildContactListener(this.scale.x),this.buildGround())},b.prototype.buildGround=function(){var n=function(t){return i.screenToWorldX.call(i,t)},o=function(t){return i.screenToWorldY.call(i,t)},r={topLeft:new t.Point(n(this.physicsPadding),o(this.physicsPadding)),topRight:new t.Point(n(this.width*this.scale.x-this.physicsPadding,!1),o(this.physicsPadding)),bottomLeft:new t.Point(n(this.physicsPadding),o(this.floor)),bottomRight:new t.Point(n(this.width*this.scale.x-this.physicsPadding),o(this.floor))};e.Physics.buildGround(r.topLeft,r.topRight,{type:"Wall",isCeiling:!0,y:this.physicsArea.y}),e.Physics.buildGround(r.topRight,r.bottomRight,{type:"Wall",x:this.physicsArea.x+this.physicsArea.width-this.physicsPadding}),e.Physics.buildGround(r.bottomLeft,r.bottomRight,"Floor","groundBottom"),e.Physics.buildGround(r.topLeft,r.bottomLeft,{type:"Wall",x:this.physicsArea.x-this.physicsPadding})},b.prototype.sx=function(t){return t/i.pixelsPerMeter},b.prototype.sy=function(t){return t/i.pixelsPerMeter},b.prototype.px=function(t){return t*i.pixelsPerMeter},b.prototype.py=function(t){return t*i.pixelsPerMeter},b.prototype.addCharacter=function(){this.ragdoll&&this.ragdollLayer.removeChild(this.ragdoll),this.ragdoll=new n(this.ui,this),this.ragdoll.visible=!1,this.ragdollLayer.addChild(this.ragdoll)},b.prototype.beforeRender=function(){this.levelManager&&this.levelManager.beforeRender(),this.ragdoll&&this.ragdoll.beforeRender(),this.testShape&&this.testShape.update(),this.testShape2&&this.testShape2.update(),a.each(this.testShapes,function(t){t.update()}),a.each(this.tools,function(t){t&&t.beforeRender()});for(var t=!1;this.cacheQueue.length;){var e=this.cacheQueue.pop();"undefined"!=typeof e.poolIndex&&"undefined"!=typeof e.poolType&&this.pools[e.poolType].release(e.poolIndex),this.backgroundImage.addChild(e),t=!0}t&&(this.ui.refreshBackground=!0)},b.prototype.afterRender=function(){e.Debug.enabled&&e.Physics.debugDraw()},b.prototype.dropTool=function(t,e,i){var n=e+this.tools.length+1,o={x:this.physicsArea.width/2,y:this.physicsArea.height/2,id:n},r=new t(a.extend(o,i),this);return this.toolLayer.addChild(r),this.tools.push(r),r},b.prototype.removeTool=function(t){this.tools.splice(this.tools.indexOf(t),1),t.removeBodies(),this.toolLayer.removeChild(t),this.levelManager.toolRemoved(t)},b.prototype.removeUnpaidTools=function(t){a.each(this.tools,function(e){e.settings.paidFor||(this.removeTool(e),"function"==typeof t&&t())},this)},b.prototype.removeAllBodies=function(){a.each(this.tools,function(t){t.removeBodies(),this.toolLayer.removeChild(t)},this),this.ragdoll.removeBodies(),e.Physics.resetWorld(),this.buildGround(),i.world.SetContactListener(this.contactListener),this.tools.length=0},b.prototype.removeAllToolsNoRobo=function(e){this.removeAllBodies(),this.removeChild(this.tempDamageLayer),this.tempDamageLayer=new t.DisplayObjectContainer,this.buildBackground(),self.ui.refreshBackground=!0,this.addChild(this.tempDamageLayer),this.addChild(this.toolLayer),this.addChild(this.ragdollLayer),this.addChild(this.levelManager),this.state="building",e()},b.prototype.getScreenGrab=function(){var i=this.screen.parent,n=this.backgroundImage.parent;this.screen.addChild(this.backgroundImage),this.screen.addChild(this),this.screen.cacheAsBitmap=!0,this.backgroundImage.cacheAsBitmap=!0,this.screen.scale.x=this.screen.scale.y=.5;var o=new t.DisplayObjectContainer;o.addChild(this.screen);var r=new t.RenderTexture(e.Coords.x(2008),e.Coords.x(1359));r.render(o);var s=new t.Sprite(r);return this.screen.scale.x=this.screen.scale.y=1,i.addChild(this.screen),n.addChild(this.backgroundImage),this.backgroundImage.cacheAsBitmap=!1,this.screen.cacheAsBitmap=!1,s},b.prototype.removeAllTools=function(i){this.state="cleaning";var n=this.getScreenGrab(),o=new t.Graphics,r=this;this.removeAllBodies(),o.beginFill(0,.5),o.drawRect(0,0,n.width,n.height),o.endFill(),n.scale.x=n.scale.y=2,n.mask=o,n.addChild(o),this.addChild(n),this.removeChild(this.tempDamageLayer),this.tempDamageLayer=new t.DisplayObjectContainer,this.robotJanitor.y=e.Coords.y(1020),this.robotJanitor.scale.x=-1,this.addChild(this.robotJanitor),this.buildBackground(),this.ui.showActiveAtlases(),r.ui.refreshBackground=!0,new TWEEN.Tween({x:0}).delay(500).easing(TWEEN.Easing.Cubic.In).to({x:this.physicsArea.width+e.Coords.x(500)},2e3).onStart(function(){e.AudioManager.playSound("cleaner_robots")}).onUpdate(function(){r.robotJanitor.x=this.x,o.x=this.x/2}).onComplete(function(){r.removeChild(n),r.removeChild(r.robotJanitor),r.addChild(r.tempDamageLayer),r.addChild(r.toolLayer),r.addChild(r.ragdollLayer),r.addChild(r.levelManager),r.state="building",i()}).start()},b.prototype.isToolOverlapping=function(t){for(var e=!1,i=0;i<this.tools.length;i++){var n=t.getBoundingBox(),o=t.settings.id,r=t.settings.name,s=this.tools[i].getBoundingBox(),a=this.tools[i].settings.id,h=this.tools[i].settings.name;if("ducky"!==r&&"ducky"!==h&&o!==a&&null!==n&&null!==s&&this.intersects(n,s)){e=!0;break}}return e},b.prototype.intersects=function(t,e){var i={top:t.y,right:t.x+t.width,bottom:t.y+t.height,left:t.x},n={top:e.y,right:e.x+e.width,bottom:e.y+e.height,left:e.x};return!(n.left>i.right||n.right<i.left||n.top>i.bottom||n.bottom<i.top)},b.prototype.burnWall=function(t,e){var i=this.flakSplatPool.get();i.x=t,i.y=e,i.play(),this.tempDamageLayer.addChild(i)},b.prototype.bleedWall=function(t,i,n){if(!this.screen.simulate)return!1;var o;switch(n){case"Basic":o=this.basicWallSplatPool.get();break;case"Ceiling":o=this.ceilingSplatPool.get();break;case"Wall":o=this.wallSplatPool.get()}o.x=t-o.width/2,o.y=i-o.height/2,o.play(),e.AudioManager.playSound("blood"),this.tempDamageLayer.addChild(o)},b.prototype.addToBackground=function(t){return this.screen.simulate&&"building"!==this.state?void this.cacheQueue.push(t):!1},Object.defineProperty(b.prototype,"state",{get:function(){return this.currentState},set:function(t){this.currentState=t}}),b.prototype.buildContactListener=function(t){this.contactListener=new m.b2ContactListener,m.customizeVTable(this.contactListener,[{original:m.b2ContactListener.prototype.BeginContact,replacement:function(i,n){function o(t,e,i){var n;return n="x"===i?t.isActive()&&Math.abs(t.body.GetLinearVelocity().get_x())>e:t.isActive()&&Math.abs(t.body.GetLinearVelocity().get_y())>e}var r=m.wrapPointer(n,m.b2Contact),s=r.GetFixtureA(),a=r.GetFixtureB(),h=s.GetBody(),l=a.GetBody(),u=h.userData,c=l.userData;if(!u||!c)return!1;if(u.type===c.type||"debug"===u.type||"debug"===c.type)return!1;if("Floor"===u.type&&"Casing"===c.type&&o(c,7,"y"))e.AudioManager.playSound("casing");else if("Casing"===u.type&&"Floor"===c.type&&o(u,7,"y"))e.AudioManager.playSound("casing");else if("Wall"!==u.type&&"Wall"!==c.type||"Ragdoll"!==u.type&&"Ragdoll"!==c.type)"ToolSensor"!==u.type&&"Bouncer"!==u.type||"WalkSensor"!==c.type?"ToolSensor"!==c.type&&"Bouncer"!==c.type||"WalkSensor"!==u.type?"ToolSensor"===u.type||"ContactSensor"===u.type&&"WalkSensor"!==c.type?u.handleContact(!0,c,u):"ToolSensor"===c.type||"ContactSensor"===c.type&&"WalkSensor"!==u.type?c.handleContact(!0,u,c):"Bouncer"===u.type?u.handleContact(c,!0):"Bouncer"===c.type&&c.handleContact(u,!0):u.handleContact(c.type,c):c.handleContact(u.type,u);else{var d,p;"Ragdoll"===u.type?(d=u,p=c):(d=c,p=u),(p.isCeiling&&o(d,70*t,"y")||!p.isCeiling&&o(d,70*t,"x"))&&d.handleWallContact(p)}}},{original:m.b2ContactListener.prototype.EndContact,replacement:function(t,e){var i=m.wrapPointer(e,m.b2Contact),n=i.GetFixtureA(),o=i.GetFixtureB(),r=n.GetBody(),s=o.GetBody(),a=r.userData,h=s.userData;return a&&h?a.type===h.type||"debug"===a.type||"debug"===h.type||"WalkSensor"===h.type||"WalkSensor"===a.type?!1:void("ToolSensor"===a.type?a.handleContact(!1,h,a):"ToolSensor"===h.type?h.handleContact(!1,a,h):"Bouncer"===a.type?a.handleContact(h,!1):"Bouncer"===h.type&&h.handleContact(a,!1)):!1}}]),i.world.SetContactListener(this.contactListener)},b}),define("gamescreen",["pixi","absolute","torturechamber","tool"],function(t,e,i){var n=function(t,e){this.initGameScreen(t,e)};return n.prototype=Object.create(e.Screen.prototype),n.prototype.initGameScreen=function(t,i){e.Screen.call(this),this.ui=t,this.game=i,this.originalWidth=this.ui.width,this.originalHeight=this.ui.height},n.prototype.onShow=function(){this.tortureChamber&&"exit"===this.tortureChamber.state?(this.tortureChamber.state="building",this.tortureChamber.levelManager.loadNewLevel(this.game.currentLevel.settings,!0)):(this.tortureChamber=new i(this.ui,this),this.addChild(this.tortureChamber)),e.Screen.prototype.onShow.call(this),this.ui.refreshBackground=!0},n.prototype.onHide=function(){this.simulate=!1,e.Screen.prototype.onHide.call(this)},n.prototype.pause=function(){},n.prototype.play=function(){},n.prototype.handleOrientationChange=function(t){e.Screen.prototype.handleOrientationChange.call(this,t)},n.prototype.beforeRender=function(){this.simulate&&e.Physics.step(),this.tortureChamber&&this.tortureChamber.beforeRender()},n.prototype.afterRender=function(){this.tortureChamber&&this.tortureChamber.afterRender()},n}),define("text!ui/assetmap.json",[],function(){return'{\n\n    "loading_bar_frame": "loading_bar_frame.png",\n    "loading_bar_marker": "loading_bar_marker.png",\n    "logo": "AH_logo_main.png",\n    "buttons": {\n\n        "play": "button_menu_play_1.png"\n\n    },\n    "buttonThreeSlice" : {\n        "left":"3slice_Button/LW_3slice_btn_01.png",\n        "center":"3slice_Button/LW_3slice_btn_02.png",\n        "right":"3slice_Button/LW_3slice_btn_03.png"\n    },\n    "secondaryButtonThreeSlice" : {\n        "left":"3slice_Button/LW_3slice_btn_purple_01.png",\n        "center":"3slice_Button/LW_3slice_btn_purple_02.png",\n        "right":"3slice_Button/LW_3slice_btn_purple_03.png"\n    },\n    "dialogNineSlice": {\n        "topLeft": "9slice_modal/flakboy_9slice_01.png",\n        "topCenter": "9slice_modal/flakboy_9slice_02.png",\n        "topRight": "9slice_modal/flakboy_9slice_03.png",\n        "middleLeft":"9slice_modal/flakboy_9slice_04.png",\n        "middleCenter":"9slice_modal/flakboy_9slice_05.png",\n        "middleRight":"9slice_modal/flakboy_9slice_06.png",\n        "bottomLeft":"9slice_modal/flakboy_9slice_07.png",\n        "bottomCenter":"9slice_modal/flakboy_9slice_08.png",\n        "bottomRight":"9slice_modal/flakboy_9slice_09.png",\n        "close": "9slice_modal/close.png"\n    },\n    "dialogNineSlice2": {\n        "topLeft": "9slice_modal/FB_grey_9slice_01.png",\n        "topCenter": "9slice_modal/FB_grey_9slice_02.png",\n        "topRight": "9slice_modal/FB_grey_9slice_03.png",\n        "middleLeft":"9slice_modal/FB_grey_9slice_04.png",\n        "middleCenter":"9slice_modal/FB_grey_9slice_05.png",\n        "middleRight":"9slice_modal/FB_grey_9slice_06.png",\n        "bottomLeft":"9slice_modal/FB_grey_9slice_07.png",\n        "bottomCenter":"9slice_modal/FB_grey_9slice_08.png",\n        "bottomRight":"9slice_modal/FB_grey_9slice_09.png",\n        "close": "9slice_modal/close.png"\n    },\n    "dialogNineSlice3": {\n        "topLeft": "9slice_modal/FB_white_9slice_01.png",\n        "topCenter": "9slice_modal/FB_white_9slice_02.png",\n        "topRight": "9slice_modal/FB_white_9slice_03.png",\n        "middleLeft":"9slice_modal/FB_white_9slice_04.png",\n        "middleCenter":"9slice_modal/FB_white_9slice_05.png",\n        "middleRight":"9slice_modal/FB_white_9slice_06.png",\n        "bottomLeft":"9slice_modal/FB_white_9slice_07.png",\n        "bottomCenter":"9slice_modal/FB_white_9slice_08.png",\n        "bottomRight":"9slice_modal/FB_white_9slice_09.png",\n        "close": "9slice_modal/close.png"\n    }\n\n}\n'}),define("text!ui/layout.json",[],function(){return'{\n    "LoadingScreen": {\n        "type": "Container",\n        "children": {\n            "loadingText": {\n                "type": "Text",\n                "params": {\n                    "text": "loadingScreen.title",\n                    "fontSize": 50,\n                    "fontFamily": "Arial",\n                    "align": "center",\n                    "fill": "#ffffff",\n                    "stroke": "#001f2d",\n                    "strokeThickness": 3\n                },\n                "position": {\n                    "x": "center",\n                    "y": 100\n                }\n            }\n\n        }\n    },\n    "MenuScreen": {\n\n        "type": "Container",\n        "children": {\n            "playButton": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "onPlay",\n                    "textStyle": {\n                        "text": "buttons.selectLevel",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 550,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                },\n                "position": {\n                    "x": "right",\n                    "y": "bottom"\n                }\n            },\n            "optionsButton": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "onOptions",\n                    "textStyle": {\n                        "text": "buttons.options",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 550,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                }\n            },\n            "moregames": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleMoreGames",\n                    "textStyle": {\n                        "text": "buttons.moreGames",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 550,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                }\n            }\n        }\n    },\n    "LevelManager": {\n        "type": "Container",\n        "children": {\n            "goButton": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleGoButton",\n                    "textStyle": {\n                        "text": "buttons.go",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 300,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                }\n            },\n            "stopButton": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleStopButton",\n                    "textStyle": {\n                        "text": "buttons.stop",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 300,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                }\n            },\n            "duckButton": {\n                "type": "AnimatedButton",\n                "params": {\n                    "action": "handleDuckButton",\n                    "threeSlice": {\n                        "width": 300,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                }\n            },\n            "shopButton": {\n                "type": "AnimatedButton",\n                "params": {\n                    "action": "handleStoreButton",\n                    "threeSlice": {\n                        "width": 300,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                }\n            },\n            "optionsButton": {\n                "type": "AnimatedButton",\n                "params": {\n                    "action": "handleOptionsButton",\n                    "threeSlice": {\n                        "width": 200,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                }\n            }\n\n        }\n    },\n    "LevelComplete": {\n        "type": "Container",\n        "children": {\n            "tryAgain": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleTryAgainButton",\n                    "textStyle": {\n                        "text": "buttons.tryAgain",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 500,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                },\n                "position": {\n                    "x": 137,\n                    "y": 1257\n                }\n            },\n            "nextLevel": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleNextLevelButton",\n                    "textStyle": {\n                        "text": "buttons.nextLevel",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 596,\n                        "height": 126,\n                        "imageBase": "secondaryButtonThreeSlice"\n                    }\n                },\n                "position": {\n                    "x": 1180,\n                    "y": 1257\n                }\n            },\n            "main": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleMainButton",\n                    "textStyle": {\n                        "text": "buttons.main",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 596,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                },\n                "position": {\n                    "x": 1180,\n                    "y": 1257\n                }\n            }\n        }\n    },\n    "OptionsMenu": {\n        "type": "Container",\n        "children": {\n            "music": {\n                "type": "ToggleButton",\n                "params": {\n                    "baseName": "btn_options_MUSIC",\n                    "action": "handleMusicToggle",\n                    "enabled": true\n                },\n                "position": {\n                    "x": "left",\n                    "y": "top"\n                }\n            },\n            "sfx": {\n                "type": "ToggleButton",\n                "params": {\n                    "baseName": "btn_options_SFX",\n                    "action": "handleSfxToggle",\n                    "enabled": true\n                },\n                "position": {\n                    "x": "right",\n                    "y": "top"\n                }\n            },\n            "help": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleHelpButton",\n                    "textStyle": {\n                        "text": "buttons.help",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 450,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                },\n                "position": {\n                    "x": "left",\n                    "y": "bottom"\n                }\n            },\n            "main": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleMainButton",\n                    "textStyle": {\n                        "text": "buttons.main",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 450,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                },\n                "position": {\n                    "x": "right",\n                    "y": "bottom"\n                }\n            },\n            "moregames": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleMoreGames",\n                    "textStyle": {\n                        "text": "buttons.moreGames",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 550,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                },\n                "position": {\n                    "x": "center",\n                    "y": 680\n                }\n            }\n\n        }\n    },\n    "tutorial": {\n        "type": "Container",\n        "children": {\n            "ok": {\n                "type": "AnimatedTextButton",\n                "params": {\n                    "action": "handleOkButton",\n                    "textStyle": {\n                        "text": "buttons.ok",\n                        "fontSize": 60,\n                        "fontFamily": "Verdana",\n                        "align": "center",\n                        "useBitmapFont": false,\n                        "fill": "#ffffff",\n                        "stroke": "#704700",\n                        "strokeThickness": 3\n                    },\n                    "threeSlice": {\n                        "width": 250,\n                        "height": 126,\n                        "imageBase": "buttonThreeSlice"\n                    }\n                }\n            }\n        }\n    }\n}'
}),define("text!ui/strings.json",[],function(){return'{\n    "en": {\n        "buttons": {\n            "go": "GO",\n            "stop": "STOP",\n            "selectLevel": "SELECT LEVEL",\n            "options": "OPTIONS",\n            "tryAgain": "TRY AGAIN",\n            "nextLevel": "NEXT LEVEL",\n            "help": "HELP",\n            "main": "MAIN MENU",\n            "back": "BACK",\n            "ok": "OK",\n            "moreGames": "MORE GAMES"\n        },\n        "loadingScreen": {\n            "title": "PREPARING TEST CHAMBER..."\n        },\n        "weaponry": {\n            "bouncer1": "BouncingBoy 66",\n            "bouncer2": "Boingbastic 3GC",\n            "bouncer3": "Propelatron 5510",\n            "mine1": "Foot Blaster",\n            "mine2": "Blastastic B50",\n            "mine3": "MegaMiner 1000",\n            "mine4": "LegEater M400",\n            "spikes1": "Pokoingmon Lite",\n            "spikes2": "Stabatrix 3000",\n            "spikes3": "LaserKill WD60",\n            "turret1": "Wall Gunner",\n            "turret2": "DamageDealer B14",\n            "turret3": "Destructor 24s"\n\n        },\n        "headlines": {\n            "totalProfit": "Total Profit",\n            "congrats": "Congratulations! You\'ve mastered the art of inflicting damage on Flakboy. Now, replay levels to become more profitable."\n        }\n    }\n}\n'}),define("gameui",["absolute","loadingscreen","menuscreen","gamescreen","text!ui/assetmap.json","text!ui/layout.json","text!ui/strings.json"],function(t,e,i,n,o,r,s){var a=function(t,e){this._initGenericGameUI(t,e)};return a.constuctor=a,a.prototype=Object.create(t.GameUI.prototype),a.prototype._initGenericGameUI=function(e,i){t.GameUI.call(this,i.container,i.width,i.height,i.backgroundColor,!1,!1,!1,!0),t.AssetMap.load(o),t.StringManager.load(s),t.UIBuilder.load(r),this.game=e,this.layout=i.layout,t.LayoutHelper.setLayoutMap(this.layout)},a.prototype.load=function(e,i,n){var o=new t.Loader;o.loadArt(["loading"],function(){},function(){this.buildLoadingScreen(),this.showScreen(this.loadingScreen),setTimeout(function(){var o=new t.Loader;o.loadAssets(e,function(t){this.render(),this.loadingScreen.updateLoadingProgress(t),i(t)}.bind(this),function(){this.buildMainMenu(),t.MusicManager.setMuted(t.MusicManager.isMuted()),n(),this.animate()}.bind(this))}.bind(this),0)}.bind(this))},a.prototype.buildLoadingScreen=function(){this.loadingScreen=new e(this,this.game)},a.prototype.buildGameScreens=function(){this.gameScreen=new n(this,this.game)},a.prototype.buildMainMenu=function(){this.mainMenu=new i(this,this.game)},a.prototype.showScreen=function(e){t.GameUI.prototype.showScreen.call(this,e)},a.prototype.showMainMenu=function(){this.showScreen(this.mainMenu)},a.prototype.showGameScreen=function(){this.gameScreen||this.buildGameScreens(),this.showScreen(this.gameScreen)},a.prototype.beforeRender=function(){this.currentScreen.beforeRender()},a.prototype.afterRender=function(){this.currentScreen.afterRender()},a.prototype.pause=function(){this.gameScreen.pause()},a.prototype.play=function(){this.gameScreen.play()},a}),define("game",["absolute","state-machine","gameui"],function(t,e,i){var n=function(t,e){this._initGenericGame(t,e)};return n.prototype=Object.create(t.Game.prototype),n.prototype._initGenericGame=function(e,n){t.Game.call(this,e,{version:1,musicEnabled:!0,sfxEnabled:!0,lastLevel:0,completedLevels:[],config:n.config}),this.lastState="loading",this.firstRun=!0,this.currentLevel=0,this.initStateMachine(),this.ui=new i(this,n)},n.prototype.handleVisibilityChange=function(e){if(t.Game.prototype.handleVisibilityChange.call(this,e),e)this.savedGameState=this.fsm.current,t.MusicManager.stopMusic(),t.AudioManager.isSfxEnabled()&&t.AudioManager.muteAll(),"playing"===this.savedGameState&&this.ui.pause();else if("loading"!==this.fsm.current){if(!t.MusicManager.isMuted())if("menu"===this.lastState)t.MusicManager.playMusic("mainscreen_music",!0);else if("play"===this.lastState){var i=t.RandomUtils.getRandomIntFromRange(1,3);t.MusicManager.stopMusic(),t.MusicManager.playMusic("music_"+i)}t.AudioManager.isSfxEnabled()&&t.AudioManager.unmuteAllSfx(),"playing"===this.savedGameState&&this.ui.play()}},n.prototype.load=function(t,e,i){this.ui.load(t,e,i)},n.prototype.initStateMachine=function(){this.fsm=e.create({events:[{name:"init",from:"none",to:"loading"},{name:"start",from:"loading",to:"mainmenu"},{name:"play",from:"mainmenu",to:"playing"},{name:"quit",from:"playing",to:"mainmenu"}],callbacks:{onstart:this.onStart.bind(this),onplay:this.onPlay.bind(this),onquit:this.onQuit.bind(this),onchangestate:function(e,i,n){this.lastState=i,t.Debug.log("CHANGED STATE: "+i+" to "+n)}.bind(this)}}),this.fsm.init()},n.prototype.onStart=function(){this.lastState="menu",this.ui.showMainMenu()},n.prototype.onPlay=function(){this.lastState="play",this.ui.showGameScreen()},n.prototype.onQuit=function(){this.lastState="menu",this.ui.showMainMenu()},n.prototype.start=function(){this.fsm.start()},n.prototype.play=function(t){this.currentLevel=t,this.fsm.play()},n.prototype.quit=function(){this.fsm.quit()},n}),require.config({waitSeconds:0,paths:{text:"dependencies/bower_components/requirejs-text/text",pixi:"dependencies/bower_components/pixi/bin/pixi.dev",absolute:"dependencies/absolute/absolute",absoluteaudio:"dependencies/absoluteaudio/absoluteaudio","state-machine":"dependencies/bower_components/javascript-state-machine/state-machine",tween:"dependencies/bower_components/tweenjs/src/Tween",hammer:"dependencies/bower_components/hammerjs/hammer",fpsmeter:"dependencies/bower_components/fpsmeter/dist/fpsmeter",requireLib:"dependencies/bower_components/requirejs/require",proton:"dependencies/bower_components/Proton/build/proton-1.0.0",box2d:"dependencies/bower_components/box2d.js/box2d"},packages:[{name:"lodash",location:"dependencies/bower_components/lodash-amd/modern"}],shim:{astar:{exports:"AStar"},"state-machine":{exports:"StateMachine"},tween:{exports:"TWEEN"},hammer:{exports:"Hammer"},fpsmeter:{exports:"FPSMeter"},proton:{exports:"Proton"},box2d:{exports:"Box2D"}}}),require(["version","absolute","audiosprites","artassets","gameconfig","game","absoluteaudio"],function(t,e,i,n,o,r,s){for(var a,h=!1,l=!1,u={},c=/\+/g,d=/([^&=]+)=?([^&]*)/g,p=function(t){return decodeURIComponent(t.replace(c," "))},f=window.location.search.substring(1);a=d.exec(f);)u[p(a[1])]=p(a[2]);h=u.debug&&"true"===u.debug,l=u.portrait&&"true"===u.portrait,e.Debug.enabled=h,e.Debug.log('Starting "'+t.name()+'" '+t.id()+" "+t.version()),e.ScreenMetrics.stepDownResClass=!0,e.ScreenMetrics.refresh(),e.ScreenMetrics.log(),e.Platform.artPathPrefix="spritesheets",e.Platform.soundPathPrefix="sound",e.ScreenMetrics.detectOrientationChange(function(t){"landscape"===t&&window.scrollTo(0,0)});var g=function(){var a=new r("flakboy",{container:"container",width:2008*e.ScreenMetrics.getResScale(),height:1536*e.ScreenMetrics.getResScale(),gameId:t.id(),gameVersion:t.version(),config:o,backgroundColor:2706267});a.load({audioAssets:i,artAssets:n},function(t){e.Debug.log(100*t+"% loaded")},function(){e.Debug.log("load complete"),a.start(),s.context.usingWebAudio()||e.AudioManager.setSfxEnabled(!1)})};if("undefined"!=typeof cordova){var m=function(){document.addEventListener("pause",function(){e.MusicManager.stopMusic()},!1),document.addEventListener("backbutton",function(){navigator.app.exitApp()},!1),g()};document.addEventListener("deviceready",m,!1)}else g()}),define("main",function(){});